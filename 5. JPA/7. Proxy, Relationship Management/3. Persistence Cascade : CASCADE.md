-----
### ì˜ì†ì„± ì „ì´ : CASCADE
-----
1. ğŸ’¡ íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë–„, ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
   - ğŸ’¡ğŸ’¡ğŸ’¡ Parentì™€ Childì˜ Life Cycleì´ ì¼ì¹˜í•  ë•Œ (INSERT, UPDATE, DELETE ë“±)
   - ğŸ’¡ğŸ’¡ğŸ’¡ ë‹¨ì¼ ì†Œìœ ì (ì†Œìœ ìê°€ í•˜ë‚˜ ì¼ ë–„, ì¦‰ ParentëŠ” Child 1ê°œë¥¼ ì†Œìœ )
2. ì˜ˆ) ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ, ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì €ì¥
<div align="center">
<img src="https://github.com/user-attachments/assets/0ecc16ab-0de2-41b5-9435-282cea6c0ad9">
</div>

3. ì˜ì†ì„± ì „ì´ : ì €ì¥
```java
@OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST)
```
  - Parent
```java
package hellojpa;

import jakarta.persistence.*;

import java.util.ArrayList;
import java.util.List;

@Entity
public class Parent {

    @Id @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent", cascade = CascadeType.ALL, orphanRemoval = true)
    private List<Child> childList = new ArrayList<>();

    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    public List<Child> getChildList() {
        return childList;
    }

    public void setChildList(List<Child> childList) {
        this.childList = childList;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
```

  - Child
```java
package hellojpa;

import jakarta.persistence.*;

@Entity
public class Child {

    @Id @GeneratedValue
    private Long id;

    private String name;

    @ManyToOne
    @JoinColumn(name = "PARENT_ID")
    private Parent parent;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Parent getParent() {
        return parent;
    }

    public void setParent(Parent parent) {
        this.parent = parent;
    }
}
```
```java
package hellojpa;

import jakarta.persistence.*;
import org.hibernate.Hibernate;

import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘

        try {
            Child child1 = new Child();
            Child child2 = new Child();

            Parent parent = new Parent();

            parent.addChild(child1);
            parent.addChild(child2);

            em.persist(parent);

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
            e.printStackTrace();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```
Hibernate: 
    /* insert for
        hellojpa.Parent */insert 
    into
        Parent (name, id) 
    values
        (?, ?)
Hibernate: 
    /* insert for
        hellojpa.Child */insert 
    into
        Child (name, PARENT_ID, id) 
    values
        (?, ?, ?)
Hibernate: 
    /* insert for
        hellojpa.Child */insert 
    into
        Child (name, PARENT_ID, id) 
    values
        (?, ?, ?)
```

<div align="center">
<img src="https://github.com/user-attachments/assets/8b1380c5-1acd-4052-bcd0-5b457ce9ddd1">
</div>

4. ì£¼ì˜ì‚¬í•­
   - ğŸ’¡ ì˜ì†ì„± ì „ì´ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒê³¼ ì•„ë¬´ ê´€ë ¨ì´ ì—†ìŒ
   - ğŸ’¡ ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í•  ë•Œ, ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì†í™”í•˜ëŠ” í¸ë¦¬í•¨ì„ ì œê³µí•  ë¿ì„

5. CASCADE ì¢…ë¥˜
   - ğŸ’¡ ALL : ëª¨ë‘ ì ìš©
   - ğŸ’¡ PERSIST : ì˜ì†
   - REMOVE : ì‚­ì œ
   - MERGE : ë³‘í•©
   - REFRESH : REFRESH
   - DETACH : DETACH

-----
### ê³ ì•„ ê°ì²´
-----
1. ğŸ’¡ ê³ ì•„ ê°ì²´ ì œê±° : ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ ê´€ê³„ê°€ ê·¾ì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œ
   - orphanRemoval = true
   - Member
```java
package hellojpa;

import jakarta.persistence.*;

import java.util.ArrayList;
import java.util.List;

@Entity
public class Parent {

    @Id @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent", cascade = CascadeType.ALL, orphanRemoval = true)
    private List<Child> childList = new ArrayList<>();

    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    public List<Child> getChildList() {
        return childList;
    }

    public void setChildList(List<Child> childList) {
        this.childList = childList;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
```
```java
package hellojpa;

import jakarta.persistence.*;
import org.hibernate.Hibernate;

import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘

        try {
            Child child1 = new Child();
            Child child2 = new Child();

            Parent parent = new Parent();

            parent.addChild(child1);
            parent.addChild(child2);

            em.persist(parent);

            em.flush();
            em.clear();

            Parent findParent = em.find(Parent.class, parent.getId()); // ìì‹ ì—”í‹°í‹°ë¥¼ ì»¬ë ‰ì…˜ì—ì„œ ì œê±° (0ë²ˆì§¸ ì»¬ë ‰ì…˜ ì œê±°)
            findParent.getChildList().remove(0);
            // em.remove(findParent); // ë¶€ëª¨ ì—”í‹°í‹° ì‚­ì œë¡œ, ìì‹ ì—”í‹°í‹°ë„ ì‚­ì œ

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
            e.printStackTrace();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```sql
...

Hibernate: 
    /* delete for hellojpa.Child */delete 
    from
        Child 
    where
        id=?
```

2. ì£¼ì˜
   - ğŸ’¡ ì°¸ì¡°ê°€ ì œê±°ëœ ì—”í‹°í‹°ëŠ” ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê³ ì•„ ê°ì²´ë¡œ ë³´ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥
   - ğŸ’¡ğŸ’¡ğŸ’¡ ì°¸ì¡°í•˜ëŠ” ê³³ì´ í•˜ë‚˜ì¼ ë•Œ ì‚¬ìš©í•´ì•¼í•¨
   - ğŸ’¡ğŸ’¡ğŸ’¡ íŠ¹ì • ì—”í‹°í‹°ê°€ ê°œì¸ ì†Œìœ í•  ë•Œ ì‚¬ìš©
   - @OneToOne, @OneToMany
   - ğŸ’¡ ì°¸ê³  : ê°œë…ì ìœ¼ë¡œ ë¶€ëª¨ë¥¼ ì œê±°í•˜ë©´, ìì‹ì€ ê³ ì•„ê°€ ë¨. ë”°ë¼ì„œ, ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ë©´, ë¶€ëª¨ê°€ ì œê±°ë  ë•Œ, ìì‹ë„ í•¨ê»˜ ì œê±°. ì´ëŠ” CascadeType.REMOVEì²˜ëŸ¼ ë™ì‘
```java
package hellojpa;

import jakarta.persistence.*;

import java.util.ArrayList;
import java.util.List;

@Entity
public class Parent {

    @Id @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent", orphanRemoval = true) 
    private List<Child> childList = new ArrayList<>();

    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    public List<Child> getChildList() {
        return childList;
    }

    public void setChildList(List<Child> childList) {
        this.childList = childList;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
```
```java
package hellojpa;

import jakarta.persistence.*;
import org.hibernate.Hibernate;

import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘

        try {
            Child child1 = new Child();
            Child child2 = new Child();

            Parent parent = new Parent();

            parent.addChild(child1);
            parent.addChild(child2);

            em.persist(parent);
            em.persist(child1);
            em.persist(child2);

            em.flush();
            em.clear();

            Parent findParent = em.find(Parent.class, parent.getId());
            em.remove(findParent); // ë¶€ëª¨ ì—”í‹°í‹° ì œê±°

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
            e.printStackTrace();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```
...

Hibernate: 
    /* delete for hellojpa.Child */delete 
    from
        Child 
    where
        id=?

Hibernate: 
    /* delete for hellojpa.Child */delete 
    from
        Child 
    where
        id=?

Hibernate: 
    /* delete for hellojpa.Parent */delete 
    from
        Parent 
    where
        id=?
```
-----
### ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´, ìƒëª…ì£¼ê¸°
-----
1. ğŸ’¡ CascadeType.ALL + orphanRemoval = true
2. ğŸ’¡ ìŠ¤ìŠ¤ë¡œ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°ëŠ” em.persist()ë¡œ ì˜ì†í™”, em.remove()ë¡œ ì œê±°
3. ğŸ’¡ğŸ’¡ğŸ’¡ ë‘ ì˜µì…˜ì„ ëª¨ë‘ í™œì„±í™”í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ í†µí•´ì„œ ìì‹ì˜ ìƒëª… ì£¼ê¸°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ (ì¦‰, ìì‹ì˜ ìƒëª… ì£¼ê¸°ë¥¼ ë¶€ëª¨ ì—”í‹°í‹°ê°€ ê´€ë¦¬)
4. ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„(DDD)ì˜ Aggregate Root ê°œë…ì„ êµ¬í˜„í•  ë•Œ ìœ ìš©
