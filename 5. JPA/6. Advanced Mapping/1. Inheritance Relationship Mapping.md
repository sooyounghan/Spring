-----
### ìƒì† ê´€ê³„ ë§¤í•‘
-----
1. ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê´€ê³„ê°€ ì—†ìŒ
2. ìŠˆí¼íƒ€ì… - ì„œë¸Œíƒ€ì… ê´€ê³„ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ê°ì²´ ìƒì†ê³¼ ìœ ì‚¬
3. ìƒì† ê´€ê³„ ë§¤í•‘ : ê°ì²´ì˜ ìƒì† êµ¬ì¡°ì™€ DBì˜ ìŠˆí¼íƒ€ì… - ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘
<div align="center">
<img src="https://github.com/user-attachments/assets/beb5f9b3-d2d1-465b-85e3-f2f75c8a305a">
</div>

4. ğŸ’¡ ìŠˆí¼íƒ€ì… - ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ì‹¤ì œ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•
   - ê° í…Œì´ë¸”ë¡œ ë³€í™˜ : ì¡°ì¸ ì „ëµ
   - í†µí•© í…Œì´ë¸”ë¡œ ë³€í™˜ : ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
   - ì„œë¸Œíƒ€ì… í…Œì´ë¸”ë¡œ ë³€í™˜ : êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ

5. ğŸ’¡ ì£¼ìš” ì• ë„ˆí…Œì´ì…˜
   - @Inheritance(strategy = InheritanceType.XXX)
     + JOINED : ì¡°ì¸ ì „ëµ
     + SINGLE_TABLE : ë‹¨ì¼ í…Œì´ë¸” ì „ëµ (JPA ê¸°ë³¸ ì „ëµ)
     + TABLE_PER_CLASS : êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ
   - ğŸ’¡ @DiscriminatorColumn(name = "DTYPE") : ìŠˆí¼íƒ€ì…ì—ì„œ ì–´ë– í•œ ì„œë¸Œíƒ€ì…ì´ ë“¤ì–´ì™”ëŠ”ì§€ í‘œì‹œ (Default ê°’ì€ DTYPE)
   - ğŸ’¡ @DiscriminatorValue("XXX") : ì„œë¸Œíƒ€ì…ì˜ ì´ë¦„ì„ ë³€ê²½ (DTYPEì˜ ê°’ì„ ë³€ê²½) (Default ê°’ì€ ì—”í‹°í‹°ëª…)

-----
### ì‚¬ìš©í•  í´ë˜ìŠ¤
-----
1. Item
```java
package hellojpa;

import jakarta.persistence.*;

@Entity
public class Item {

    @Id
    @GeneratedValue
    private Long id;

    private String name;
    private int price;
}
```

2. Album
```java
package hellojpa;

import jakarta.persistence.Entity;

@Entity
public class Album extends Item {
    private String artist;
}
```

3. Movie
```java
package hellojpa;

import jakarta.persistence.Entity;

@Entity
public class Movie extends Item {
    private String director;
    private String actor;
}
```

4. Book
```java
package hellojpa;

import jakarta.persistence.Entity;

@Entity
public class Book extends Item {
    private String author;
    private String isbn;
}
```

-----
### ğŸ’¡ @DiscriminatorColumnê³¼ @DiscriminatorValue
-----
1. @DiscriminatorColum (ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ DTYPE ì„¤ì • : Default ê°’ì€ DTYPE)
   - Item
```java
package hellojpa;

import jakarta.persistence.*;

@Entity
@Inheritance(strategy = InheritanceType.JOINED)
@DiscriminatorColumn // = @DiscriminatorColumn(name = "DTYPE")
public class Item {

    @Id
    @GeneratedValue
    private Long id;

    private String name;
    private int price;
}
```
  - JpaMain
```java
package hellojpa;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.EntityTransaction;
import jakarta.persistence.Persistence;

import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘


        try {
            Movie movie = new Movie();
            movie.setDirector("aaa");
            movie.setActor("bbb");
            movie.setName("ë°”ëŒê³¼ í•¨ê»˜ ì‚¬ë¼ì§€ë‹¤.");
            movie.setPrice(10000);
            em.persist(movie);

            em.flush();
            em.clear();

            Movie findMovie = em.find(Movie.class, movie.getId());
            System.out.println("findMovie = " + findMovie);

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```
Hibernate: 
    create table Item (
        price integer not null,
        id bigint not null,
        DTYPE varchar(31) not null,
        name varchar(255),
        primary key (id)
    )
```
<div align="center">
<img src="https://github.com/user-attachments/assets/4595afd9-6085-4c9e-89d8-e81dd2902916">
</div>

2. @DiscriminatorValue (ìì‹ í´ë˜ìŠ¤ì˜ DTYPE ì´ë¦„ ë³€ê²½ : Default ê°’ì€ ì—”í‹°í‹° ëª…)
   - Album, Movie, Book
```java
package hellojpa;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;

@Entity
@DiscriminatorValue("A")
public class Album extends Item {
    private String artist;
}
```

```java
package hellojpa;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;

@Entity
@DiscriminatorValue("M")
public class Movie extends Item {
    private String director;
    private String actor;
}
```

```java
package hellojpa;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;

@Entity
@DiscriminatorValue("B")
public class Book extends Item {
    private String author;
    private String isbn;
}
```
<div align="center">
<img src="https://github.com/user-attachments/assets/621509f5-89bb-49a1-8118-0f902676e592">
</div>


-----
### ì¡°ì¸ ì „ëµ (ì •ì„)
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/245cb48d-02e4-4c94-a4d6-e2ca5fc63c32">
</div>

```java
package hellojpa;

import jakarta.persistence.*;

@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Item {

    @Id
    @GeneratedValue
    private Long id;

    private String name;
    private int price;
}
```
```
Hibernate: 
    create table Item (
        price integer not null,
        id bigint not null,
        name varchar(255),
        primary key (id)
    )

Hibernate: 
    create table Album (
        id bigint not null,
        artist varchar(255),
        primary key (id)
    )

Hibernate: 
    create table Book (
        id bigint not null,
        author varchar(255),
        isbn varchar(255),
        primary key (id)
    )

Hibernate: 
    create table Movie (
        id bigint not null,
        actor varchar(255),
        director varchar(255),
        primary key (id)
    )
```

```java
package hellojpa;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.EntityTransaction;
import jakarta.persistence.Persistence;

import java.util.List;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘


        try {
            Movie movie = new Movie();
            movie.setDirector("aaa");
            movie.setActor("bbb");
            movie.setName("ë°”ëŒê³¼ í•¨ê»˜ ì‚¬ë¼ì§€ë‹¤.");
            movie.setPrice(10000);
            em.persist(movie);

            em.flush();
            em.clear();

            Movie findMovie = em.find(Movie.class, movie.getId());
            System.out.println("findMovie = " + findMovie);

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```
Hibernate: 
    /* insert for
        hellojpa.Movie */insert 
    into
        Item (name, price, id) 
    values
        (?, ?, ?)

Hibernate: 
    /* insert for
        hellojpa.Movie */insert 
    into
        Movie (actor, director, id) 
    values
        (?, ?, ?)

Hibernate: 
    select
        m1_0.id,
        m1_1.name,
        m1_1.price,
        m1_0.actor,
        m1_0.director 
    from
        Movie m1_0 
    join
        Item m1_1 
            on m1_0.id=m1_1.id 
    where
        m1_0.id=?

findMovie = hellojpa.Movie@23e3f5cd
```
<div align="center">
<img src="https://github.com/user-attachments/assets/edea1110-331e-418a-bb9c-2ebeb617b87f">
</div>

1. ì¥ì 
   - í…Œì´ë¸” ì •ê·œí™”
   - ì™¸ë˜ í‚¤ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´ í™œìš© ê°€ëŠ¥
   - ì €ì¥ê³µê°„ íš¨ìœ¨í™”

2. ë‹¨ì 
   - ì¡°íšŒ ì‹œ ì¡°ì¸ì„ ë§ì´ ì‚¬ìš©, ì„±ëŠ¥ ì €í•˜
   - ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•¨
   - ğŸ’¡ ë°ì´í„° ì €ì¥ ì‹œ INSERT SQL 2ë²ˆ í˜¸ì¶œ

-----
### ë‹¨ì¼ í…Œì´ë¸” ì „ëµ (Default)
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/148857d7-cc3c-468e-b770-7af4cdf36254">
</div>

* @DiscriminatorColumnì´ ìƒëµë˜ì–´ë„ DTYPE ìƒì„± (ë‹¨ì¼ í…Œì´ë¸”ì´ë¯€ë¡œ, ì´ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ìë™ ìƒì„±)
```java
package hellojpa;

import jakarta.persistence.*;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
// @DiscriminatorColumn // DTYPE
public class Item {

    @Id
    @GeneratedValue
    private Long id;

    private String name;
    private int price;

    public void setId(Long id) {
        this.id = id;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setPrice(int price) {
        this.price = price;
    }

    public Long getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    public int getPrice() {
        return price;
    }
}
```
```
Hibernate: 
    create table Item (
        price integer not null,
        id bigint not null,
        DTYPE varchar(31) not null,
        actor varchar(255),
        artist varchar(255),
        author varchar(255),
        director varchar(255),
        isbn varchar(255),
        name varchar(255),
        primary key (id)
    )

...

Hibernate: 
    /* insert for
        hellojpa.Movie */insert 
    into
        Item (name, price, actor, director, DTYPE, id) 
    values
        (?, ?, ?, ?, 'M', ?)

Hibernate: 
    select
        m1_0.id,
        m1_0.name,
        m1_0.price,
        m1_0.actor,
        m1_0.director 
    from
        Item m1_0 
    where
        m1_0.DTYPE='M' 
        and m1_0.id=?
findMovie = hellojpa.Movie@498a612d
```
<div align="center">
<img src="https://github.com/user-attachments/assets/bd7042b0-f55a-437a-b19f-b036e6b1654d">
</div>

1. ì¥ì 
   - ì¡°ì¸ì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ì¸ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¦„
   - ğŸ’¡ ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœ (INSERT SQLëŠ” 1ë²ˆ)

2. ë‹¨ì 
   - ğŸ’¡ ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ null í—ˆìš©
   - ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ë¯€ë¡œ í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŒ
   - ë”°ë¼ì„œ, ìƒí™©ì— ë”°ë¼ ì¡°íšŒ ì„±ëŠ¥ì´ ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ

-----
### êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/fb837602-0845-4623-8ba2-c04485bccbc1">
</div>

* ğŸ’¡ Item í´ë˜ìŠ¤ëŠ” ì¶”ìƒ í´ë˜ìŠ¤, í•´ë‹¹ ê°’ì€ ë…ë‹¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ í•˜ìœ„ í´ë˜ìŠ¤ê°€ ì´ë¥¼ ìƒì†ë°›ì•„ êµ¬ì²´í™”í•˜ë„ë¡ í•´ì•¼í•¨
```java
package hellojpa;

import jakarta.persistence.*;

@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class Item {

    @Id
    @GeneratedValue
    private Long id;

    private String name;
    private int price;
}
```
```
Hibernate: 
    create table Album (
        price integer not null,
        id bigint not null,
        artist varchar(255),
        name varchar(255),
        primary key (id)
    )

Hibernate: 
    create table Book (
        price integer not null,
        id bigint not null,
        author varchar(255),
        isbn varchar(255),
        name varchar(255),
        primary key (id)
    )

Hibernate: 
    create table Movie (
        price integer not null,
        id bigint not null,
        actor varchar(255),
        director varchar(255),
        name varchar(255),
        primary key (id)
    )

Hibernate: 
    /* insert for
        hellojpa.Movie */insert 
    into
        Movie (name, price, actor, director, id) 
    values
        (?, ?, ?, ?, ?)

Hibernate: 
    select
        m1_0.id,
        m1_0.name,
        m1_0.price,
        m1_0.actor,
        m1_0.director 
    from
        Movie m1_0 
    where
        m1_0.id=?

findMovie = hellojpa.Movie@6da4feeb
```
<div align="center">
<img src="https://github.com/user-attachments/assets/2cee9bb9-7010-4495-a93a-506f44ee0d9a">
</div>

1. ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ì „ëµ
2. ì¥ì 
   - ì„œë¸Œ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì 
   - NOT NULL ì œì•½ì¡°ê±´ ì‚¬ìš© ê°€ëŠ¥

3. ë‹¨ì 
   - ğŸ’¡ ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¼ (UNION SQL í•„ìš”)
   - ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ ì¿¼ë¦¬í•˜ê¸° ì–´ë ¤ì›€
```java
package hellojpa;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.EntityTransaction;
import jakarta.persistence.Persistence;

public class JpaMain {
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
        EntityManager em = emf.createEntityManager();

        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘


        try {
            Movie movie = new Movie();
            movie.setDirector("aaa");
            movie.setActor("bbb");
            movie.setName("ë°”ëŒê³¼ í•¨ê»˜ ì‚¬ë¼ì§€ë‹¤.");
            movie.setPrice(10000);
            em.persist(movie);

            em.flush();
            em.clear();

            Item item = em.find(Item.class, movie.getId());
            System.out.println("item = " + item);

            tx.commit();
        } catch (Exception e) {
            tx.rollback();
        } finally {
            em.close();
        }
        emf.close();
    }
}
```
```
Hibernate: 
    select
        i1_0.id,
        i1_0.clazz_,
        i1_0.name,
        i1_0.price,
        i1_0.artist,
        i1_0.author,
        i1_0.isbn,
        i1_0.actor,
        i1_0.director 
    from
        (select
            price,
            id,
            artist,
            name,
            null as author,
            null as isbn,
            null as actor,
            null as director,
            1 as clazz_ 
        from
            Album 
        union
        all select
            price,
            id,
            null as artist,
            name,
            author,
            isbn,
            null as actor,
            null as director,
            2 as clazz_ 
        from
            Book 
        union
        all select
            price,
            id,
            null as artist,
            name,
            null as author,
            null as isbn,
            actor,
            director,
            3 as clazz_ 
        from
            Movie
    ) i1_0 
where
    i1_0.id=?

item = hellojpa.Movie@6c17c0f8
```
