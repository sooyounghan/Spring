-----
### H2 데이터베이스
-----
1. http://www.h2database.com
2. 실습용 DB
3. 가벼움 (1.5M)
4. 웹용 쿼리툴 제공
5. MySQL, Oracle 데이터베이스 시뮬레이션 가능
6. SEQUENCE, AUTO INCREMENT 기능 지원

-----
### Maven, Gradle
-----
1. https://maven.apache.org/
2. JAVA 라이브러리, 빌드 관리
3. 라이브러리 자동 다운로드 및 의존성 관리
4. 이제는 Gradle 사용

-----
### 참고 - 프로젝트 생성 (강의 참고)
-----
1. 자바 8 이상
2. 메이븐 설정
   - groupId : jpa-basic
   - artifactId : ex1-hello-jpa
   - version : 1.0.0

3. 라이브러리 추가 - pom.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>jpa-basic</groupId>
    <artifactId>ex1-hello-jpa</artifactId> 
    <version>1.0.0</version>
    <dependencies>
    
        <!-- JPA 하이버네이트 -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId> 
            <version>5.3.10.Final</version>
        </dependency>

        <!-- H2 데이터베이스 -->
        <dependency>
            <groupId>com.h2database</groupId> 
            <artifactId>h2</artifactId> 
            <version>1.4.199</version> 
        </dependency>
    </dependencies>
</project>
```

4. JPA 설정하기 - persistence.xml
  - JPA 설정 파일
  - /META-INF/persistence.xml 위치
  - persistence-unit name으로 이름 지정
  - jakarta.persistence로 시작 : JPA 표준 속성
  - hibernate로 시작 : 하이버네이트 전용 속성
```xml
<?xml version="1.0" encoding="UTF-8"?> 
<persistence version="2.2"
             xmlns="http://xmlns.jcp.org/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd">

    <persistence-unit name="hello"> 
        <properties>
            <!-- 필수 속성 -->
            <property name="jakarta.persistence.jdbc.driver" value="org.h2.Driver"/>
            <property name="jakarta.persistence.jdbc.user" value="sa"/> 
            <property name="jakarta.persistence.jdbc.password" value=""/>
            <property name="jakarta.persistence.jdbc.url" value="jdbc:h2:tcp://localhost/~/test"/> 
            <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
            
            <!-- 옵션 -->
            <property name="hibernate.show_sql" value="true"/>
            <property name="hibernate.format_sql" value="true"/>
            <property name="hibernate.use_sql_comments" value="true"/>
            <!--<property name="hibernate.hbm2ddl.auto" value="create" />-->
        </properties>
    </persistence-unit> 
</persistence>
```

-----
### 프로젝트 환경
-----
1. Spring Boot 설정
<div align="center">
<img src="https://github.com/user-attachments/assets/b27038a5-bd13-42ab-b5c5-087d6399d4ed">
</div>

2. builde.gradle
```gradle
plugins {
	id 'java'
	id 'org.springframework.boot' version '3.3.2'
	id 'io.spring.dependency-management' version '1.1.6'
}

group = 'jpa-basic'
version = '0.0.1-SNAPSHOT'

java {
	toolchain {
		languageVersion = JavaLanguageVersion.of(17)
	}
}

configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
	implementation 'org.springframework.boot:spring-boot-starter-web'

	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'

	runtimeOnly 'com.h2database:h2'

	testImplementation 'org.springframework.boot:spring-boot-starter-test'
	testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

	compileOnly 'org.projectlombok:lombok'
	annotationProcessor 'org.projectlombok:lombok'

	//테스트에서 lombok 사용
	testCompileOnly 'org.projectlombok:lombok'
	testAnnotationProcessor 'org.projectlombok:lombok'
}

tasks.named('test') {
	useJUnitPlatform()
}
```

3. application.properties
```properties
spring.application.name=ex1-hello-jpa
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa

server.port=9090
spring.output.ansi.enabled=ALWAYS

#JPA log
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

spring.jpa.properties.hibernate.show_sql= true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
```


-----
### 데이터베이스 방언
-----
1. JPA는 특정 데이터베이스에 종속되지 않음
2. 각각의 데이터베이스가 제공하는 SQL 문법과 함수는 조금씩 다름
   - 가변문자 : MySQL은 VARCHAR, Oracle은 VARCHAR2
   - 문자열을 자르는 함수 : SQL 표준은 SUBSTRING(), Oracle은 SUBSTR()
   - 페이징 : MySQL은 LIMIT, Oracle은 ROWNUM
3. 방언 : SQL 표준을 지키지 않는 특정 데이터베이스만의 고유한 기능

<div align="center">
<img src="https://github.com/user-attachments/assets/d849d0b5-36ee-4ec3-897f-c702ac47193b">
</div>

4. hibernate.dialect 속성에 지정
   - H2 : org.hibernate.dialect.H2Dialect
   - Oracle 10g : org.hibernate.dialect.Oracle10gDialect
   - MySQL : org.hibernate.dialect.MySQL5(InnoDB)Dialect (버전 5)
   - 하이버네이트는 40가지 이상 데이터베이스 방언 지원

5. gradle에서 설정 방법 (application.properties)
   - H2 Database
```properties
spring.jpa.database-platform=org.hibernate.dialect.H2dialect
```

   - Dialect는 보통 데이터베이스 이름과 버전으로 되어 있으며 본인 버전에 최대한 가까운 것을 선택하는 것을 추천
