-----
### íšŒì› ì„œë¹„ìŠ¤ ê°œë°œ
-----
1. íšŒì› ì„œë¹„ìŠ¤ ì½”ë“œ
```java
package jpabook.jpashop.service;

import jpabook.jpashop.domain.Member;
import jpabook.jpashop.repository.MemberRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@Transactional(readOnly = true)
public class MemberService {

    @Autowired  private MemberRepository memberRepository;

    /**
     * íšŒì› ê°€ì…
     */
    @Transactional // ë³€ê²½ ë©”ì„œë“œì´ë¯€ë¡œ, ê¸°ë³¸ì ìœ¼ë¡œ readOnly = true, ê°€ì…ë§Œ ì œì™¸
    public Long join(Member member) {
        validateDuplicateMember(member); // ì¤‘ë³µ íšŒì› ê²€ì¦
        memberRepository.save(member);

        return member.getId();
    }

    private void validateDuplicateMember(Member member) {
        // ì¤‘ë³µ íšŒì›ì´ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ë°œìƒ
        List<Member> findMembers = memberRepository.findByName(member.getName());

        if(!findMembers.isEmpty()) {
            throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        }
    }

    // íšŒì› ì „ì²´ ì¡°íšŒ
    public List<Member> findMembers() {
        return memberRepository.findAll();
    }

    // íšŒì› í•œ ëª… ì¡°íšŒ
    public Member findOne(Long id) {
        return memberRepository.findOne(id);
    }
}
```

2. ê¸°ìˆ  ì„¤ëª…
   - @Service
   - ğŸ’¡ @Transactional : íŠ¸ëœì­ì…˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸
     + readOnly=true : ë°ì´í„° ë³€ê²½ì´ ì—†ëŠ” ì½ê¸° ì „ìš© ë©”ì„œë“œì— ì‚¬ìš©, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì•½ê°„ì˜ ì„±ëŠ¥ í–¥ìƒ (ì½ê¸° ì „ìš©ì—ëŠ” ë‹¤ ì ìš©)
     + ë°ì´í„°ë² ì´ìŠ¤ ë“œë¼ì´ë²„ê°€ ì§€ì›í•˜ë©´ DBì—ì„œ ì„±ëŠ¥ í–¥ìƒ
   - @Autowired : ìƒì„±ì Injectionì‹œì— ë§ì´ ì‚¬ìš©í•˜ë©°, ìƒì„±ìê°€ í•˜ë‚˜ë©´ ìƒëµ ê°€ëŠ¥

3. ê¸°ëŠ¥ ì„¤ëª…
   - join() : íšŒì› ê°€ì…
   - findMembers() : íšŒì› ì „ì²´ ì¡°íšŒ
   - findOne() : íšŒì› í•œ ëª… ì¡°íšŒ

4. ğŸ’¡ ì‹¤ë¬´ì—ì„œëŠ” ê²€ì¦ ë¡œì§ì´ ìˆì–´ë„ ë©€í‹° ì“°ë ˆë“œ ìƒí™©ì„ ê³ ë ¤í•´ íšŒì› í…Œì´ë¸”ì˜ íšŒì›ëª… ì»¬ëŸ¼ì— ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì•ˆì „
5. ğŸ’¡ ìŠ¤í”„ë§ í•„ë“œ ì£¼ì… ëŒ€ì‹  ìƒì„±ì ì£¼ì… ì‚¬ìš©
  - í•„ë“œ ì£¼ì…
```java
public class MemberService {

    @Autowired  private MemberRepository memberRepository;

    ...

}
```

  - ìƒì„±ì ì£¼ì…
```java
public class MemberService {

    private final MemberRepository memberRepository;

    // @Autowired
    public MemberService(MemberRepository memberRepository) { 
          this.memberRepository = memberRepository;
    }

    ... 

}
```
  - ğŸ’¡ ìƒì„±ì ì£¼ì… ë°©ì‹ ê¶Œì¥
  - ğŸ’¡ ë³€ê²½ ë¶ˆê°€ëŠ¥í•œ ì•ˆì „í•œ ê°ì²´ ìƒì„± ê°€ëŠ¥
  - ìƒì„±ìê°€ í•˜ë‚˜ë©´, @Autowired ìƒëµ ê°€ëŠ¥
  - ğŸ’¡ final í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•˜ë©´, ì»´íŒŒì¼ ì‹œì ì— memberRepositoryë¥¼ ì„¤ì •í•˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ í™•ì¸ ê°€ëŠ¥ (ë³´í†µ ê¸°ë³¸ ìƒì„±ì ì¶”ê°€í•  ë•Œ ë°œê²¬)

  - Lombok
    + ğŸ’¡ @AllArgsConstructor : í•„ë“œë¥¼ í†µí•´ ìƒì„±ì ìƒì„±
```java
@AllArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    ...
}
```
```java
public MemberService(MemberRepository memberRepository) { 
      this.memberRepository = memberRepository;
}
```
  - ğŸ’¡ @RequiredArgsConstructor : final í‚¤ì›Œë“œë§Œ ìˆëŠ” í•„ë“œë§Œ ìƒì„±ì ìƒì„±
```java
@RequiredArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    ...
}
```

  - ğŸ’¡ ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ë©´ EntityManagerë„ ì£¼ì… ê°€ëŠ¥
```java
@Repository
@RequiredArgsConstructor
public class MemberService {

    private final EntityManager em;

    ...
}
```

6. ìµœì¢… ì½”ë“œ
   - MemberRepository
```java
package jpabook.jpashop.repository;

import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jpabook.jpashop.domain.Member;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
@RequiredArgsConstructor
public class MemberRepository {

    private final EntityManager em;

    public void save(Member member) {
        em.persist(member);
    }

    public Member findOne(Long id) {
        return em.find(Member.class, id);
    }

    public List<Member> findAll() {
        return em.createQuery("SELECT m FROM Member m", Member.class) // Entity ê°ì²´ ëŒ€ìƒìœ¼ë¡œ ì¡°íšŒ
                .getResultList();
    }

    public List<Member> findByName(String name) {
        return em.createQuery("SELECT m FROM Member m WHERE m.name = :name", Member.class)
                .setParameter("name", name)
                .getResultList();
    }
}
```

  - MemberService
```java
package jpabook.jpashop.service;

import jpabook.jpashop.domain.Member;
import jpabook.jpashop.repository.MemberRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@Transactional(readOnly = true)
@RequiredArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    /**
     * íšŒì› ê°€ì…
     */
    @Transactional // ë³€ê²½ ë©”ì„œë“œì´ë¯€ë¡œ, ê¸°ë³¸ì ìœ¼ë¡œ readOnly = true, ê°€ì…ë§Œ ì œì™¸
    public Long join(Member member) {
        validateDuplicateMember(member); // ì¤‘ë³µ íšŒì› ê²€ì¦
        memberRepository.save(member);

        return member.getId();
    }

    private void validateDuplicateMember(Member member) {
        // ì¤‘ë³µ íšŒì›ì´ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ë°œìƒ
        List<Member> findMembers = memberRepository.findByName(member.getName());

        if(!findMembers.isEmpty()) {
            throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        }
    }

    // íšŒì› ì „ì²´ ì¡°íšŒ
    public List<Member> findMembers() {
        return memberRepository.findAll();
    }

    // íšŒì› í•œ ëª… ì¡°íšŒ
    public Member findOne(Long id) {
        return memberRepository.findOne(id);
    }
}
```
