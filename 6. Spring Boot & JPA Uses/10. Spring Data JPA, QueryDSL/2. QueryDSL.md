-----
### QueryDSL ì†Œê°œ
-----
1. http://www.querydsl.com
2. ì‹¤ë¬´ì—ì„œëŠ” ì¡°ê±´ì— ë”°ë¼ì„œ ì‹¤í–‰ë˜ëŠ” ì¿¼ë¦¬ê°€ ë‹¬ë¼ì§€ëŠ” ë™ì  ì¿¼ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©
3. ì˜ˆ) ì£¼ë¬¸ ë‚´ì—­ ê²€ìƒ‰ìœ¼ë¡œ ë“¤ì–´ê°€ë³´ê³ , ì´ ì˜ˆì œë¥¼ Querydslë¡œ ë³€ê²½
4. build.gradleì— Querydsl ì¶”ê°€ (ì°¸ê³  : ìŠ¤í”„ë§ DB / 13. QueryDSL / 2. QueryDSL ì„¤ì • ì°¸ê³  (+ ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0ì´ìƒ ë²„ì „ ë¶€ë¶„ ì°¸ê³ ))
  - ì°¸ê³  : https://bit.ly/springboot3
```gradle
plugins {
	id 'java'
	id 'org.springframework.boot' version '3.3.2'
	id 'io.spring.dependency-management' version '1.1.6'
}

group = 'jpabook'
version = '0.0.1-SNAPSHOT'

java {
	toolchain {
		languageVersion = JavaLanguageVersion.of(17)
	}
}

configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
	implementation 'org.springframework.boot:spring-boot-starter-validation'
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation 'org.springframework.boot:spring-boot-devtools'
	implementation 'com.github.gavlyukovskiy:p6spy-spring-boot-starter:1.9.0'

	// Hibernate6Module
	implementation 'com.fasterxml.jackson.datatype:jackson-datatype-hibernate6'

	// ğŸ’¡ Querydsl ì¶”ê°€ (ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ì´ìƒ : jakarta ì£¼ì˜)
	implementation 'com.querydsl:querydsl-jpa:5.0.0:jakarta' 
	annotationProcessor "com.querydsl:querydsl-apt:${dependencyManagement.importedProperties['querydsl.version']}:jakarta" 
	annotationProcessor "jakarta.annotation:jakarta.annotation-api" 
	annotationProcessor "jakarta.persistence:jakarta.persistence-api" 

	compileOnly 'org.projectlombok:lombok'
	runtimeOnly 'com.h2database:h2'

	annotationProcessor 'org.projectlombok:lombok'

	testImplementation 'org.springframework.boot:spring-boot-starter-test'

	// JUnit4 ì¶”ê°€
	testImplementation("org.junit.vintage:junit-vintage-engine") {
		exclude group: "org.hamcrest", module: "hamcrest-core"
	}
}

tasks.named('test') {
	useJUnitPlatform()
}

// ğŸ’¡ Querydsl ì¶”ê°€, ìë™ ìƒì„±ëœ Qí´ë˜ìŠ¤ gradle cleanìœ¼ë¡œ ì œê±° (ì¦‰, Q íŒŒì¼ ìƒì„±ì„ ìœ„í•´ Clean)
// ğŸ’¡ğŸ’¡ğŸ’¡ Q Fileì€ ì»´íŒŒì¼ ì‹œì ë§ˆë‹¤ ìƒì„±ë˜ë¯€ë¡œ gitì— ignoreì— ì œê±°
clean {
	delete file('src/main/generated')
}
```

  - ì°¸ê³  : Maven
```gradle
//querydsl ì¶”ê°€
buildscript {
    dependencies {
        classpath("gradle.plugin.com.ewerk.gradle.plugins:querydsl-plugin:1.0.10")
    }
}

plugins {
    id 'org.springframework.boot' version '2.1.9.RELEASE'
    id 'java'
}

apply plugin: 'io.spring.dependency-management'
apply plugin: "com.ewerk.gradle.plugins.querydsl"

group = 'jpabook'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '1.8'

configurations {
    compileOnly {
        extendsFrom annotationProcessor
    }
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-devtools'
    implementation 'com.fasterxml.jackson.datatype:jackson-datatype-hibernate5'
    implementation 'com.github.gavlyukovskiy:p6spy-spring-boot-starter:1.5.6'

    compileOnly 'org.projectlombok:lombok'
    runtimeOnly 'com.h2database:h2'
    annotationProcessor 'org.projectlombok:lombok'

    testImplementation 'org.springframework.boot:spring-boot-starter-test'

    //querydsl ì¶”ê°€
    implementation 'com.querydsl:querydsl-jpa'

    //querydsl ì¶”ê°€
    implementation 'com.querydsl:querydsl-apt'
}

    //querydsl ì¶”ê°€
    //def querydslDir = 'src/main/generated'
def querydslDir = "$buildDir/generated/querydsl"

querydsl {
    library = "com.querydsl:querydsl-apt"
    jpa = true
    querydslSourcesDir = querydslDir
}

sourceSets {  
    main {
        java {
            srcDirs = ['src/main/java', querydslDir]
        }
    }
}

compileQuerydsl{
    options.annotationProcessorPath = configurations.querydsl
}

configurations {
    querydsl.extendsFrom compileClasspath
}
```


6. Querydslë¡œ ì²˜ë¦¬
```java
package jpabook.jpashop.repository;

import com.querydsl.core.types.dsl.BooleanExpression;
import com.querydsl.jpa.impl.JPAQueryFactory;
import jakarta.persistence.EntityManager;
import jakarta.persistence.TypedQuery;
import jakarta.persistence.criteria.*;
import jpabook.jpashop.domain.*;
import jpabook.jpashop.domain.Order;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Repository;
import org.springframework.util.StringUtils;

import java.util.ArrayList;
import java.util.List;

@Repository
public class OrderRepository {
    private final EntityManager em;
    private final JPAQueryFactory query

    public OrderRepository(EntityManager em) {
        this.em = em;
        this.query = new JPAQueryFactory(em);;
    }

    ...

    public List<Order> findAll(OrderSearch orderSearch) {
        QOrder order = QOrder.order; // static import ê°€ëŠ¥
        QMember member = QMember.member; // static import ê°€ëŠ¥

        return query.select(order)
                     .from(order)
                     .join(order.member, member)
                     .where(statusEq(orderSearch.getOrderStatus()), nameLike(orderSearch.getMemberName()))
                     .limit(1000)
                     .fetch();
    }

    private BooleanExpression nameLike(String memberName) {
        if(!StringUtils.hasText(memberName)) {
            return null;
        }

        return QMember.member.name.like("%" + memberName + "%"); // ğŸ’¡ Hibernate 6 ì˜¤ë¥˜ (ì£¼ì˜) : % + ê²€ìƒ‰ì–´ + % ì²¨ê°€ í•„ìš”
    }

    private BooleanExpression statusEq(OrderStatus statusCond) {
        if(statusCond == null) {
            return null;
        }

        return QOrder.order.status.eq(statusCond);
    }
}
```

7. ì •ë¦¬
   - ğŸ’¡ Queeydslì€ SQL(JPQL)ê³¼ ëª¨ì–‘ì´ ìœ ì‚¬í•˜ë©´ì„œ ìë°” ì½”ë“œë¡œ ë™ì  ì¿¼ë¦¬ í¸ë¦¬í•˜ê²Œ ìƒì„± ê°€ëŠ¥
   - ğŸ’¡ ì‹¤ë¬´ì—ì„œëŠ” ë³µì¡í•œ ë™ì  ì¿¼ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë°, ì´ ë•Œ ì‚¬ìš©í•˜ë©´ ë†’ì€ ê°œë°œ ìƒì‚°ì„±ê³¼ ë™ì‹œì— ì¿¼ë¦¬ ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ë¹ ë¥´ê²Œ ì¡ì„ ìˆ˜ ìˆìŒ
   - ğŸ’¡ ê¼­ ë™ì  ì¿¼ë¦¬ê°€ ì•„ë‹ˆë¼ ì •ì  ì¿¼ë¦¬ì¸ ê²½ìš°ì—ë„ ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ
     + ì§ê´€ì ì¸ ë¬¸ë²•
     + ğŸ’¡ ì»´íŒŒì¼ ì‹œì ì— ë¹ ë¥¸ ë¬¸ë²• ì˜¤ë¥˜ ë°œê²¬
     + ì½”ë“œ ìë™ ì™„ì„±
     + ğŸ’¡ ì½”ë“œ ì¬ì‚¬ìš© (JAVA)
     + ğŸ’¡ JPQL new ëª…ë ¹ì–´ì™€ëŠ” ë¹„êµê°€ ì•ˆ ë  ì •ë„ë¡œ ê¹”ë”í•œ DTO ì¡°íšŒ ì§€ì›
  - ğŸ’¡ Querydslì€ JPQLë¥¼ ì½”ë“œë¡œ ë§Œë“œëŠ” ë¹Œë” ì—­í• 
    - ë”°ë¼ì„œ, JPQLë¥¼ ì˜ ì´í•´í•˜ë©´ ê¸ˆë°© ìŠµë“ ê°€ëŠ¥
    - ğŸ’¡ JPAë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ë•Œ ì„ íƒì´ ì•„ë‹Œ í•„ìˆ˜
