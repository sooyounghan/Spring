-----
### íšŒì› ì¡°íšŒ API
-----
1. íšŒì›ì¡°íšŒ V1 : ì‘ë‹µ ê°’ìœ¼ë¡œ ì—”í‹°í‹°ë¥¼ ì§ì ‘ ì™¸ë¶€ì— ë…¸ì¶œ
```java
package jpabook.jpashop.api;

import jakarta.validation.Valid;
import jakarta.validation.constraints.NotEmpty;
import jpabook.jpashop.domain.Member;
import jpabook.jpashop.service.MemberService;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequiredArgsConstructor
public class MemberApiController {
    private final MemberService memberService;

    /**
     * ì¡°íšŒ V1 : ì‘ë‹µ ê°’ìœ¼ë¡œ ì—”í‹°í‹°ë¥¼ ì§ì ‘ ì™¸ë¶€ì— ë…¸ì¶œ
     * - ë¬¸ì œì  :
     *   1. ì—”í‹°í‹°ì— í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µì„ ìœ„í•œ ë¡œì§ ì¶”ê°€
     *   2. ê¸°ë³¸ì ìœ¼ë¡œ ì—”í‹°í‹°ì˜ ëª¨ë“  ê°’ ë…¸ì¶œ
     *   3. ì‘ë‹µ ìŠ¤í™ì„ ë§ì¶”ê¸° ìœ„í•´ ë¡œì§ì´ ì¶”ê°€ (@JsonIgnore, ë³„ë„ì˜ ë·° ë¡œì§ ë“±)
     *   4. ì‹¤ë¬´ì—ì„œëŠ” ê°™ì€ ì—”í‹°í‹°ì— ëŒ€í•´ APIê°€ ìš©ë„ì— ë”°ë¼ ë‹¤ì–‘í•˜ê²Œ ë§Œë“¤ì–´ì§€ëŠ”ë°, í•œ ì—”í‹°í‹°ì— ê°ê°ì˜ APIë¥¼ ìœ„í•œ í”„ë ˆì  í…Œì´ì…˜ ì‘ë‹µ ë¡œì§ì„ ë‹´ê¸°ëŠ” ì–´ë ¤ì›€
     *   5. ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ë©´ API ìŠ¤í™ì´ ë³€í•¨
     *   6. ì¶”ê°€ë¡œ ì»¬ë ‰ì…˜ì„ ì§ì ‘ ë°˜í™˜í•˜ë©´, í–¥í›„ API ìŠ¤í™ì„ ë³€ê²½í•˜ê¸° ì–´ë ¤ì›€ (ë³„ë„ì˜ Result í´ë˜ìŠ¤ ìƒì„±ìœ¼ë¡œ í•´ê²°)
     *
     *  - ê²°ë¡  :
     *    API ì‘ë‹µ ìŠ¤í™ì— ë§ì¶”ì–´ ë³„ë„ì˜ DTO ë°˜í™˜
     */
    // ì¡°íšŒ V1 : ì•ˆ ì¢‹ì€ ë²„ì „, ëª¨ë“  ì—”í‹°í‹°ê°€ ë…¸ì¶œ @JsonIgnore -> ìµœì•…ìœ¼ë¡œ, APIê°€ ì´ê±° í•˜ë‚˜ê°€ ì•„ë‹˜. í™”ë©´ì— ì¢…ì†ì ì´ë©´ ì•ˆ ë¨
    @GetMapping("/api/v1/members")
    public List<Member> membersV1() {
        return memberService.findMembers();
    }
}
```
  - Postman (GET http://localhost:9090/api/v1/members)
```
[
    {
        "id": 1,
        "name": "hello1",
        "address": null,
        "orders": []
    },
    {
        "id": 2,
        "name": "new-hello",
        "address": null,
        "orders": []
    },
    {
        "id": 52,
        "name": "member1",
        "address": {
            "city": "ì„œìš¸",
            "street": "test",
            "zipcode": "111111"
        },
        "orders": []
    },
    {
        "id": 53,
        "name": "member2",
        "address": {
            "city": "ë¶€ì‚°",
            "street": "test",
            "zipcode": "22222"
        },
        "orders": []
    }
]
```

  - ì¡°íšŒ V1 : ì‘ë‹µ ê°’ìœ¼ë¡œ ì—”í‹°í‹°ë¥¼ ì§ì ‘ ì™¸ë¶€ì— ë…¸ì¶œ
  - ë¬¸ì œì 
    + ì—”í‹°í‹°ì— í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µì„ ìœ„í•œ ë¡œì§ ì¶”ê°€
    + ê¸°ë³¸ì ìœ¼ë¡œ ì—”í‹°í‹°ì˜ ëª¨ë“  ê°’ì´ ë…¸ì¶œ
    + ì‘ë‹µ ìŠ¤í™ì„ ë§ì¶”ê¸° ìœ„í•´ ë¡œì§ ì¶”ê°€ (@JsonIgnore, ë³„ë„ì˜ ë·° ë¡œì§ ë“±)
    + ì‹¤ë¬´ì—ì„œëŠ” ê°™ì€ ì—”í‹°í‹°ì— ëŒ€í•´ APIê°€ ìš©ë„ì— ë”°ë¼ ë‹¤ì–‘í•˜ê²Œ ë§Œë“¤ì–´ì§€ëŠ”ë°, í•œ ì—”í‹°í‹°ì— ê° APIë¥¼ ìœ„í•œ í”„ë ˆì  í…Œì´ì…˜ ì‘ë‹µ ë¡œì§ì„ ë‹´ê¸° ì–´ë ¤ì›€
    + ğŸ’¡ ì¶”ê°€ë¡œ, ì»¬ë ‰ì…˜ì„ ì§ì ‘ ë°˜í™˜í•˜ë©´ í–¥í›„ API ìŠ¤í™ ë³€ê²½í•˜ê¸° ì–´ë ¤ì›€ (ë³„ë„ì˜ Result í´ë˜ìŠ¤ ìƒì„±ìœ¼ë¡œ í•´ê²°)
```java
@JsonIgnore // JSON ìŠ¤í™ì—ì„œ ì œì™¸, í™”ë©´ì„ ìœ„í•œ ë³„ë„ì˜ ë·° ë¡œì§ì´ ë“¤ì–´ê°€ê²Œ ë¨
@OneToMany(mappedBy = "member")
private List<Order> orders = new ArrayList<>(); // ordersëŠ” íšŒì› ì •ë³´ ì¡°íšŒì—ì„œ í•„ìš”í•˜ì§€ ì•ŠìŒ
```

  - ê²°ë¡  : API ì‘ë‹µ ìŠ¤í™ì— ë§ì¶”ì–´ ë³„ë„ì˜ DTO ë°˜í™˜
  - ğŸ’¡ ì°¸ê³  : ì—”í‹°í‹°ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œí•˜ì§€ ë§ ê²ƒ
    + ì‹¤ë¬´ì—ì„œëŠ” member ì—”í‹°í‹°ì˜ ë°ì´í„°ê°€ í•„ìš”í•œ APIê°€ ê³„ì† ì¦ê°€í•˜ê²Œ ë  ê²ƒ
    + ì–´ë–¤ APIëŠ” name í•„ë“œê°€ í•„ìš”í•˜ì§€ë§Œ, ì–´ë–¤ APIëŠ” í•„ìš”í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ
    + ë”°ë¼ì„œ, ê²°ë¡ ì ìœ¼ë¡œ, ì—”í‹°í‹° ëŒ€ì‹  API ìŠ¤í™ì— ë§ëŠ” ë³„ë„ì˜ DTOë¥¼ ë…¸ì¶œí•´ì•¼ í•¨

2. íšŒì› ì¡°íšŒ V2 : ì‘ë‹µ ê°’ìœ¼ë¡œ ì—”í‹°í‹°ê°€ ì•„ë‹Œ ë³„ë„ì˜ DTO ì‚¬ìš©
```java
package jpabook.jpashop.api;

import jakarta.validation.Valid;
import jakarta.validation.constraints.NotEmpty;
import jpabook.jpashop.domain.Member;
import jpabook.jpashop.service.MemberService;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.stream.Collectors;

@RestController
@RequiredArgsConstructor
public class MemberApiController {
    private final MemberService memberService;

    ...

    /**
     * ì¡°íšŒ V2 : ì‘ë‹µ ê°’ìœ¼ë¡œ ì—”í‹°í‹°ê°€ ì•„ë‹Œ ë³„ë„ì˜ DTOë¥¼ ë°˜í™˜
     */
    @GetMapping("/api/v2/members")
    public Result membersV2() {
        List<Member> findMembers = memberService.findMembers();

        // Entity -> DTO ë³€í™˜
        List<MemberDto> collect = findMembers.stream()
                .map(m -> new MemberDto(m.getName()))
                .collect(Collectors.toList());

        return new Result(collect);
    }

    @Data
    @AllArgsConstructor
    static class Result<T> {
        private T data;
    }

    @Data
    @AllArgsConstructor
    static class MemberDto {
        private String name;
    }
}
```
  - ì—”í‹°í‹°ë¥¼ DTOë¡œ ë³€í™˜í•´ì„œ ë°˜í™˜
  - ì—”í‹°í‹°ê°€ ë³€í•´ë„ API ìŠ¤í™ì€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
  - ì¶”ê°€ë¡œ Result í´ë˜ìŠ¤ë¡œ ì»¬ë ‰ì…˜ìŒ ê°ì‹¸ì„œ í–¥í›„ í•„ìš”í•œ í•„ë“œ ì¶”ê°€ ê°€ëŠ¥
  - Postman (GET http://localhost:9090/api/v2/members)
```
{
    "data": [
        {
            "name": "hello1"
        },
        {
            "name": "new-hello"
        },
        {
            "name": "member1"
        },
        {
            "name": "member2"
        }
    ]
}
```
