-----
### ì£¼ë¬¸ ì¡°íšŒ V2 : ì—”í‹°í‹°ë¥¼ DTOë¡œ ë°˜í™˜
-----
1. ordersv2
```java
@GetMapping("/api/v2/orders")
public List<OrderDto> ordersV2() {
    List<Order> orders = orderRepository.findAllByString(new OrderSearch());
    List<OrderDto> result = orders.stream()
            .map(OrderDto::new)
            .collect(Collectors.toList());

    return result;
}
```

2. OrderApiControllerì— ì¶”ê°€
```java
@Data
static class OrderDto {
    private Long orderId;
    private String name;
    private LocalDateTime orderDate;
    private OrderStatus orderStatus;
    private Address address;
    private List<OrderItemDto> orderItems;

    public OrderDto(Order order) {
        orderId = order.getId();
        name = order.getMember().getName();
        orderDate = order.getOrderDate();
        orderStatus = order.getStatus();
        address = order.getDelivery().getAddress();

        // order.getOrderItems().forEach(o -> o.getItem().getName());
        // orderItems = order.getOrderItems(); // Entity -> ì´ˆê¸°í™”ë¥¼ í†µí•´ í’€ì–´ì¤Œ

        orderItems = order.getOrderItems().stream()
                .map(OrderItemDto::new)
                .collect(Collectors.toList());
    }
}

@Data
static class OrderItemDto {
    private String itemName; // ìƒí’ˆëª…
    private int orderPrice; // ì£¼ë¬¸ ê°€ê²©
    private int count; // ì£¼ë¬¸ ìˆ˜ëŸ‰

    public OrderItemDto(OrderItem orderItem) {
        itemName = orderItem.getItem().getName();
        orderPrice = orderItem.getOrderPrice();
        count = orderItem.getCount();
    }
}
```
  - ì§€ì—° ë¡œë”©ìœ¼ë¡œ ë„ˆë¬´ ë§ì€ SQL ì‹¤í–‰
  - SQL ì‹¤í–‰ ìˆ˜
    + order 1ë²ˆ
    + member, address Në²ˆ (order ì¡°íšŒ ìˆ˜ ë§Œí¼)
    + orderItem Në²ˆ (order ì¡°íšŒ ìˆ˜ ë§Œí¼)
    + item Në²ˆ (orderItem ì¡°íšŒ ìˆ˜ ë§Œí¼)

  - ì‹¤í–‰ ê²°ê³¼ (GET http://localhost:9090/api/v2/orders)
```
// List<Order> orders = orderRepository.findAllByString(new OrderSearch());
// order 1ë²ˆ
select
    o1_0.order_id,
    o1_0.delivery_id,
    o1_0.member_id,
    o1_0.order_date,
    o1_0.status 
from
    orders o1_0 
join
    member m1_0 
        on m1_0.member_id=o1_0.member_id 
fetch
    first ? rows only

// name = order.getMember().getName();
// member 1ë²ˆ
select
    m1_0.member_id,
    m1_0.city,
    m1_0.street,
    m1_0.zipcode,
    m1_0.name 
from
    member m1_0 
where
    m1_0.member_id=?

// address = order.getDelivery().getAddress();
// address 1ë²ˆ
select
    d1_0.delivery_id,
    d1_0.city,
    d1_0.street,
    d1_0.zipcode,
    d1_0.status 
from
    delivery d1_0 
where
    d1_0.delivery_id=?

// ğŸ’¡ Hibernate 6 ìµœì í™” ë¬¸ì œ (í•´ë‹¹ ì¿¼ë¦¬ëŠ” ë‚˜ì˜¤ì§€ ì•ŠëŠ” ê²ƒì´ ì •ìƒ)
select
    o1_0.order_id,
    o1_0.delivery_id,
    o1_0.member_id,
    o1_0.order_date,
    o1_0.status 
from
    orders o1_0 
where
    o1_0.delivery_id=?

// orderItems = order.getOrderItems().stream()
            .map(OrderItemDto::new)
            .collect(Collectors.toList());
// orderItem 1ë²ˆ

select
    oi1_0.order_id,
    oi1_0.order_item_id,
    oi1_0.count,
    oi1_0.item_id,
    oi1_0.order_price 
from
    order_item oi1_0 
where
    oi1_0.order_id=?

// itemName = orderItem.getItem().getName();
// item 1ë²ˆ
select
    i1_0.item_id,
    i1_0.dtype,
    i1_0.name,
    i1_0.price,
    i1_0.stock_quantity,
    i1_0.artist,
    i1_0.etc,
    i1_0.autor,
    i1_0.isbn,
    i1_0.actor,
    i1_0.director 
from
    item i1_0 
where
    i1_0.item_id=?

// ğŸ’¡ Hibernate 6 ìµœì í™” ë¬¸ì œ (í•´ë‹¹ ì¿¼ë¦¬ëŠ” ë‚˜ì˜¤ì§€ ì•ŠëŠ” ê²ƒì´ ì •ìƒ)
select
    i1_0.item_id,
    i1_0.dtype,
    i1_0.name,
    i1_0.price,
    i1_0.stock_quantity,
    i1_0.artist,
    i1_0.etc,
    i1_0.autor,
    i1_0.isbn,
    i1_0.actor,
    i1_0.director 
from
    item i1_0 
where
    i1_0.item_id=?
```

```json
[
    {
        "orderId": 1,
        "name": "userA",
        "orderDate": "2024-08-28T17:48:03.802934",
        "orderStatus": "ORDER",
        "address": {
            "city": "ì„œìš¸",
            "street": "1",
            "zipcode": "1111"
        },
        "orderItems": [
            {
                "itemName": "JPA BOOK1",
                "orderPrice": 10000,
                "count": 1
            },
            {
                "itemName": "JPA BOOK2",
                "orderPrice": 20000,
                "count": 2
            }
        ]
    },
    {
        "orderId": 2,
        "name": "userB",
        "orderDate": "2024-08-28T17:48:03.885714",
        "orderStatus": "ORDER",
        "address": {
            "city": "ì§„ì£¼",
            "street": "2",
            "zipcode": "2222"
        },
        "orderItems": [
            {
                "itemName": "SPRING BOOK1",
                "orderPrice": 20000,
                "count": 3
            },
            {
                "itemName": "SRPING BOOK2",
                "orderPrice": 40000,
                "count": 4
            }
        ]
    }
]
```

3. ğŸ’¡ ì°¸ê³ 
   - ì§€ì—° ë¡œë”©ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆìœ¼ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ì—”í‹°í‹°ë¥¼ ì‚¬ìš©
   - ì—†ìœ¼ë©´, SQLì„ ì‹¤í–‰
   - ë”°ë¼ì„œ, ê°™ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ë¯¸ ë¡œë”©í•œ íšŒì› ì—”í‹°í‹°ë¥¼ ì¶”ê°€ë¡œ ì¡°íšŒí•˜ë©´ SQLì„ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ

  
