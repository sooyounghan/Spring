-----
### JDBC ê°œë°œ - ë“±ë¡
-----
1. JDBCë¥¼ ì‚¬ìš©í•´ì„œ íšŒì›(Member) ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê¸°ëŠ¥ ê°œë°œ
2. member í…Œì´ë¸”
```sql
drop table member if exists cascade; 
create table member (
    member_id varchar(10),
    money integer not null default 0, 
primary key (member_id)
);
```

3. Member Class
```java
package hello.jdbc.domain;

import lombok.Data;

@Data
// @Data : @Getter + @Setter + @EqualsAndHashCode + @RequiredArgsConstructor
public class Member {
    private String memberId;
    private int money;

    public Member() {

    }

    public Member(String memberId, int money) {
        this.memberId = memberId;
        this.money = money;
    }
}
```

  - member í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ì¡°íšŒí•  ë•Œ ì‚¬ìš©

4. JDBCë¥¼ ì‚¬ìš©í•´ ë§Œë“  íšŒì›(Member) ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
```java
package hello.jdbc.repository;

import hello.jdbc.connection.DBConnectionUtil;
import hello.jdbc.domain.Member;
import lombok.extern.slf4j.Slf4j;

import java.sql.*;

/**
 * JDBC - DriverManager ì‚¬ìš©
 */

@Slf4j
public class MemberRepositoryV0 {

    public Member save(Member member) throws SQLException {
        String sql = "INSERT INTO member(member_id, money) VALUES(?, ?)"; // SQL Query

        Connection conn = null; // Connection ê°ì²´
        PreparedStatement pstmt = null; // SQL ì¿¼ë¦¬ ê°ì²´

        try {
            conn = getConnection(); // Connection ê°ì²´ ì–»ê¸°
            pstmt = conn.prepareStatement(sql); // SQL ì¿¼ë¦¬ ë‹´ê¸°
            pstmt.setString(1, member.getMemberId()); // ? ê°’ ëŒ€ì…
            pstmt.setInt(2, member.getMoney()); // ? ê°’ ëŒ€ì…
            pstmt.executeUpdate();
            return member; // ë°˜í™˜
        } catch (SQLException e) {
            log.error("DB Error", e); // ì˜ˆì™¸ì— ëŒ€í•œ ì—ëŸ¬ ë¡œê·¸ ì¶œë ¥
            throw e;
        } finally {
            close(conn, pstmt, null); // ìì› ë°˜í™˜
        }
    }

    private Connection getConnection() {
        return DBConnectionUtil.getConnection(); // DB Connection ì—°ê²° ë©”ì„œë“œ
    }

    private void close(Connection conn, Statement stmt, ResultSet rs) {
        if(rs != null) { // 1. ResultSet ë°˜í™˜ (ì˜ˆì™¸ ì²˜ë¦¬)
            try {
                rs.close();
            } catch (SQLException e) {
                log.error("Error", e);
            }
        }
        if(stmt != null) {  // 2. Statement ë°˜í™˜ (ì˜ˆì™¸ ì²˜ë¦¬)
            try {
                stmt.close();
            } catch (SQLException e) {
                log.info("Error", e);
            }
        }

        if(conn != null) {  // 3. Connection ë°˜í™˜ (ì˜ˆì™¸ ì²˜ë¦¬)
            try {
                conn.close();
            } catch (SQLException e) {
                log.info("Error", e);
            }
        }
    }
}
```
  - Connection íšë“ : getConnection() â†’ ì´ì „ì— ë§Œë“¤ì–´ë‘” DBConnectionUtilë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ Connection íšë“
  - save() : SQL ì „ë‹¬
    + String sql : ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬í•œ SQL ì •ì˜ (ì—¬ê¸°ì„œëŠ” ë“±ë¡í•´ì•¼ í•˜ë¯€ë¡œ INSERT SQL ì¤€ë¹„)
    + conn.preparedStatement(sql) : ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬í•  SQLê³¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•  ë°ì´í„°ë“¤ì„ ì¤€ë¹„ (PreparedStatment : Parameter Binding ê¸°ëŠ¥ ì¶”ê°€)
      * ğŸ’¡ SQL Injection ê³µê²©ì„ ì˜ˆë°©í•˜ë ¤ë©´ PreparedStatemtë¥¼ í†µí•œ Parameter Binding ë°©ì‹ì„ ì‚¬ìš©í•´ì•¼ í•¨
    + pstmt.setString(1, member.getMemberId()) : SQLì˜ ì²« ë²ˆì§¸ '?'ì— ê°’ì„ ì§€ì • (ë¬¸ìì´ë¯€ë¡œ setString ì‚¬ìš©)
    + pstmt.setInt(2, member.getMoney)) : SQLì˜ ë‘ ë²ˆì§¸ '?'ì— ê°’ì„ ì§€ì • (intí˜• ìˆ«ìì´ë¯€ë¡œ setInt ì§€ì •)
    + pstmt.executeUpdate() : Statementë¥¼ í†µí•´ ì¤€ë¹„ëœ SQLì„ Connectionì„ í†µí•´ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì „ë‹¬
      * ì°¸ê³ ë¡œ, executeUpdate()ëŠ” intë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ì˜í–¥ë°›ì€ DB Rowì˜ ìˆ˜ë¥¼ ë°˜í™˜ (ì—¬ê¸°ì„œëŠ” í•˜ë‚˜ì˜ Rowë¥¼ ë“±ë¡í–ˆìœ¼ë¯€ë¡œ 1ì„ ë°˜í™˜)
```java
int executeUpdate() throws SQLException;
```

5. ë¦¬ì†ŒìŠ¤ ì •ë¦¬
   - ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ë‚˜ë©´, ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•´ì•¼ í•¨
   - ì—¬ê¸°ì„œëŠ” Connection, PreparedStatementë¥¼ ì‚¬ìš©
   - ğŸ’¡ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•  ë•ŒëŠ” í•­ìƒ ì—­ìˆœìœ¼ë¡œ í•´ì•¼í•¨
   - Connectionì„ ë¨¼ì € íšë“í•˜ê³ , ì´ë¥¼ í†µí•´ PreparedStatementë¥¼ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì—, ë¦¬ì†ŒìŠ¤ë¥¼ ë°˜í™˜í•  ë•ŒëŠ” Preparedstatementë¥¼ ë¨¼ì € ì¢…ë£Œí•˜ê³ , ê·¸ ë‹¤ìŒ Connecitonì„ ì¢…ë£Œí•˜ë©´ ë¨
   - ì°¸ê³ ë¡œ, ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ì§€ ì•Šì€ ResultSetì€ ê²°ê³¼ë¥¼ ì¡°íšŒí•  ë•Œ ì‚¬ìš©

6. ë¦¬ì†ŒìŠ¤ ì •ë¦¬ëŠ” ê¼­ í•´ì¤˜ì•¼ í•¨. ë”°ë¼ì„œ, ì˜ˆì™¸ê°€ ë°œìƒí•˜ë“ , í•˜ì§€ ì•Šë“  í•­ìƒ ìˆ˜í–‰ë˜ì–´ì•¼í•˜ë¯€ë¡œ finally êµ¬ë¬¸ì— ì£¼ì˜í•´ì„œ ì‘ì„±
   - ë§Œì•½ ì´ ë¶€ë¶„ì„ ë†“ì¹˜ê²Œ ë˜ë©´, Connectionì´ ëŠì–´ì§€ì§€ ì•Šê³ , ê³„ì† ìœ ì§€ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒ
   - ì´ë¥¼ ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ë¼ê³  í•˜ëŠ”ë°, ê²°ê³¼ì ìœ¼ë¡œ Connection ë¶€ì¡±ìœ¼ë¡œ ì¥ì• ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ

7. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
```java
package hello.jdbc.repository;

import hello.jdbc.domain.Member;
import org.junit.jupiter.api.Test;

import java.sql.SQLException;

import static org.junit.jupiter.api.Assertions.*;

class MemberRepositoryV0Test {
    MemberRepositoryV0 repository = new MemberRepositoryV0();

    @Test
    void crud() throws SQLException {
        Member member = new Member("memberV0", 10000);
        repository.save(member);
    }
}
```
  - ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ SELECT * FROM MEMBER ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ë©´, ë°ì´í„°ê°€ ì €ì¥ëœ ê²ƒ í™•ì¸ ê°€ëŠ¥
  - í•˜ì§€ë§Œ, ì´ í…ŒìŠ¤íŠ¸ë¥¼ 2ë²ˆ ì‹¤í–‰í•˜ë©´ PK ì¤‘ë³µ ì˜¤ë¥˜ê°€ ë°œìƒ (ì´ ê²½ìš°, DELETE FROM MEMBER ì¿¼ë¦¬ë¡œ ë°ì´í„° ì‚­ì œí•œ ë‹¤ìŒ ì‹¤í–‰)
<div align="center">
<img src="https://github.com/sooyounghan/Spring/assets/34672301/26873b5d-9902-47c3-841a-e3c7981d472d">
</div>
