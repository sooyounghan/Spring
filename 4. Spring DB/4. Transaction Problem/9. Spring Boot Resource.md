-----
### ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ìë™ ë¦¬ì†ŒìŠ¤ ë“±ë¡
-----
1. ìŠ¤í”„ë§ ë¶€íŠ¸ ë“±ì¥ ì´ì „ì—ëŠ” ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡í–ˆì–´ì•¼ í•¨
2. ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì§ì ‘ ë“±ë¡
```java
@Bean // DataSource ë¹ˆ ë“±ë¡
DataSource dataSource() {
    return new DriverManagerDataSource(URL, USERNAME, PASSWORD);
}

@Bean // íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ë¹ˆ ë“±ë¡
PlatformTransactionManager transactionManager() {
    return new DataSourceTransactionManager(dataSource());
}
````
  - ê¸°ì¡´ì—ëŠ” ì´ë ‡ê²Œ ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í–ˆì–´ì•¼ í•¨
  - ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ë‚˜ì˜¤ë©´ì„œ, ì´ëŸ¬í•œ ë§ì€ ë¶€ë¶„ì´ ìë™í™” ë¨ (ê³¼ê±° : XML ë°©ì‹ìœ¼ë¡œ ë“±ë¡í•˜ê³  ê´€ë¦¬)

3. ë°ì´í„°ì†ŒìŠ¤ - ìë™ ë“±ë¡
   - ìŠ¤í”„ë§ë¶€íŠ¸ëŠ” ë°ì´í„°ì†ŒìŠ¤(DataSource)ë¥¼ ìŠ¤í”„ë§ ë¹ˆì— ìë™ ë“±ë¡
   - ğŸ’¡ ìë™ ë“±ë¡ë˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„ : dataSource
   - ì§ì ‘ ë°ì´í„°ì†ŒìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´, ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë°ì´í„° ì†ŒìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•ŠìŒ

4. ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ application.propertiesì— ìˆëŠ” ì†ì„±ì„ ì‚¬ìš©í•´ DataSourceë¥¼ ìƒì„±í•œ ë’¤, ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡
```properties
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa
spring.datasource.password=
```
  - ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ê¸°ë³¸ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë°ì´í„°ì†ŒìŠ¤ëŠ” ì»¤ë„¥ì…˜ í’€ì„ ì œê³µí•˜ëŠ” HikariDataSource
  - ì»¤ë„¥ì…˜í’€ê³¼ ê´€ë ¨ëœ ì„¤ì •ë„ application.propertiesë¥¼ í†µí•´ ì§€ì • ê°€ëŠ¥
  - spring.datasource.url ì†ì„±ì´ ì—†ìœ¼ë©´ ë‚´ì¥ ë°ì´í„°ë² ì´ìŠ¤(ë©”ëª¨ë¦¬ DB)ë¥¼ ìƒì„±í•˜ë ¤ê³  ì‹œë„

5. íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € - ìë™ ë“±ë¡
   - ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì ì ˆí•œ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €(PlatformTransactionManager)ë¥¼ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡
     + ğŸ’¡ ìë™ìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„ : transactionManager
   - ì§ì ‘ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´, ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•ŠìŒ
   - ì–´ë–¤ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì„ íƒí• ì§€ëŠ” í˜„ì¬ ë“±ë¡ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë³´ê³  íŒë‹¨í•˜ëŠ”ë°, JDBCë¥¼ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ë©´ DataSourceTransactionManagerë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡
   - JPAë¥¼ ì‚¬ìš©í•˜ë©´ JpaTransactionManagerë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡
   - ë‘˜ ë‹¤ ì‚¬ìš©í•˜ëŠ” ê²½ìš° JpaTransactionManagerë¥¼ ë“±ë¡
   - ì°¸ê³ ë¡œ, JpaTransactionManagerëŠ” DataSourceTransactionManagerê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ ëŒ€ë¶€ë¶„ ì§€ì›

6. ë°ì´í„°ì†ŒìŠ¤, íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ì§ì ‘ ë“±ë¡
```java
@Bean // DataSource ë¹ˆ ë“±ë¡
        DataSource dataSource() {
            return new DriverManagerDataSource(URL, USERNAME, PASSWORD);
        }

        @Bean // íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ë¹ˆ ë“±ë¡
        PlatformTransactionManager transactionManager() {
            return new DataSourceTransactionManager(dataSource());
        }

        @Bean // memberRepositoryV3 ë“±ë¡
        MemberRepositoryV3 memberRepositoryV3() {
            return new MemberRepositoryV3(dataSource());
        }

        @Bean // memberServiceV3_3 ë“±ë¡
        MemberServiceV3_3 memberServiceV3_3() {
            return new MemberServiceV3_3(memberRepositoryV3());
        }
```

7. ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì œê³µí•˜ëŠ” ìë™ ë“±ë¡ì„ ì´ìš©í•´ ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ë“±ë¡
   - application.properties
```properties
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa
spring.datasource.password=
```
  - MemberServiceTestV3_4Test
```java
package hello.jdbc.service;

import hello.jdbc.domain.Member;
import hello.jdbc.repository.MemberRepositoryV3;
import lombok.extern.slf4j.Slf4j;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.aop.support.AopUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.context.annotation.Bean;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.transaction.PlatformTransactionManager;

import javax.sql.DataSource;
import java.sql.SQLException;

import static hello.jdbc.connection.ConnectionConst.*;
import static org.assertj.core.api.AssertionsForClassTypes.assertThatThrownBy;
import static org.assertj.core.api.AssertionsForInterfaceTypes.assertThat;

/**
 * íŠ¸ëœì­ì…˜ - DataSource, TransactionManager ìë™ ë“±ë¡
 */
@Slf4j
@SpringBootTest // í…ŒìŠ¤íŠ¸ ë‚´ì—ì„œ ìŠ¤í”„ë§ ë¶€íŠ¸ ì ìš©
class MemberServiceV3_4Test {

    ...

    @Autowired // ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ë˜ë¯€ë¡œ, ìŠ¤í”„ë§ ë¹ˆì„ í†µí•œ ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…
    MemberRepositoryV3 memberRepository;
    @Autowired
    MemberServiceV3_3 memberService;

    @TestConfiguration // ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë‚´ ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì¡°ì„±
    static class TestConfig {
        
        private final DataSource dataSource;

        public TestConfig(DataSource dataSource) {
            this.dataSource = dataSource;
        }

        @Bean // memberRepositoryV3 ë“±ë¡
        MemberRepositoryV3 memberRepositoryV3() {
            return new MemberRepositoryV3(dataSource());
        }

        @Bean // memberServiceV3_3 ë“±ë¡
        MemberServiceV3_3 memberServiceV3_3() {
            return new MemberServiceV3_3(memberRepositoryV3());
        }
    }

    ...
}
```
  - ê¸°ì¡´(MemberServiceV3_3Test)ì™€ ê°™ì€ ì½”ë“œì´ë©° TestConfig ë¶€ë¶„ë§Œ ë‹¤ë¦„
  - ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ì½”ë“œ ìƒëµ
  - ë”°ë¼ì„œ, ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ application.propertiesì— ì§€ì •ëœ ì†ì„±ì„ ì°¸ê³ í•´ ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±
  - ìƒì„±ìë¥¼ í†µí•´ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ë§Œë“¤ì–´ì¤€ ë°ì´í„°ì†ŒìŠ¤ ë¹ˆì„ ì£¼ì…ë°›ì„ ìˆ˜ ìˆìŒ

-----
### ì •ë¦¬
-----
1. ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì œê³µí•˜ëŠ” ìë™ ë¹ˆ ë“±ë¡ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ í¸ë¦¬
2. ì¶”ê°€ë¡œ application.propertiesë¥¼ í†µí•´ ì„¤ì •ë„ í¸ë¦¬í•˜ê²Œ ë“±ë¡ ê°€ëŠ¥
   - ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ ë°ì´í„° ì†ŒìŠ¤ ìë™ ë“±ë¡ : https://docs.spring.io/spring-boot/reference/data/sql.html#data.sql.datasource.production
   - ìì„¸í•œ ì„¤ì • ì†ì„± : https://docs.spring.io/spring-boot/appendix/application-properties/index.html
