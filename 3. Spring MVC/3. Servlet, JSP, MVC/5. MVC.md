-----
### MVC íŒ¨í„´ ì ìš©
-----
1. Servletì„ Controller, JSPë¥¼ Viewë¡œ ì‚¬ìš©í•´ì„œ MVC íŒ¨í„´ ì ìš©
2. Modelì€ HttpServletRequest ê°ì²´ë¥¼ ì‚¬ìš©
   - requestëŠ” ë‚´ë¶€ì— ë°ì´í„° ì €ì¥ì†Œë¥¼ ê°€ì§€ê³  ìˆëŠ”ë°, request.setAttribute(), request.getAttribute()ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³ , ì¡°íšŒí•  ìˆ˜ ìˆìŒ

-----
### íšŒì› ë“±ë¡
-----
1. íšŒì› ë“±ë¡ í¼ - ì»¨íŠ¸ë¡¤ëŸ¬
```java
package hello.servlet.web.servletmvc;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

@WebServlet(name = "mvcMemberFormServlet", urlPatterns = "/servlet-mvc/members/new-form")
public class MvcMemberFormServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String viewPath = "/WEB-INF/views/new-form.jsp";
        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }
}
```

  - dispatcher.forward() : ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSPë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ìœ¼ë¡œ, ì„œë²„ ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ í˜¸ì¶œì´ ë°œìƒ
  - /WEB-INF : ì´ ê²½ë¡œì•ˆì— JSPê°€ ìˆìœ¼ë©´, ì™¸ë¶€ì—ì„œ ì§ì ‘ JSPë¥¼ í˜¸ì¶œí•  ìˆ˜ ì—†ìŒ (ì¦‰, í•­ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•´ì„œ JSPê°€ í˜¸ì¶œ)

2. ğŸ’¡Redirect vs Forward
   - Redirect : ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸(ì›¹ ë¸Œë¼ìš°ì €)ì— ì‘ë‹µì´ ë‚˜ê°”ë‹¤ê°€, í´ë¼ì´ì–¸íŠ¸ê°€ redirect ê²½ë¡œë¡œ ë‹¤ì‹œ ìš”ì²­í•˜ëŠ” ê²ƒ. ë”°ë¼ì„œ, í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì§€í•  ìˆ˜ ìˆê³ , URL ê²½ë¡œë„ ì‹¤ì œë¡œ ë³€ê²½
   - Forward : ì„œë²„ ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” í˜¸ì¶œì´ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì „í˜€ ì¸ì§€í•˜ì§€ ëª»í•¨

3. íšŒì› ë“±ë¡ í¼ - ë·° (main/webapp/WEB-INF/views/new-form.jsp)
```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
ğŸ’¡ <!-- ìƒëŒ€ê²½ë¡œ ì‚¬ìš©, [í˜„ì¬ URLì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + /save] -->
    <form action="save" method="post">
        username: <input type="text" name="username" />
        age:      <input type="text" name="age" />
        <button type="submit">ì „ì†¡</button>
    </form>
</body>
</html>
```
  - formì˜ action : ì ˆëŒ€ ê²½ë¡œ(/ë¡œ ì‹œì‘)ê°€ ì•„ë‹ˆë¼ ìƒëŒ€ ê²½ë¡œ(/ë¡œ ë¯¸ì‹œì‘)ì¸ ê²ƒ í™•ì¸ ê°€ëŠ¥
  - ìƒëŒ€ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ë©´ í¼ ì „ì†¡ì‹œ í˜„ì¬ URLì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + saveê°€ í˜¸ì¶œ
  - í˜„ì¬ ê³„ì¸µ ê²½ë¡œ : /servlet-mvc/members/
  - ê²°ê³¼ : /servlet-mvc/members/save
  - ì‹¤í–‰ : http://localhost:9090/servlet-mvc/members/new-form
  - HTML Formì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥

-----
### íšŒì› ì €ì¥
------
1. íšŒì› ì €ì¥ - ì»¨íŠ¸ë¡¤ëŸ¬
```java
package hello.servlet.web.servletmvc;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

@WebServlet(name = "mvcMemberSaveServlet", urlPatterns = "/servlet-mvc/members/save")
public class MvcMemberSaveServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        // Modelì— ë°ì´í„° ë³´ê´€
        request.setAttribute("member", member);

        // View ì´ë™
        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }
}
```

  - HttpServletRequestë¥¼ Modelë¡œ ì‚¬ìš©
  - requestê°€ ì œê³µí•˜ëŠ” setAttribute()ë¥¼ ì‚¬ìš©í•˜ë©´, request ê°ì²´ì— ë°ì´í„°ë¥¼ ë³´ê´€í•´ ë·°ì— ì „ë‹¬ ê°€ëŠ¥
  - ë·°ëŠ” request.getAttribute()ë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ êº¼ë‚´ë©´ ë¨

2. íšŒì› ì €ì¥ - ë·°
```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>
ì„±ê³µ
<ul>
    <li>id =${member.id}</li>
    <li>username =${member.username}</li>
    <li>age=${member.age}</li>
</ul>

<a href = "/index.html"> Main </a>

</body>
</html>
```

  - ```<%=request.getAttribute("member")%>```ë¡œ ëª¨ë¸ì— ì €ì¥í•œ member ê°ì²´ë¥¼ êº¼ë‚¼ ìˆ˜ ìˆì§€ë§Œ, ë³µì¡í•´ì§
  - JSPëŠ” ${} ë¬¸ë²• ì œê³µí•˜ëŠ”ë°, ì´ ë¬¸ë²•ì„ ì‚¬ìš©í•˜ë©´ requestì˜ attributeì— ë‹´ê¸´ ë°ì´í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ ê°€ëŠ¥
  - ì‹¤í–‰ : http://localhost:9090/servlet-mvc/members/new-form
  - HTML Formì— ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³ , ì „ì†¡ì„ ëˆ„ë¥´ë©´ ì €ì¥ ê²°ê³¼ í™•ì¸ ê°€ëŠ¥

3. MVC ë•ë¶„ì— ì»¨íŠ¸ë¡¤ëŸ¬ ë¡œì§ê³¼ ë·° ë¡œì§ì„ í™•ì‹¤í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìœ¼ë©°, í–¥í›„ í™”ë©´ì— ìˆ˜ì •ì´ ë°œìƒí•˜ë©´ ë·° ë¡œì§ë§Œ ë³€ê²½í•˜ë©´ ë¨

-----
### íšŒì› ëª©ë¡
-----
1. íšŒì› ëª©ë¡ ì¡°íšŒ - ì»¨íŠ¸ë¡¤ëŸ¬
```java
package hello.servlet.web.servletmvc;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.util.List;

@WebServlet(name = "mvcMemberListServlet", urlPatterns = "/servlet-mvc/members")
public class MvcMemberListServlet extends HttpServlet {
    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String viewPath = "/WEB-INF/views/members.jsp";

        List<Member> members = memberRepository.findAll();
        request.setAttribute("members", members);

        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }
}
```
   - request ê°ì²´ë¥¼ ì‚¬ìš©í•´ List<Member> memberë¥¼ ëª¨ë¸ì— ë³´ê´€

2. íšŒì› ëª©ë¡ ì¡°íšŒ - ë·°
```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>

<html>
<head>
    <title>Title</title>
</head>
<body>

<table>
    <thead>
    <th>id</th>
    <th>username</th>
    <th>age</th>
    </thead>
    <tbody>
        <c:forEach var="item" items="${members}">
            <tr>
                <td>${item.id}</td>
                <td>${item.username}</td>
                <td>${item.age}</td>
            </tr>
        </c:forEach>
    </tbody>
</table>
</body>
</html>
```
   - ëª¨ë¸ì— ë‹´ì•„ë‘” membersë¥¼ JSPê°€ ì œê³µí•˜ëŠ” taglib ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ ë°˜ë³µí•˜ë©´ì„œ ì¶œë ¥
   - members ë¦¬ìŠ¤íŠ¸ì—ì„œ memberë¥¼ ìˆœì„œëŒ€ë¡œ êº¼ë‚´ì„œ item ë³€ìˆ˜ì— ë‹´ê³ , ì¶œë ¥í•˜ëŠ” ê³¼ì • ë°˜ë³µ
   - <c:forEach> ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì„ ì–¸
```jsp
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
```

   - í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥í•´ë„ ë˜ì§€ë§Œ, ë§¤ìš° ì§€ì €ë¶„í•¨
   - JSPì™€ ê°™ì€ ë·° í…œí”Œë¦¿ì€ ì´ë ‡ê²Œ í™”ë©´ì„ ë Œë”ë§ í•˜ëŠ”ë° íŠ¹í™”ëœ ë‹¤ì–‘í•œ ê¸°ëŠ¥ ì œê³µ
   - ì‹¤í–‰ : http://localhost:9090/servlet-mvc/members
   - ì €ì¥ëœ ê²°ê³¼ ëª©ë¡ í™•ì¸ ê°€ëŠ¥

<div align="center">
<img src="https://github.com/sooyounghan/Spring/assets/34672301/1b3095f9-acc2-464c-bf05-0e52dfdfd61f>
</div>
