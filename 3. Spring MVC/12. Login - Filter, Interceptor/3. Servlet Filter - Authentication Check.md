-----
### Servlet Filter - ì¸ì¦ ì²´í¬
-----
1. ë¡œê·¸ì¸ ë˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ìƒí’ˆ ê´€ë¦¬ ë¿ë§Œ ì•„ë‹ˆë¼ ë¯¸ë˜ì— ê°œë°œëœ í˜ì´ì§€ë¡œ ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ì„¤ì •
2. LoginCheckFilter - ì¸ì¦ ì²´í¬ í•„í„°
```java
package hello.login.web.filter;

import hello.login.web.SessionConst;
import jakarta.servlet.*;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import lombok.extern.slf4j.Slf4j;
import org.springframework.util.PatternMatchUtils;

import java.io.IOException;

@Slf4j
public class LoginCheckFilter implements Filter {

    private static final String[] whiteList = {"/", "/members/add", "/login", "/logout", "/css/*"};

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        String requestURI = httpRequest.getRequestURI();

        HttpServletResponse httpResponse = (HttpServletResponse) response;

        try {
            log.info("ì¸ì¦ ì²´í¬ í•„í„° ì‹œì‘ = [{}]", requestURI);

            if(isLoginCheckPath(requestURI)) {
                log.info("ì¸ì¦ ì²´í¬ ë¡œì§ ì‹¤í–‰ = [{}]", requestURI);
                HttpSession session = httpRequest.getSession(false);
                if(session == null || session.getAttribute(SessionConst.LOGIN_MEMBER) == null) {
                    log.info("ë¯¸ì¸ì¦ ì‚¬ìš©ì ìš”ì²­ = [{}]", requestURI);

                    // ë¡œê·¸ì¸ìœ¼ë¡œ Redirect
                    httpResponse.sendRedirect("/login?redirectURL=" + requestURI);

                    return; // ì¸ì¦ì„ ì§„í–‰í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ë”ì´ìƒ ì§„í–‰í•˜ì§€ ì•Šê³  ë
                }
            }
            chain.doFilter(request, response);
        } catch (Exception e) {
            throw e; // Exception Logging ê°€ëŠ¥í•˜ì§€ë§Œ, Tomcatê¹Œì§€ ì˜ˆì™¸ë¥¼ ë³´ë‚´ì¤˜ì•¼í•¨
        } finally {
            log.info("ì¸ì¦ ì²´í¬ í•„í„° ì¢…ë£Œ = [{}]", requestURI);
        }
    }

    /**
     * whiteListì˜ ê²½ìš° ì¸ì¦ ì²´í¬ë¥¼ í•˜ì§€ ì•ŠìŒ
     */
    private boolean isLoginCheckPath(String requestURI) {
        return !PatternMatchUtils.simpleMatch(whiteList, requestURI);
    }
}
```

3. whiteList = {"/", "/members/add", "/login, "/logout", "/css/*"};
   - ì¸ì¦ í•„í„°ë¥¼ ì ìš©í•´ë„ í™ˆ, íšŒì›ê°€ì…, ë¡œê·¸ì¸ í™”ë©´, CSS ê°™ì€ ë¦¬ì†ŒìŠ¤ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼ í•¨
   - í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ì˜ ê²½ë¡œëŠ” ì¸ì¦ê³¼ ë¬´ê´€í•˜ê²Œ í•­ìƒ í—ˆìš©
   - í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ì œì™¸í•œ ëª¨ë“  ê²½ë¡œì—ëŠ” ì¸ì¦ ì²´í¬ ë¡œì§ì„ ì ìš©

4. isLoginCheckPath(requestURI) : í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ì œì™¸í•œ ëª¨ë“  ê²½ìš°ì— ì¸ì¦ ì²´í¬ ë¡œì§ì„ ì ìš©
5. httpResponse.sendRedirect("/login?redirectURL=" + requestURI);
   - ë¯¸ì¸ì¦ ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ Redirect
   - ê·¸ëŸ°ë° ë¡œê·¸ì¸ ì´í›„ ë‹¤ì‹œ í™ˆìœ¼ë¡œ ì´ë™í•´ë²„ë¦¬ë©´, ì›í•˜ëŠ” ê²½ë¡œë¥¼ ë‹¤ì‹œ ì°¾ì•„ê°€ì•¼í•˜ëŠ” ë¶ˆí¸í•¨ ì¡´ì¬
   - ì˜ˆë¥¼ ë“¤ì–´, ìƒí’ˆ ê´€ë¦¬ í™”ë©´ì„ ë³´ë ¤ê³  ë“¤ì–´ì™”ë‹¤ê°€ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ë©´, ë¡œê·¸ì¸ ì´í›„ì— ë‹¤ì‹œ ìƒí’ˆ ê´€ë¦¬ í™”ë©´ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì´ ì¢‹ìŒ
   - ì´ëŸ° ë¶€ë¶„ì´ ê°œë°œì—ì„œ ì¡°ê¸ˆ ë¶ˆí¸í•˜ì§€ë§Œ, ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ” í¸ë¦¬í•œ ê¸°ëŠ¥
   - ë”°ë¼ì„œ, ì´ëŸ¬í•œ ê¸°ëŠ¥ì„ ìœ„í•´ í˜„ì¬ ìš”ì²­í•œ ê²½ë¡œì¸ requestURIë¥¼ /loginì— ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ í•¨ê»˜ ì „ë‹¬
   - ë¬¼ë¡ , /login ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í•´ë‹¹ ê²½ë¡œë¡œ ì´ë™í•˜ëŠ” ê¸°ëŠ¥ì€ ì¶”ê°€ë¡œ ê°œë°œ
6. ğŸ’¡ return;
   - í•„í„°ëŠ” ë”ëŠ” ì§„í–‰í•˜ì§€ ì•ŠìŒ
   - ì´í›„ í•„í„°ëŠ” ë¬¼ë¡ , ì„œë¸”ë¦¿, ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë”ëŠ” í˜¸ì¶œë˜ì§€ ì•ŠìŒ
   - ì•ì„œ redirectë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì—, redirectê°€ ì‘ë‹µìœ¼ë¡œ ì ìš©ë˜ê³  ìš”ì²­ì´ ëë‚¨

-----
### WebConfig - loginCheckFilter() ì¶”ê°€
-----
```java
package hello.login.web.login;

import hello.login.web.filter.LogFilter;
import hello.login.web.filter.LoginCheckFilter;
import jakarta.servlet.Filter;
import jakarta.servlet.FilterRegistration;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class WebConfig {
    ...

    @Bean
    public FilterRegistrationBean loginCheckFilter() {
        FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();
        filterRegistrationBean.setFilter(new LoginCheckFilter());
        filterRegistrationBean.setOrder(2);
        filterRegistrationBean.addUrlPatterns("/*");

        return filterRegistrationBean;
    }
}
```
1. setFilter(new LoginCheckFilter()) : ë¡œê·¸ì¸ í•„í„° ë“±ë¡
2. setOrder(2) : ìˆœì„œë¥¼ 2ë²ˆìœ¼ë¡œ ë“±ë¡, ë¡œê·¸ í•„í„° ë‹¤ìŒ ë¡œê·¸ì¸ í•„í„° ì ìš©
3. addUrlPattern("/*") : ëª¨ë“  ìš”ì²­ì— ë¡œê·¸ì¸ í•„í„° ì ìš©

-----
### RedirectURL ì²˜ë¦¬
-----
1. ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ì²˜ìŒ ìš”ì²­í•œ URLë¡œ ì´ë™í•˜ëŠ” ê¸°ëŠ¥ ê°œë°œ
2. LoginController - loginV4()
```java
/**
 * ë¡œê·¸ì¸ ì´í›„ redirect
 */
@PostMapping("/login")
public String loginV4(@Valid @ModelAttribute("loginForm") LoginForm loginForm,
                      BindingResult bindingResult,
                      @RequestParam(defaultValue = "/") String redirectURL,
                      HttpServletRequest request) {
    if(bindingResult.hasErrors()) {
        return "login/loginForm";
    }

    // ë¡œê·¸ì¸ ì‹œë„
    Member loginMember = loginService.login(loginForm.getLoginId(), loginForm.getPassword());

    // ë¡œê·¸ì¸í•œ íšŒì›ì˜ ì •ë³´ê°€ ì—†ì„ ë•Œ
    if(loginMember == null) {
        bindingResult.reject("loginFail", "ID ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        return "login/loginForm";
    }

    // ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬

    // ì„¸ì…˜ì´ ìˆìœ¼ë©´ ì„¸ì…˜ ë°˜í™˜, ì—†ìœ¼ë©´ ì‹ ê·œ ì„¸ì…˜ì„ ìƒì„±
    HttpSession session = request.getSession();

    // ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€
    session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);

    // redirectURL ì ìš©
    return "redirect:" + redirectURL;
}
```
  - ë¡œê·¸ì¸ ì²´í¬ í•„í„°ì—ì„œ ë¯¸ì¸ì¦ ì‚¬ìš©ìëŠ” ìš”ì²­ ê²½ë¡œë¥¼ í¬í•¨í•´ /loginì— redirectURL ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•´ì„œ ìš”ì²­
  - ì´ ê°’ì„ ì‚¬ìš©í•´ ë¡œê·¸ì¸ ì„±ê³µì‹œ í•´ë‹¹ ê²½ë¡œë¡œ ê³ ê°ì„ redirect

-----
### ì •ë¦¬
-----
1. ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì˜ ì‚¬ìš©í•˜ë©´ ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ë‚˜ë¨¸ì§€ ê²½ë¡œì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ê²Œ ë¨
2. ì¦‰, ê³µí†µ ê´€ì‹¬ì‚¬ë¥¼ ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì‚¬ìš©í•´ í–¥í›„ ë¡œê·¸ì¸ ê´€ë ¨ ì •ì±…ì´ ë³€ê²½ë˜ì–´ë„ ì´ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨
3. í•„í„°ì—ëŠ” ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ì—ì„œ ì œê³µí•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ ì¡´ì¬
   - chain.doFilter(request, response); ë¥¼ í˜¸ì¶œí•´ì„œ ë‹¤ìŒ í•„í„° ë˜ëŠ” ì„œë¸”ë¦¿ì„ í˜¸ì¶œí•  ë•Œ, request, responseë¥¼ ë‹¤ë¥¸ ê°ì²´ë¡œ ë³€ê²½ ê°€ëŠ¥
   - ServletRequest, ServletResponseë¥¼ êµ¬í˜„í•œ ë‹¤ë¥¸ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ë„˜ê¸°ë©´ í•´ë‹¹ ê°ì²´ê°€ ë‹¤ìŒ í•„í„° ë˜ëŠ” ì„œë¸”ë¦¿ì—ì„œ ì‚¬ìš©
