-----
### HttpSession
-----
1. ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” HttpSession
2. ì„œë¸”ë¦¿ì„ í†µí•´ HttpSessionì„ ìƒì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¿ í‚¤ ìƒì„±
   - ì¿ í‚¤ ì´ë¦„ : JSESSIONID
   - ê°’ì€ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ëœë¤ ê°’
```
Cookie: JSESSIONID=5B78E23B513F50164D6FDD8C97B0AD05
```

-----
### HttpSession ì‚¬ìš©
-----
1. SessionConst
```java
package hello.login.web;

public class SessionConst {
    public static final String LOGIN_MEMBER = "loginMember";
}
```
  - HttpSessionì— ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³  ì¡°íšŒí•  ë•Œ, ê°™ì€ ì´ë¦„ì´ ì¤‘ë³µë˜ì–´ ì‚¬ìš©ë˜ë¯€ë¡œ ìƒìˆ˜ í•˜ë‚˜ ì •ì˜

2. LoginController - loginV3()
```java
@PostMapping("/login")
public String loginV3(@Valid @ModelAttribute("loginForm") LoginForm loginForm, BindingResult bindingResult, HttpServletRequest request) {
    if(bindingResult.hasErrors()) {
        return "login/loginForm";
    }

    // ë¡œê·¸ì¸ ì‹œë„
    Member loginMember = loginService.login(loginForm.getLoginId(), loginForm.getPassword());

    // ë¡œê·¸ì¸í•œ íšŒì›ì˜ ì •ë³´ê°€ ì—†ì„ ë•Œ
    if(loginMember == null) {
        bindingResult.reject("loginFail", "ID ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        return "login/loginForm";
    }

    // ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
    
    // ì„¸ì…˜ì´ ìˆìœ¼ë©´ ì„¸ì…˜ ë°˜í™˜, ì—†ìœ¼ë©´ ì‹ ê·œ ì„¸ì…˜ì„ ìƒì„±
    HttpSession session = request.getSession();
    
    // ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€
    session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);

    return "redirect:/";
}
```

3. ì„¸ì…˜ ìƒì„±ê³¼ ì¡°íšŒ
  - ì„¸ì…˜ì„ ìƒì„±í•˜ë ¤ë©´ request.getSession(true) ì‚¬ìš©
```java
public HttpSession getSession(boolean create);
```
  - ì„¸ì…˜ì˜ create ì˜µì…˜
    + request.getSession(true)
      * ì„¸ì…˜ì´ ìˆìœ¼ë©´, ê¸°ì¡´ ì„¸ì…˜ ë°˜í™˜
      * ì„¸ì…˜ì´ ì—†ìœ¼ë©´, ìƒˆë¡œìš´ ì„¸ì…˜ ìƒì„±í•´ì„œ ë°˜í™˜
    + request.getSession(false)
      * ì„¸ì…˜ì´ ìˆìœ¼ë©´, ê¸°ì¡´ ì„¸ì…˜ ë°˜í™˜
      * ì„¸ì…˜ì´ ì—†ìœ¼ë©´, ìƒˆë¡œìš´ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šìœ¼ë©°, null ë°˜í™˜
     
  - request.getSession() = ì‹ ê·œ ìƒì„±ì„ ìƒì„±í•˜ëŠ” request.getSession(true)ì™€ ë™ì¼

4. ì„¸ì…˜ê³¼ ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€
   - session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);
   - ì„¸ì…˜ì„ ë³´ê´€í•˜ëŠ” ë°©ë²•ì€ request.setAttribute(..)ì™€ ë¹„ìŠ·
   - ğŸ’¡ í•˜ë‚˜ì˜ ì„¸ì…˜ì— ì—¬ëŸ¬ ê°’ ì €ì¥ ê°€ëŠ¥

5. LoginController - logoutV3()
```java
    @PostMapping("/logout")
    public String logoutV3(HttpServletRequest request) {
        HttpSession session = request.getSession(false);
        if(session != null) {
            session.invalidate();
        }

        return "redirect:/";
    }
```
  - session.invalidate() : ì„¸ì…˜ ì œê±°

6. HomeController - homeLoginV3()
```java
@GetMapping("/")
public String homeLoginV2(HttpServletRequest request, Model model) {
    HttpSession session = request.getSession(false);
    
    // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
    if(session == null) {
        return "home";
    }

    Member loginMember = (Member) session.getAttribute(SessionConst.LOGIN_MEMBER);

    // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
    if(loginMember == null) {
        return "home";
    }
     
    // ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™
    model.addAttribute("member", loginMember);
    return "loginHome";
}
```
  - request.getSession(false) : reqeust.getSession()ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ê°’ì´ create:trueì´ë¯€ë¡œ, ë¡œê·¸ì¸ í•˜ì§€ ì•Šì„ ì‚¬ìš©ìë„ ì˜ë¯¸ì—†ëŠ” ì„¸ì…˜ ìƒì„±
  - ë”°ë¼ì„œ, ì„¸ì…˜ì„ ì°¾ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ëŠ” create:false ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šì•„ì•¼ í•¨
  - session.getAttribute(SessionConst.LOGIN_MEMBER) : ë¡œê·¸ì¸ ì‹œì ì— ì„¸ì…˜ì„ ë³´ê´€í•  íšŒì› ê°ì²´ ì°¾ìŒ

-----
### @SessionAttribute
-----
1. ìŠ¤í”„ë§ì€ ì„¸ì…˜ì„ ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ @SessionAttribute ì§€ì›
2. ì´ë¯¸ ë¡œê·¸ì¸ ëœ ì‚¬ìš©ìë¥¼ ì°¾ì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš© (ì°¸ê³ ë¡œ, ì´ ê¸°ëŠ¥ì€ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠìŒ)
```java
@SessionAttribute(name = "loginMember", required = false) Member loginMember
```

3. HomeController - homeLogin3Spring()
```java
@GetMapping("/")
public String homeLoginV3Spring(@SessionAttribute(name = "loginMember", required = false) Member loginMember, Model model) {
   // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
    if(loginMember == null) {
        return "home";
    }

    // ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™
    model.addAttribute("member", loginMember);
    return "loginHome";
}
```
  - ì„¸ì…˜ì„ ì°¾ê³ , ì„¸ì…˜ì— ë“¤ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì°¾ëŠ” ë²ˆê±°ë¡œìš´ ê³¼ì •ì„ ìŠ¤í”„ë§ì´ í•˜ë²ˆì— ì²˜ë¦¬ í•´ì¤Œ

-----
### TrackindModes
-----
1. ë¡œê·¸ì¸ì„ ì²˜ìŒ ì‹œë„í•˜ë©´ URLì´ ë‹¤ìŒê³¼ ê°™ì´ jessionidë¥¼ í¬í•¨í•˜ê³  ìˆìŒ
```
http://localhost:8080/;jsessionid=F59911518B921DF62D09F0DF8F83F872
```

2. ì´ëŠ” ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ë•Œ, ì¿ í‚¤ ëŒ€ì‹  URLì„ í†µí•´ ì„¸ì…˜ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•
3. ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ URLì— ê³„ì† ì´ ê°’ì„ í¬í•¨í•´ì„œ ì „ë‹¬í•´ì•¼ í•¨
4. íƒ€ì„ë¦¬í”„ ê°™ì€ í…œí”Œë¦¿ì€ ì—”ì§„ì„ í†µí•´ ë§í¬ë¥¼ ê±¸ë©´ jsessionidë¥¼ URLì— ìë™ìœ¼ë¡œ í¬í•¨
5. ì„œë²„ ì…ì¥ì—ì„œ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ëŠ”ì§€, í•˜ì§€ ì•ŠëŠ”ì§€ ìµœì´ˆì—ëŠ” íŒë‹¨í•˜ì§€ ëª»í•˜ë¯€ë¡œ, ì¿ í‚¤ ê°’ë„ ì „ë‹¬í•˜ê³ , URLì— jessionidë„ í•¨ê»˜ ì „ë‹¬
6. URL ì „ë‹¬ ë°©ì‹ì„ ë„ê³  í•­ìƒ ì¿ í‚¤ë¥¼ í†µí•´ì„œë§Œ ì„¸ì…˜ì„ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒ ì˜µì…˜ ì¶”ê°€ (URLì— jessionidê°€ ë…¸ì¶œë˜ì§€ ì•ŠìŒ) (application.properties)
```properties
server.servlet.session.tracking-modes=cookie
```

7. jessionidê°€ URLì— ìˆì„ ë•Œ 404 ì˜¤ë¥˜ ë°œìƒ ì‹œ
   - ìŠ¤í”„ë§ì—ì„œ ìµœê·¼ URL ë§¤í•‘ ì „ëµì´ ë³€ê²½ë˜ì–´ì„œ, ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥ë˜ë¯€ë¡œ 404 ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥
```
http://localhost:8080/;jsessionid=F59911518B921DF62D09F0DF8F83F872
```
   - í•´ê²° ë°©ì•ˆ, ì¦‰ ê¶Œì¥ ë°©ì•ˆì€ session.tracking-modesë¥¼ ì‚¬ìš©
```properties
server.servlet.session.tracking-modes=cookie
```
   - ë§Œì•½ URLì— jessionidê°€ ê¼­ í•„ìš”í•˜ë‹¤ë©´, application.propertiesì— ë‹¤ìŒ ì˜µì…˜ ì¶”ê°€
```properties
spring.mvc.pathmatch.matching-strategy=ant_path_matcher
```
