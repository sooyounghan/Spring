-----
### Form ì „ì†¡ ê°ì²´ ë¶„ë¦¬ 
-----
1. ì‹¤ë¬´ì—ì„œëŠ” groupsë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë°, ë“±ë¡ì‹œ í¼ì—ì„œ ì „ë‹¬í•˜ëŠ” ë°ì´í„°ê°€ Item ë„ë©”ì¸ ê°ì²´ì™€ ë”± ë§ì§€ ì•Šê¸° ë•Œë¬¸ì„
2. íšŒì› ë“±ë¡ ì‹œ íšŒì›ê³¼ ê´€ë ¨ëœ ë°ì´í„°ë§Œ ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì•½ê´€ ì •ë³´ë„ ì¶”ê°€ë¡œ ë°›ëŠ” ë“± Itemê³¼ ê´€ê³„ ì—†ëŠ” ìˆ˜ ë§ì€ ë¶€ê°€ ë°ì´í„°ê°€ ë„˜ì–´ì˜´
3. ë”°ë¼ì„œ, Itemì„ ì „ë‹¬ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë³µì¡í•œ í¼ì˜ ë°ì´í„°ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ê¹Œì§€ ì „ë‹¬í•  ë³„ë„ì˜ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì „ë‹¬
4. ì˜ˆë¥¼ ë“¤ë©´, ItemSaveFormì´ë¼ëŠ” í¼ì„ ì „ë‹¬ë°›ëŠ” ì „ìš© ê°ì²´ë¥¼ ë§Œë“¤ì–´ @ModelAttributeë¡œ ì‚¬ìš©
5. ì´ë¥¼ í†µí•´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í¼ ë°ì´í„°ë¥¼ ì „ë‹¬ ë°›ê³ , ì´í›„ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ Item ìƒì„±

-----
### í¼ ë°ì´í„° ì „ë‹¬ì— Item ë„ë©”ì¸ ê°ì²´ ì‚¬ìš©
-----
1. Html Form â†’ Item â†’ Controller â†’ Item â†’ Repository
2. ì¥ì  : Item ë„ë©”ì¸ ê°ì²´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬, ë ˆí¬ì§€í† ë¦¬ê¹Œì§€ ì§ì ‘ ì „ë‹¬í•´ì„œ ì¤‘ê°„ì— Itemì„ ë§Œë“œëŠ” ê³¼ì •ì´ ì—†ì–´ì„œ ê°„ë‹¨
3. ë‹¨ì  : ê°„ë‹¨í•œ ê²½ìš°ì—ë§Œ ì ìš© ê°€ëŠ¥ / ìˆ˜ì • ì‹œ ê²€ì¦ì´ ì¤‘ë³µë  ìˆ˜ ìˆê³ , groups ì‚¬ìš©í•´ì•¼ í•¨

-----
### í¼ ë°ì´í„° ì „ë‹¬ì— ë³„ë„ì˜ ê°ì²´ ì‚¬ìš©
-----
1. Html Form â†’ ItemSaveForm â†’ Controller â†’ Item ìƒì„± â†’ Repository
2. ì¥ì 
   - ì „ì†¡í•˜ëŠ” í¼ ë°ì´í„°ê°€ ë³µì¡í•´ë„ ê±°ê¸°ì— ë§ì¶˜ ë³„ë„ì˜ í¼ ê°ì²´ë¥¼ ì‚¬ìš©í•´ ë°ì´í„° ì „ë‹¬ ë°›ì„ ìˆ˜ ìˆìŒ
   - ë˜í•œ, ë“±ë¡ê³¼, ìˆ˜ì •ìš©ìœ¼ë¡œ ë³„ë„ì˜ í¼ ê°ì²´ë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì— ê²€ì¦ì´ ì¤‘ë³µë˜ì§€ ì•ŠìŒ
3. ë‹¨ì  : í¼ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ Item ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë³€í™˜ ê³¼ì • ì¶”ê°€

-----
### ìˆ˜ì •ì˜ ê²½ìš°
------
1. ë“±ë¡ê³¼ ìˆ˜ì •ì€ ì™„ì „íˆ ë‹¤ë¥¸ ë°ì´í„°ê°€ ë„˜ì–´ì˜´
2. ì¦‰, íšŒì› ê°€ì…ì‹œ ë‹¤ë£¨ëŠ” ë°ì´í„°ì™€ ìˆ˜ì • ì‹œ ë‹¤ë£¨ëŠ” ë°ì´í„°ëŠ” ë²”ìœ„ì˜ ì°¨ì´ê°€ ìˆìŒ
3. ì˜ˆë¥¼ ë“¤ì–´, ë¡œê·¸ì¸ ID, ì£¼ë¯¼ë²ˆí˜¸ ë“± ë°›ì„ ìˆ˜ ìˆì§€ë§Œ, ìˆ˜ì • ì‹œì—ëŠ” ì´ëŸ° ë¶€ë¶„ì´ ë¹ ì§
4. ê·¸ë¦¬ê³  ê²€ì¦ ë¡œì§ë„ ë§ì´ ë‹¬ë¼ì§€ë¯€ë¡œ, ItemUpdateFormì´ë¼ëŠ” ë³„ë„ì˜ ê°ì²´ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ëŠ” ê²ƒì´ ì¢‹ìŒ
5. ë”°ë¼ì„œ, í¼ ë°ì´í„° ì „ë‹¬ì„ ìœ„í•œ ë³„ë„ì˜ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê³ , ë“±ë¡ / ìˆ˜ì •ìš© í¼ ê°ì²´ë¥¼ ë‚˜ëˆ„ë©´ ë“±ë¡, ìˆ˜ì •ì´ ì™„ì „íˆ ë¶„ë¦¬ë˜ë¯€ë¡œ groupsë¥¼ ì ìš©í•  ì¼ì€ ì ì–´ì§

-----
### ì°¸ê³ ì‚¬í•­
-----
1. ì´ë¦„ì€ ì˜ë¯¸ìˆê²Œ ì§€ìœ¼ë©´ ë¨ (ItemSave, ItemSaveForm, ItemSaveRequest, ItemSaveDto ë“± ì‚¬ìš© ê°€ëŠ¥). ì¦‰ ì¼ê´€ì„± ìˆê²Œ ì§€ìœ¼ë©´ ë¨
2. ë“±ë¡, ìˆ˜ì •ìš© ë·° í…œí”Œë¦¿ì˜ ê²½ìš° ê° ì¥ë‹¨ì ì€ ìˆì§€ë§Œ, ì–´ì„¤í”„ê²Œ í•©ì¹˜ë©´ ìˆ˜ë§ì€ ë¶„ê¸°ë¶„(ë“±ë¡ / ìˆ˜ì •ì¼ ë•Œ) ë•Œë¬¸ì— ë‚˜ì¤‘ì— ìœ ì§€ë³´ìˆ˜ì—ì„œ ë¬¸ì œ ë°œìƒ
   - ë”°ë¼ì„œ, ë¶„ê¸°ë¬¸ë“¤ì´ ë³´ì´ë©´ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

-----
### Form ì „ì†¡ ê°ì²´ ë¶„ë¦¬ - ê°œë°œ
-----
1. Item : ì´ì œ Itemì˜ ê²€ì¦ì€ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê²€ì¦ ì½”ë“œ ì œê±°
```java
package hello.itemservice.domain.item;

import lombok.Data;
@Data
public class Item {
    private Long id; // ìƒí’ˆ ID

    private String itemName; // ìƒí’ˆëª…

    private Integer price; // ìƒí’ˆ ê°€ê²©

    private Integer quantity; // ìƒí’ˆ ìˆ˜ëŸ‰


    public Item() {

    }

    public Item(String itemName, Integer price, Integer quantity) {
        this.itemName = itemName;
        this.price = price;
        this.quantity = quantity;
    }
}
```

2. ItemSaveForm - ITEM ì €ì¥ìš© í¼
```java
package hello.itemservice.web.validation.form;

import jakarta.validation.constraints.Max;
import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotNull;
import org.hibernate.validator.constraints.Range;

@Data
public class ItemSaveForm {
    @NotBlank
    private String itemName;
    
    @NotNull
    @Range(min = 1000, max = 1000000)
    private Integer price;
    
    @NotNull
    @Max(value = 9999)
    private Integer quantity;
}
```

3. ItemUpdateForm - ITEM ìˆ˜ì •ìš© í¼
```java
package hello.itemservice.web.validation.form;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotNull;
import org.hibernate.validator.constraints.Range;

@Data
public class ItemUpdateForm {
    @NotNull
    private Long id;

    @NotBlank
    private String itemName;

    @NotNull
    @Range(min = 1000, max = 1000000)
    private Integer price;

    // ìˆ˜ì • ì‹œì— ìˆ˜ëŸ‰ì€ ììœ ë¡­ê²Œ ë³€ê²½ ê°€ëŠ¥
    private Integer quantity;
}
```

4. ValidationItemControllerV4
```java
package hello.itemservice.web.validation;

import hello.itemservice.domain.item.Item;
import hello.itemservice.domain.item.ItemRepository;
import hello.itemservice.domain.item.SaveCheck;
import hello.itemservice.domain.item.UpdateCheck;
import hello.itemservice.web.validation.form.ItemSaveForm;
import hello.itemservice.web.validation.form.ItemUpdateForm;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import java.util.List;

@Slf4j
@Controller
@RequestMapping("/validation/v4/items")
@RequiredArgsConstructor
public class ValidationItemControllerV4 {

    private final ItemRepository itemRepository;

    @GetMapping
    public String items(Model model) {
        List<Item> items = itemRepository.findAll();
        model.addAttribute("items", items);
        return "validation/v4/items";
    }

    @GetMapping("/{itemId}")
    public String item(@PathVariable long itemId, Model model) {
        Item item = itemRepository.findById(itemId);
        model.addAttribute("item", item);
        return "validation/v4/item";
    }

    @GetMapping("/add")
    public String addForm(Model model) {
        model.addAttribute("item", new Item());
        return "validation/v4/addForm";
    }

    @PostMapping("/add")
    public String addItem(@Validated @ModelAttribute("item") ItemSaveForm form, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
        // íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ì „ì²´ ì˜ˆì™¸
        if(form.getPrice() != null && form.getQuantity() != null) {
            int resultPrice = form.getPrice() * form.getQuantity();
            if(resultPrice < 10000) {
                bindingResult.reject("totalPriceMin", new Object[]{10000, resultPrice}, null);
            }
        }

        // ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´, ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ ì´ë™
        if(bindingResult.hasErrors()) {
            log.info("errors={}", bindingResult);
            return "validation/v4/addForm";
        }

        // ê²€ì¦ ì„±ê³µ ë¡œì§
        Item item = new Item();
        item.setItemName(form.getItemName());
        item.setPrice(form.getPrice());
        item.setQuantity(form.getQuantity());

        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v4/items/{itemId}";
    }

    @GetMapping("/{itemId}/edit")
    public String editForm(@PathVariable Long itemId, Model model) {
        Item item = itemRepository.findById(itemId);
        model.addAttribute("item", item);
        return "validation/v4/editForm";
    }

    @PostMapping("/{itemId}/edit")
    public String edit(@PathVariable Long itemId, @Validated @ModelAttribute("item") ItemUpdateForm form, BindingResult bindingResult) {
        // íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ì „ì²´ ì˜ˆì™¸
        if(form.getPrice() != null && form.getQuantity() != null) {
            int resultPrice = form.getPrice() * form.getQuantity();
            if(resultPrice < 10000) {
                bindingResult.reject("totalPriceMin", new Object[]{10000, resultPrice}, null);
            }
        }

        // ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´, ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ ì´ë™
        if(bindingResult.hasErrors()) {
            log.info("errors={}", bindingResult);
            return "validation/v4/editForm";
        }

        Item itemParam = new Item();
        itemParam.setItemName(form.getItemName());
        itemParam.setPrice(form.getPrice());
        itemParam.setQuantity(form.getQuantity());

        itemRepository.update(itemId, itemParam);
        return "redirect:/validation/v4/items/{itemId}";
    }
}
```
  - ê¸°ì¡´ ì½”ë“œ ì œê±° : addItem(), addItem2()
  - ê¸°ì¡´ ì½”ë“œ ì œê±° : edit(), editV2()
  - ì¶”ê°€ : addItem(), edit()

5. í¼ ê°ì²´ ë°”ì¸ë”©
```java
@PostMapping("/add")
public String addItem(@Validated @ModelAttribute("item") ItemSaveForm form, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
  // ...
}
```
  - Item ëŒ€ì‹  ItemSaveFormì„ ì „ë‹¬ ë°›ìŒ
  - @Validatedë¡œ ê²€ì¦ë„ ìˆ˜í–‰í•˜ê³ , BindingResultë¡œ ê²€ì¦ ê²°ê³¼ë¥¼ ë°›ìŒ
  - ğŸ’¡ @ModelAttribute("item")ì— itemì´ë¦„ì„ ë„£ì–´ì¤€ ë¶€ë¶„ ì£¼ì˜
    + ì´ë¥¼ ë„£ì§€ ì•Šìœ¼ë©´, ItemSaveFormì˜ ê²½ìš° ê·œì¹™ì— ì˜í•´ itemSaveFormì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ MVC Modelì— ë‹´ê¹€
    + ì´ë ‡ê²Œ ë˜ë©´ ë·° í…œí”Œë¦¿ì—ì„œ ì ‘ê·¼í•˜ëŠ” th:object ì´ë¦„ë„ í•¨ê»˜ ë³€ê²½í•´ì¤˜ì•¼ í•¨

6. í¼ ê°ì²´ë¥¼ Itemìœ¼ë¡œ ë³€í™˜
```java
// ê²€ì¦ ì„±ê³µ ë¡œì§
Item item = new Item();
item.setItemName(form.getItemName());
item.setPrice(form.getPrice());
item.setQuantity(form.getQuantity());

Item savedItem = itemRepository.save(item);
````
  - í¼ ê°ì²´ì˜ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Item ê°ì²´ ìƒì„±
  - í¼ ê°ì²´ì²˜ëŸ¼ ì¤‘ê°„ì— ë‹¤ë¥¸ ê°ì²´ê°€ ì¶”ê°€ë˜ë©´, ë³€í™˜í•˜ëŠ” ê³¼ì • ì¶”ê°€

7. ìˆ˜ì •
```java
@PostMapping("/{itemId}/edit")
public String edit(@PathVariable Long itemId, @Validated @ModelAttribute("item") ItemUpdateForm form, BindingResult bindingResult) {
  // ...
}
```
  - ìˆ˜ì •ì˜ ê²½ìš°ë„ ë“±ë¡ê³¼ ë™ì¼
  - í¼ ê°ì²´ë¥¼ Itemìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì • ê±°ì¹¨
