-----
### View ë¶„ë¦¬ - v2
-----
1. ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ë¶€ë¶„ì—ëŠ” ì¤‘ë³µì´ ìˆê³ , ê¹”ë”í•˜ì§€ ì•ŠìŒ
```java
String viewPath = "/WEB-INF/views/new-form.jsp";
RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
requestDispatcher.forward(request, response);
```
```java
String viewPath = "/WEB-INF/views/save-result.jsp";
RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
requestDispatcher.forward(request, response);
```
```java
String viewPath = "/WEB-INF/views/members.jsp";
RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
requestDispatcher.forward(request, response);
```

2. ğŸ’¡ ì´ ë¶€ë¶„ì„ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ ë³„ë„ë¡œ ë·°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ ìƒì„±
<div align="center">
<img src="https://github.com/sooyounghan/Spring/assets/34672301/ce7dcdd7-f0f7-4591-88c5-6fde3144243c">
</div>

3. MyView
  - ë·° ê°ì²´ ìœ„ì¹˜ : frontcontrollerì— ìœ„ì¹˜
```java
package hello.servlet.web.frontcontroller;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

public class MyView {
    private String viewPath; // ë·° í˜ì´ì§€ ì´ë™ ê²½ë¡œ

    // ì»¨íŠ¸ë¡¤ëŸ¬ì— ì˜í•´ ë·° ê°ì²´ê°€ ìƒì„±ë  ë•Œ, ì´ë™í•  View ê²½ë¡œ ì´ˆê¸°í™”
    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    // ë·° í˜ì´ì§€ë¡œ Rendering ë©”ì„œë“œ
    public void render(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }
}
```

  - ğŸ’¡ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë·°ë¥¼ ë°˜í™˜í•˜ëŠ” íŠ¹ì§•ì´ ìˆìŒì„ ìƒê°

4. ControllerV2
```java
package hello.servlet.web.frontcontroller.v2;

import hello.servlet.web.frontcontroller.MyView;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

public interface ControllerV2 {
    // í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ ì¡°íšŒ í›„, í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ ì´ë™ í›„, ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” í•´ë‹¹ ë·°ë¡œ Forward ë˜ë¯€ë¡œ, ì´ ê³¼ì •ì„ ê³µí†µì ìœ¼ë¡œ ë‹´ê³ ìˆëŠ” í•´ë‹¹í•˜ëŠ” View ê°ì²´ ë°˜í™˜
    MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```

5. MemberFormControllerV2 - íšŒì› ë“±ë¡ í¼
```java
package hello.servlet.web.frontcontroller.v2.controller;

import hello.servlet.web.frontcontroller.MyView;
import hello.servlet.web.frontcontroller.v2.ControllerV2;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

public class MemberFormControllerV2 implements ControllerV2 {
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
       return new MyView("/WEB-INF/views/new-form.jsp");
    }
}
```
  - ê° ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë³µì¡í•œ dispatcher.forward()ë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë¨
  - ë‹¨ìˆœíˆ, MyView ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ë·° ì´ë¦„ë§Œ ë„£ê³  ë°˜í™˜í•˜ë©´ ë¨
  - ì¦‰, í•´ë‹¹ View ë¶€ë¶„ ì¤‘ë³µì´ í™•ì‹¤í•˜ê²Œ ì œê±°ëœ ê²ƒì„ í™•ì¸ ê°€ëŠ¥

6. MemberSaveControllerV2 - íšŒì› ê°€ì…
```java
package hello.servlet.web.frontcontroller.v2.controller;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import hello.servlet.web.frontcontroller.MyView;
import hello.servlet.web.frontcontroller.v2.ControllerV2;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

public class MemberSaveControllerV2 implements ControllerV2 {
    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        // Modelì— ë°ì´í„° ë³´ê´€
        request.setAttribute("member", member);

        return new MyView("/WEB-INF/views/save-result.jsp");
    }
}
```

7. MemberListControllerV2 - íšŒì› ë“±ë¡
```java
package hello.servlet.web.frontcontroller.v2.controller;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import hello.servlet.web.frontcontroller.MyView;
import hello.servlet.web.frontcontroller.v2.ControllerV2;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.util.List;

public class MemberListControllerV2 implements ControllerV2 {
    private MemberRepository memberRepository = MemberRepository.getInstance();
    
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Member> members = memberRepository.findAll();
        request.setAttribute("members", members);

        return new MyView("/WEB-INF/views/members.jsp");
    }
}
```

-----
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V2
-----
```java
package hello.servlet.web.frontcontroller.v2;

import hello.servlet.web.frontcontroller.MyView;
import hello.servlet.web.frontcontroller.v2.controller.MemberFormControllerV2;
import hello.servlet.web.frontcontroller.v2.controller.MemberListControllerV2;
import hello.servlet.web.frontcontroller.v2.controller.MemberSaveControllerV2;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

@WebServlet(name = "frontControllerV2", urlPatterns = "/front-controller/v2/*")
public class FrontControllerV2 extends HttpServlet {
    private Map<String, ControllerV2> controllerMap = new HashMap<>();

    public FrontControllerV2() {
        controllerMap.put("/front-controller/v2/members/new-form", new MemberFormControllerV2());
        controllerMap.put("/front-controller/v2/members/save", new MemberSaveControllerV2());
        controllerMap.put("/front-controller/v2/members", new MemberListControllerV2());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("FrontControllerV2.service");

        String requestURI = request.getRequestURI();

        ControllerV2 controller = controllerMap.get(requestURI);
        if(controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        // ControllerëŠ” MyView ê°ì²´ ë°˜í™˜
        MyView myView = controller.process(request, response);
        // í•´ë‹¹ ê°ì²´ì˜ render()ë¥¼ í†µí•´ forward
        myView.render(request, response);
    }
}
```

1. ControllerV2ì˜ ë°˜í™˜ê°’ : MyView
   - í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” í˜¸ì¶œ ê²°ê³¼ë¡œ MyViewë¥¼ ë°˜í™˜ ë°›ìŒ
   - MyView.render(0ë¥¼ í˜¸ì¶œí•˜ë©´, forward() ë¡œì§ì„ ìˆ˜í–‰í•´ JSP ìˆ˜í–‰

2. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë„ì…ìœ¼ë¡œ MyView ê°ì²´ì˜ render()ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ ëª¨ë‘ ì¼ê´€ë˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥
3. ê°ê°ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” MyView ê°ì²´ë¥¼ ìƒì„±ë§Œ í•´ì„œ ë°˜í™˜í•˜ë©´ ë¨
4. ì‹¤í–‰
   - ë“±ë¡ : http://localhost:9090/front-controller/v2/members/new-from
   - ëª©ë¡ : http://localhost:9090/front-controller/v2/members
