-----
### ì¸í„°ì…‰í„° ì¤‘ë³µ í˜¸ì¶œ ì œê±°
-----
1. LoginInterceptor - DispatcherType ë¡œê·¸ ì¶”ê°€
```java
package hello.exception.interceptor;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.method.HandlerMethod;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

import java.util.UUID;

@Slf4j
public class LogInterceptor implements HandlerInterceptor {
    public static final String LOG_ID = "logId";

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        String requestURI = request.getRequestURI();
        String uuid = UUID.randomUUID().toString();

        request.setAttribute(LOG_ID, uuid);

        // @RequestMapping : HandlerMethod
        // ì •ì  ë¦¬ì†ŒìŠ¤ : ResourceHttpRequestHandler
        if(handler instanceof HandlerMethod) {
            HandlerMethod handlerMethod = (HandlerMethod) handler; // í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì˜ ëª¨ë“  ì •ë³´ í¬í•¨
        }
        log.info("REQUEST = [{}][{}][{}][{}]", uuid, request.getDispatcherType(), requestURI, handler);
        return true;
    }

    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {
        log.info("postHandle = [{}]", modelAndView);
    }

    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {
        String requestURI = request.getRequestURI();
        String uuid = (String) request.getAttribute(LOG_ID); // preHandleì˜ logID ë°›ìŒ

        log.info("RESPONSE = [{}][{}][{}][{}]", uuid, request.getDispatcherType(), requestURI, handler);

        if(ex != null) {
            log.error("afterCompletion error = ", ex);
        }
    }
}
```
  - ì•ì„œ í•„í„°ì˜ ê²½ìš° í•„í„°ë¥¼ ë“±ë¡í•  ë•Œ ì–´ë–¤ DispatcherTypeì¸ ê²½ìš°ì— í•„í„°ë¥¼ ì ìš©í•  ì§€ ì„ íƒ ê°€ëŠ¥
  - ğŸ’¡ ê·¸ëŸ°ë°, ì¸í„°ì…‰í„°ëŠ” ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ ì•„ë‹Œ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ DispatcherTypeê³¼ ë¬´ê´€í•˜ê²Œ í•­ìƒ í˜¸ì¶œ

2. ì¸í„°ì…‰í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ ê²½ë¡œì— ë”°ë¼ ì¶”ê°€í•˜ê±°ë‚˜ ì œì™¸í•˜ê¸° ì‰½ê²Œ ë˜ì–´ìˆìœ¼ë¯€ë¡œ, ì´ ì„¤ì •ì„ í†µí•´ ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œë¥¼ excludePathPatternsë¥¼ ì‚¬ìš©í•´ì„œ ë¹¼ì£¼ë©´ ë¨
```java
package hello.exception;

import hello.exception.interceptor.LogInterceptor;
import hello.login.web.filter.LogFilter;
import jakarta.servlet.DispatcherType;
import jakarta.servlet.Filter;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new LogInterceptor())
                .order(1)
                .addPathPatterns("/**")
                .excludePathPatterns("/css/**", "*.ico", "/error", "/error-page/**"); // ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œ ì œê±°
    }

    // @Bean
    public FilterRegistrationBean<Filter> logFiler() {
        FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();
        filterRegistrationBean.setFilter(new LogFilter());
        filterRegistrationBean.setOrder(1);
        filterRegistrationBean.addUrlPatterns("/*");

        // DispatcherTypeì´ REQUEST, ERRORì¸ ê²½ìš° í•„í„° í˜¸ì¶œ
        filterRegistrationBean.setDispatcherTypes(DispatcherType.REQUEST, DispatcherType.ERROR);
        return filterRegistrationBean;
    }
}
```

  - /error-page/**ë¥¼ ì œê±°í•˜ë©´ error-page/500ê³¼ ê°™ì€ ë‚´ë¶€ í˜¸ì¶œ ê²½ìš°ì—ë„ ì¸í„°ì…‰í„° í˜¸ì¶œ (postHandleë„ ì •ìƒ í˜¸ì¶œì´ë¯€ë¡œ ì¶œë ¥)

3. ì „ì²´ íë¦„ ì •ë¦¬
   - /hello ì •ìƒ ìš”ì²­
     + WAS(/hello, dispatcherType=REQUEST) â†’ Filter â†’ Servlet â†’ Spring Interceptor â†’ Controller â†’ View
   - /error-ex ì˜¤ë¥˜ ìš”ì²­
     + í•„í„°ëŠ” DispatcherTypeìœ¼ë¡œ ì¤‘ë³µ í˜¸ì¶œ ì œê±° (dispatcherType=REUQEST)
     + ì¸í„°ì…‰í„°ëŠ” ê²½ë¡œ ì •ë³´ë¡œ ì¤‘ë³µ í˜¸ì¶œ ì œê±° (excludePathPatterns("/error-page/**"))
     + WAS(/error-ex, dispatcherType=REQUEST) â†’ Filter â†’ Servlet â†’ Spring Interceptor â†’ Controller
     + WAS (ì—¬ê¸°ê¹Œì§€ ì „íŒŒ) â† Filter â† Servlet â† Spring Interceptor â† Controller (Exception ë°œìƒ)
   - WAS ì˜¤ë¥˜ í˜ì´ì§€ í™•ì¸
     + WAS(/error-apge/500, dispatcherType=ERROR) â†’ Filter(X) â†’ Servlet â†’ Spring Interceptor(X) â†’ Controller(/error-page/500) â†’ View
