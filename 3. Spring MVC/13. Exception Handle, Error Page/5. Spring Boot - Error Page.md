-----
### ìŠ¤í”„ë§ ë¶€íŠ¸ - ì˜¤ë¥˜ í˜ì´ì§€
-----
1. ì˜ˆì™¸ ì²˜ë¦¬ í˜ì´ì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ê³¼ì •
   - WebServerCustomizer ìƒì„±
   - ì˜ˆì™¸ ì¢…ë¥˜ì— ë”°ë¼ ErrorPageë¥¼ ì¶”ê°€í•˜ê³ , ì˜ˆì™¸ ì²˜ë¦¬ìš© ì»¨íŠ¸ë¡¤ëŸ¬ ErrorPageContorller ìƒì„±
2. ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì´ëŸ° ê³¼ì •ì„ ëª¨ë‘ ê¸°ë³¸ìœ¼ë¡œ ì œê³µ
   - ErrorPageì„ ìë™ìœ¼ë¡œ ë“±ë¡ (ì´ ë•Œ, /errorë¼ëŠ” ê²½ë¡œë¡œ ê¸°ë³¸ ì˜¤ë¥˜ í˜ì´ì§€ ì„¤ì •)
     + new ErrorPage("/error") : ìƒíƒœì½”ë“œì™€ ì˜ˆì™¸ë¥¼ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ì˜¤ë¥˜ í˜ì´ì§€ë¡œ ì‚¬ìš©
     + ì„œë¸”ë¦¿ ë°–ìœ¼ë¡œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê±°ë‚˜ response.sendError(...)ê°€ í˜¸ì¶œë˜ë©´ ëª¨ë“  ì˜¤ë¥˜ëŠ” /errorë¥¼ í˜¸ì¶œí•˜ê²Œ ë¨
   - BasicErrorControllerë¼ëŠ” ìŠ¤í”„ë§ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ìë™ ë“±ë¡
     + ErrorPageì—ì„œ ë“±ë¡í•œ /errorë¥¼ ë§¤í•‘í•´ì„œ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬

3. ErrorMvcAutoConfigurationë¼ëŠ” í´ë˜ìŠ¤ê°€ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ì—­í• 
4. ê°œë°œìëŠ” ì˜¤ë¥˜ í˜ì´ì§€ë§Œ ë“±ë¡í•˜ë©´ ë¨
   - BasicErrorControllerëŠ” ê¸°ë³¸ì ì¸ ë¡œì§ì´ ëª¨ë‘ ê°œë°œë˜ì–´ ìˆìŒ
   - ì˜¤ë¥˜ í˜ì´ì§€ í™”ë©´ë§Œ BasicErrorControllerê°€ ì œê³µí•˜ëŠ” ë£°ê³¼ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ë“±ë¡í•˜ë©´ ë¨
   - ì •ì  HTMLì´ë©´ ì •ì  ë¦¬ì†ŒìŠ¤, ë·° í…œí”Œë¦¿ì„ ì‚¬ìš©í•´ì„œ ë™ì ìœ¼ë¡œ ì˜¤ë¥˜ í™”ë©´ì„ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ ë·° í…œí”Œë¦¿ ê²½ë¡œì— ì˜¤ë¥˜ í˜ì´ì§€ íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ë„£ì–´ë‘ê¸°ë§Œ í•˜ë©´ ë¨

5. ë·° ì„ íƒ ìš°ì„  ìˆœìœ„ (BasicErrorControllerì˜ ì²˜ë¦¬ ìˆœì„œ)
   - ë·° í…œí”Œë¦¿
     + resources/templates/error/500.html
     + resources/templates/error/5xx.html
   - ì •ì  ë¦¬ì†ŒìŠ¤(static, public)
     + resources/static/error/400.html
     + resources/static/error/404.html
     + resources/static/error/4xx.html
   - ì ìš© ëŒ€ìƒì´ ì—†ì„ ë•Œ ë·° ì´ë¦„ (error)
     + resources/templates/error.html

6. í•´ë‹¹ ê²½ë¡œ ìœ„ì¹˜ì— HTTP ìƒíƒœ ì½”ë“œ ì´ë¦„ì˜ ë·° íŒŒì¼ì„ ë„£ì–´ë‘ë©´ ë¨
7. ë·° í…œí”Œë¦¿ì´ ì •ì  ë¦¬ì†ŒìŠ¤ë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë†’ê³ , 404, 500ì²˜ëŸ¼ êµ¬ì²´ì ì¸ ê²ƒì´ 5xxì²˜ëŸ¼ ëœ êµ¬ì²´ì ì¸ ê²ƒë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŒ
8. ì˜¤ë¥˜ ë·° í…œí”Œë¦¿ ì¶”ê°€
  - resources/templates/error/4xx.html
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
</head>
<body>
<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>4xx ì˜¤ë¥˜ í™”ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ ì œê³µ</h2>
    </div>
    <div>
        <p>ì˜¤ë¥˜ í™”ë©´ ì…ë‹ˆë‹¤.</p>
    </div>
    <hr class="my-4">
</div> <!-- /container -->
</body>
</html>
```

  - resources/templates/error/404.html
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
</head>
<body>
<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>404 ì˜¤ë¥˜ í™”ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ ì œê³µ</h2>
    </div>
    <div>
        <p>ì˜¤ë¥˜ í™”ë©´ ì…ë‹ˆë‹¤.</p>
    </div>
    <hr class="my-4">
</div> <!-- /container -->
</body>
</html>
```

  - resources/templates/error/500.html
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
</head>
<body>
<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>500 ì˜¤ë¥˜ í™”ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ ì œê³µ</h2>
    </div>
    <div>
        <p>ì˜¤ë¥˜ í™”ë©´ ì…ë‹ˆë‹¤.</p>
    </div>
    <hr class="my-4">
</div> <!-- /container -->
</body>
</html>
```

```java
package hello.exception.servlet;

import jakarta.servlet.http.HttpServletResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

import java.io.IOException;

@Slf4j
@Controller
public class ServletExceptionController {

    @GetMapping("/error-ex")
    public void errorEx() {
        throw new RuntimeException("ì˜ˆì™¸ ë°œìƒ!");
    }

    @GetMapping("/error-404")
    public void error404(HttpServletResponse response) throws IOException {
        response.sendError(404, "404 ì˜¤ë¥˜!");
    }

    @GetMapping("/error-400")
    public void error400(HttpServletResponse response) throws IOException {
        response.sendError(400, "400 ì˜¤ë¥˜!");
    }

    @GetMapping("/error-500")
    public void error500(HttpServletResponse response) throws IOException {
        response.sendError(500, "500 ì˜¤ë¥˜!");
    }
}
```

9. í…ŒìŠ¤íŠ¸
  - http://localhost:8080/error-404 â†’ 404.html
  - http://localhost:8080/error-400 â†’ 4xx.html (400 ì˜¤ë¥˜ í˜ì´ì§€ê°€ ì—†ì§€ë§Œ 4xxê°€ ìˆìŒ) 
  - http://localhost:8080/error-500 â†’ 500.html
  - http://localhost:8080/error-ex  â†’ 500.html (ì˜ˆì™¸ëŠ” 500ìœ¼ë¡œ ì²˜ë¦¬)

-----
### BasicErrorControllerê°€ ì œê³µí•˜ëŠ” ê¸°ë³¸ ì •ë³´ë“¤
-----
1. BasicErrorController ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë‹¤ìŒ ì •ë³´ë¥¼ Modelì— ë‹´ì•„ ë·°ì— ì „ë‹¬
2. ë·° í…œí”Œë¦¿ì€ ì´ ê°’ì„ í™œìš©í•´ ì¶œë ¥ ê°€ëŠ¥
   - timestampe : Fri Feb 05 00:00:00 KST 2021
   - status : 400
   - error : Bad Request
   - exception : org.springframework.validation.BindException
   - trace : ì˜ˆì™¸ trace
   - message : Validation failed for objet='data'. Error count: 1
   - errors : Errors(BindingResult)
   - path : í´ë¼ì´ì–¸íŠ¸ ê²½ë¡œ ('/hello')

3. ì˜¤ë¥˜ ì •ë³´ ì¶”ê°€ (resources/templates/error/500.html)
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
</head>
<body>
<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>500 ì˜¤ë¥˜ í™”ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ ì œê³µ</h2>
    </div>
    <div>
        <p>ì˜¤ë¥˜ í™”ë©´ ì…ë‹ˆë‹¤.</p>
    </div>

    <ul>
        <li>ì˜¤ë¥˜ ì •ë³´</li>
        <ul>
            <li th:text="|timestamp: ${timestamp}|"></li>
            <li th:text="|path: ${path}|"></li>
            <li th:text="|status: ${status}|"></li>
            <li th:text="|message: ${message}|"></li>
            <li th:text="|error: ${error}|"></li>
            <li th:text="|exception: ${exception}|"></li>
            <li th:text="|errors: ${errors}|"></li>
            <li th:text="|trace: ${trace}|"></li>
        </ul>
        </li>
    </ul>
    
    <hr class="my-4">
</div> <!-- /container -->
</body>
</html>
```
  - ì˜¤ë¥˜ ê´€ë ¨ ë‚´ë¶€ ì •ë³´ë¥¼ ê³ ê°ì—ê²Œ ë…¸ì¶œí•˜ëŠ” ê²ƒì€ ì¢‹ì§€ ì•ŠìŒ
  - ê³ ê°ì´ í•´ë‹¹ ì •ë³´ë¥¼ ì½ì–´ë„ í˜¼ë€ë§Œ ë”í•´ì§€ê³ , ë³´ì•ˆìƒ ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŒ

 4. ë”°ë¼ì„œ, BasicErrorController ì˜¤ë¥˜ ì»¨íŠ¸ë¡¤ëŸ¬ì— ë‹¤ìŒ ì˜¤ë¥˜ ì •ë³´ë¥¼ modelì— í¬í•¨í•  ì§€ ì—¬ë¶€ ì„ íƒ ê°€ëŠ¥ (application.properties)
  - server.error.include-exception=false : exception í¬í•¨ ì—¬ë¶€ (true, false)
  - server.error.include-message=never : message í¬í•¨ ì—¬ë¶€
  - server.error.include-stacktrace=never : trace í¬í•¨ ì—¬ë¶€
  - server.error.include-binding-errors=never : errors í¬í•¨ ì—¬ë¶€
```properties
server.error.include-exception=true
server.error.include-message=on_param
server.error.include-stacktrace=on_param
server.error.include-binding-errors=on_param
```

  - ê¸°ë³¸ ê°’ì´ neverì¸ ê²½ìš°ëŠ” ë‹¤ìŒ 3ê°€ì§€ ì˜µì…˜ ì‚¬ìš© ê°€ëŠ¥ : never, always, on_param
    + never : ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
    + always : í•­ìƒ ì‚¬ìš©
    + on_param : íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ë•Œ ì‚¬ìš©
  - on_paramì€ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ì •ë³´ë¥¼ ë…¸ì¶œ (ë””ë²„ê·¸ ì‹œ ë¬¸ì œë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©)
  - í•˜ì§€ë§Œ, ì´ ë¶€ë¶„ë„ ê°œë°œ ì„œë²„ì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ìš´ì˜ ì„œë²„ì—ì„œëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŒ
  - on_paramìœ¼ë¡œ ì„¤ì •í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ HTTP ìš”ì²­ ì‹œ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬í•˜ë©´ í•´ë‹¹ ì •ë³´ë“¤ì´ modelì— ë‹´ê²¨ì„œ ë·° í…œí”Œë¦¿ì—ì„œ ì¶œë ¥
```
message=&errors=&trace=
```

5. í…ŒìŠ¤íŠ¸ : http://localhost:9090/error-ex?message=&errors=&trace=
6. ğŸ’¡ í•˜ì§€ë§Œ, ì‹¤ë¬´ì—ì„œ ì´ê²ƒë“¤ì„ ë…¸ì¶œí•˜ë©´ ì•ˆ ë¨ (ì‚¬ìš©ìì—ê²ŒëŠ” ì˜¤ë¥˜ í™”ë©´ê³¼ ê³ ê°ì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ì˜¤ë¥˜ ë©”ì„¸ì§€ë¥¼ ë³´ì—¬ì£¼ê³ , ì˜¤ë¥˜ëŠ” ì„œë²„ì— ë¡œê·¸ë¥¼ ë‚¨ê²¨ì„œ í™•ì¸í•´ì•¼ í•¨)
7. ìŠ¤í”„ë§ ë¶€íŠ¸ ì˜¤ë¥˜ ê´€ë ¨ ì˜µì…˜
   - server.error.whitelabel.enabled=true : ì˜¤ë¥˜ í™”ë©´ì„ ì°¾ì§€ ëª»í•˜ë©´, ìŠ¤í”„ë§ whitelabel ì˜¤ë¥˜ í˜ì´ì§€ ì ìš©
   - server.error.path=/error : ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œ, ìŠ¤í”„ë§ì´ ìë™ ë“±ë¡í•˜ëŠ” ì„œë¸”ë¦¿ ê¸€ë¡œë²Œ ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œì™€ BasicErrorController ì˜¤ë¥˜ ì»¨íŠ¸ë¡¤ëŸ¬ ê²½ë¡œì— í•¨ê»˜ ì‚¬ìš©

8. í™•ì¥ í¬ì¸íŠ¸
   - ì—ëŸ¬ ê³µí†µ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ê¸°ëŠ¥ì„ ë³€ê²½í•˜ê³  ì‹¶ìœ¼ë©´ ErrorController ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì„œ êµ¬í˜„
   - ë˜ëŠ”, BasicErrorControllerë¥¼ ìƒì†ë°›ì•„ì„œ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©´ ë¨
