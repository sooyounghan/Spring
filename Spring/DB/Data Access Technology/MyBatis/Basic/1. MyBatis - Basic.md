-----
### MyBatis - Basic
-----
1. XMLì— ì‘ì„±í•œë‹¤ëŠ” ì ì„ ì œì™¸í•˜ê³  JDBC ë°˜ë³µì„ ì¤„ì—¬ì¤€ë‹¤ëŠ” ì ì—ì„œ ê¸°ì¡´ JdbcTemplateê³¼ ê±°ì˜ ìœ ì‚¬
2. ItemMapper
```java
package hello.itemservice.repository.mybatis;

import hello.itemservice.domain.Item;
import hello.itemservice.repository.ItemSearchCond;
import hello.itemservice.repository.ItemUpdateDto;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

import java.util.List;
import java.util.Optional;

@Mapper
public interface ItemMapper {
    // íŒŒë¼ë¯¸í„° 1ê°œì¸ ê²½ìš° @Param ë¯¸ì ìš©
    void save(Item item);

    // íŒŒë¼ë¯¸í„° 2ê°œê°€ ë„˜ì–´ê°€ëŠ” ê²½ìš° @Param ì ìš©
    void update(@Param("id") Long id, @Param("updateParam")ItemUpdateDto updateParm);
    
    Optional<Item> findById(Long id);

    List<Item> findAll(ItemSearchCond itemSearch);
}
```
  - Mybatis Mapping XMLì„ í˜¸ì¶œí•´ì£¼ëŠ” Mapping Interface
  - ğŸ’¡ ì´ ì¸í„°í˜ì´ìŠ¤ëŠ” @Mapper ì• ë„ˆí…Œì´ì…˜ì„ ë¶™ì–´ì¤˜ì•¼ MyBatisì—ì„œ ì¸ì‹
  - ì´ ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ë‹¤ìŒì— ë³´ì´ëŠ” xmlì˜ í•´ë‹¹ SQLì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ëŒë ¤ì¤Œ
  - ê°™ì€ ìœ„ì¹˜ì— ì‹¤í–‰í•  SQLì´ ìˆëŠ” XML ë§¤í•‘ íŒŒì¼ì„ ë§Œë“¤ì–´ì¤˜ì•¼ í•¨ (ë‹¨, ìë°” ì½”ë“œê°€ ì•„ë‹ˆë¯€ë¡œ src/main/resources í•˜ìœ„ì— ë§Œë“¤ë˜, íŒ¨í‚¤ì§€ ìœ„ì¹˜ëŠ” ë§ì¶°ì•¼ í•¨)

3. IterMapper.xml (src/main/resources/hello/itemservice/repository/mybatis/ItemMapper.xml)
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hello.itemservice.repository.mybatis.ItemMapper">

    <insert id="save" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO item(item_name, price, quantity)
        VALUES(#{itemName}, #{price}, #{quantity})
    </insert>

    <update id="update">
        UPDATE item
        SET item_name=#{updateParam.itemName},
            price=#{updateParam.price},
            quantity=#{updateParam.quantity}
        WHERE id=#{id}
    </update>

    <select id="findById" resultType="Item">
        SELECT id, item_name, price, quantity
        FROM item
        WHERE id=#{id}
    </select>

    <select id="findAll" resultType="Item">
        SELECT id, item_name, price, quantity
        FROM item
        <where>
            <if test="itemName != null and itemName != ''">
                AND item_name LIKE CONCAT('%', #{itemName}, '%')
            </if>
            <if test="maxPrice != null">
                AND price &lt;= #{maxPrice}
            </if>
        </where>
    </select>

</mapper>
```

```xml
<mapper namespace="hello.itemservice.repository.mybatis.ItemMapper">

    ...

</mapper>
```
  - namespace : ì•ì„œ ë§Œë“  Mapper Interface ì§€ì •
  - ê²½ë¡œì™€ íŒŒì¼ ì´ë¦„ì— ì£¼ì˜
  - XML íŒŒì¼ ê²½ë¡œ ìˆ˜ì •
    + XML íŒŒì¼ì„ ì›í•˜ëŠ” ìœ„ì¹˜ì— ë‘ê³  ì‹¶ìœ¼ë©´ application.propertiesì— ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •
```properties
mybatis.mapper-locations=classpath:mapper/**/*.xml
```
  - ì´ë ‡ê²Œ í•˜ë©´, resources/mapperë¥¼ í¬í•¨í•œ ê·¸ í•˜ìœ„ í´ë”ì— ìˆëŠ” XMLì„ XML ë§¤í•‘ íŒŒì¼ë¡œ ì¸ì‹ (ì´ ê²½ìš°, íŒŒì¼ ì´ë¦„ì€ ììœ ë¡­ê²Œ ì„¤ì • ê°€ëŠ¥)
  - ì°¸ê³ ë¡œ, í…ŒìŠ¤íŠ¸ì˜ application.properties íŒŒì¼ë„ í•¨ê»˜ ìˆ˜ì •í•´ì•¼ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ ì¸ì‹

4. insert - save
```java
void save(Item item);
```
```xml
<insert id="save" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO item(item_name, price, quantity)
    VALUES(#{itemName}, #{price}, #{quantity})
</insert>
```

  - INSERT SQLì€ ```<insert>``` ì‚¬ìš©
  - idì—ëŠ” Mapper Interfaceì— ì„¤ì •í•œ ë©”ì„œë“œ ì´ë¦„ì„ ì§€ì • (ì—¬ê¸°ì—ì„œëŠ” ë©”ì„œë“œ ì´ë¦„ì´ save()ì´ë¯€ë¡œ saveë¡œ ì§€ì •)
  - íŒŒë¼ë¯¸í„°ëŠ” #{} ë¬¸ë²• ì‚¬ìš© (ê·¸ë¦¬ê³  Mapperì—ì„œ ë„˜ê¸´ ê°ì²´ì˜ í”„ë¡œí¼í‹° ì´ë¦„ì„ ì ì–´ì£¼ë©´ ë¨)
  - #{} ë¬¸ë²•ì„ ì‚¬ìš©í•˜ë©´ PreparedStatementë¥¼ ì‚¬ìš©
  - useGeneratedKeysëŠ” ë°ì´í„°ë² ì´ìŠ¤ê°€ í‚¤ë¥¼ ìƒì„±í•´ì£¼ëŠ” IDENTITY ì „ëµì¼ ë•Œ ì‚¬ìš©
  - keyPropertyëŠ” ìƒì„±ë˜ëŠ” í‚¤ì˜ ì†ì„± ì´ë¦„ì„ ì§€ì •
    + INSERTê°€ ëë‚˜ë©´ item ê°ì²´ì˜ id ì†ì„±ì— ìƒì„±ëœ ê°’ ì…ë ¥

5. update - update
```java
void update(@Param("id") Long id, @Param("updateParam")ItemUpdateDto updateParm);
```
```xml
<update id="update">
    UPDATE item
    SET item_name=#{updateParam.itemName},
        price=#{updateParam.price},
        quantity=#{updateParam.quantity}
    WHERE id=#{id}
</update>
```
  - UPDATE SQLì€ ```<update>``` ì‚¬ìš©
  - ì—¬ê¸°ì—ì„œëŠ” íŒŒë¼ë¯¸í„°ê°€ Long id, ItemUpdateDTO updateParmìœ¼ë¡œ 2ê°œ
  - íŒŒë¼ë¯¸í„°ê°€ 1ê°œ ìˆìœ¼ë©´ @Paramì„ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ë˜ì§€ë§Œ, íŒŒë¼ë¯¸í„°ê°€ 2ê°œ ì´ìƒì´ë©´ @Paramìœ¼ë¡œ ì´ë¦„ ì§€ì •í•´ íŒŒë¼ë¯¸í„° êµ¬ë¶„

6. select - findById
```java
Optional<Item> findById(Long id);
```

```xml
<select id="findById" resultType="Item">
    SELECT id, item_name, price, quantity
    FROM item
    WHERE id=#{id}
</select>
```
  - SELECT SQLì€ ```<select>``` ì‚¬ìš©
  - resultTypeì€ ë°˜í™˜ íƒ€ì…ì„ ëª…ì‹œ (ì—¬ê¸°ì„œëŠ” ê²°ê³¼ë¥¼ Item ê°ì²´ì— Mapping)
    + ì•ì„œ application.propertiesì—ì„œ mybatis.type-aliases-package=hello.itemservice.domain ì†ì„±ì„ ì§€ì •í•œ ë•ë¶„ì— ëª¨ë“  íŒ¨í‚¤ì§€ëª…ì„ ë‹¤ ì ì§€ ì•Šì•„ë„ ë¨ (ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ëª¨ë“  íŒ¨í‚¤ì§€ ëª…ì„ ë‹¤ ì ì–´ì•¼ í•¨)
    + JdbcTemplateì˜ BeanPropertyRowMapperì²˜ëŸ¼ SELECT SQLì˜ ê²°ê³¼ë¥¼ í¸ë¦¬í•˜ê²Œ ê°ì²´ë¡œ ë°”ë¡œ ë³€í™˜
    + mybatis.configuration.map-underscore-to-camel-case=true ì†ì„±ì„ ì§€ì •í•œ ë•ë¶„ì— ì–¸ë”ìŠ¤ì½”ì–´ë¥¼ ì¹´ë©œ í‘œê¸°ë²•ìœ¼ë¡œ ìë™ ì²˜ë¦¬ (item_name â†’ itemName)
  - ğŸ’¡ ìë°” ì½”ë“œì—ì„œ ë°˜í™˜ ê°ì²´ê°€ í•˜ë‚˜ì´ë©´, ```Item, Optional<Item>```ê³¼ ê°™ì´ ì‚¬ìš©
  - ğŸ’¡ ë°˜í™˜ ê°ì²´ê°€ í•˜ë‚˜ ì´ìƒì´ë©´ ì»¬ë ‰ì…˜ ì‚¬ìš©í•˜ë©´ ë¨ (ì£¼ë¡œ List ì‚¬ìš©)

7. select - findAll
```java
List<Item> findAll(ItemSearchCond itemSearch);
```
```xml
<select id="findAll" resultType="Item">
    SELECT id, item_name, price, quantity
    FROM item
    <where>
        <if test="itemName != null and itemName != ''">
            AND item_name LIKE CONCAT('%', #{itemName}, '%')
        </if>
        <if test="maxPrice != null">
            AND price &lt;= #{maxPrice}
        </if>
    </where>
</select>
```
  - MyBatisëŠ” ```<where>, <if>``` ê°™ì€ ë™ì  ì¿¼ë¦¬ ë¬¸ë²•ì„ í†µí•´ í¸ë¦¬í•œ ë™ì  ì¿¼ë¦¬ ì§€ì›
  - ```<if>```ëŠ” í•´ë‹¹ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ êµ¬ë¬¸ ì¶”ê°€
  - ```<where>```ëŠ” ì ì ˆí•˜ê²Œ WHERE ë¬¸ì¥ì„ ë§Œë“¤ì–´ ì¤Œ
    + ğŸ’¡ ì˜ˆì œì—ì„œ ```<if>```ê°€ ëª¨ë‘ ì‹¤íŒ¨í•˜ë©´ SQL WHEREì„ ë§Œë“¤ì§€ ì•ŠìŒ
    + ğŸ’¡ ì˜ˆì œì—ì„œ ```<if>```ê°€ í•˜ë‚˜ë¼ë„ ì„±ê³µí•˜ë©´ ì²˜ìŒ ë‚˜íƒ€ë‚˜ëŠ” ANDë¥¼ WHEREë¡œ ì¹˜í™˜

8. XML íŠ¹ìˆ˜ë¬¸ì
```xml
<if test="maxPrice != null">
    AND price &lt;= #{maxPrice}
</if>
```
  - ```<=```ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ```&lt;=```ë¥¼ ì‚¬ìš©
  - ì´ìœ ëŠ” XMLëŠ” ë°ì´í„° ì˜ì—­ì— ```<, >```ì™€ ê°™ì€ íŠ¹ìˆ˜ ë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ
  - ì´ëŠ”, XMLì—ì„œ TAGë¥¼ ì‹œì‘í•˜ê±°ë‚˜ ì¢…ë£Œí•  ë•Œ, ```<, >```ì™€ ê°™ì€ íŠ¹ìˆ˜ ë¬¸ìë¥¼ ì‚¬ìš©í•˜ê¸° ë–„ë¬¸ì„
```
< : &lt;
> : &gt;
& : &amp;
```
  - ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œëŠ” XMLì—ì„œ ì§€ì›í•˜ëŠ” CDATA êµ¬ë¬¸ ë¬¸ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ
  - ì´ êµ¬ë¬¸ ì•ˆì—ì„œëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì´ êµ¬ë¬¸ ì•ˆì—ì„œëŠ” XML TAGê°€ ë‹¨ìˆœ ë¬¸ìë¡œ ì·¨ê¸‰ë˜ë¯€ë¡œ ```<if>, <where>``` ë“± ì ìš©ë˜ì§€ ì•ŠìŒ
    
9. XML CDATA ì‚¬ìš©
```xml
<select id="findAll" resultType="Item">
    SELECT id, item_name, price, quantity
    FROM item
    <where>
        <if test="itemName != null and itemName != ''">
            AND item_name LIKE CONCAT('%', #{itemName}, '%')
        </if>
        <if test="maxPrice != null">
            <![CDATA[
            AND price <= #{maxPrice}
            ]]>
        </if>
    </where>
</select>
```
   - íŠ¹ìˆ˜ë¬¸ìì™€ CDATA ê° ìƒí™©ì— ë”°ë¥¸ ì¥ë‹¨ì ì´ ìˆìœ¼ë¯€ë¡œ ì›í•˜ëŠ” ë°©ë²•ì„ ì„ íƒ
