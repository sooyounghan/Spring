-----
### Spring Data JPA ì†Œê°œ
-----
1. https://spring.io/projects/spring-data-jpa
2. ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” JPAë¥¼ ì‚¬ìš©í•  ë•Œ, ì§€ë£¨í•˜ê²Œ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ìë™í™”
   - ì´ë¯¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í¬í•¨ë˜ì–´ìˆìŒ
   - ê¸°ì¡´ì˜ MemberRepositoryëŠ” ìŠ¤í”„ë§ ë°ì´í„° JPAë¡œ ë³€ê²½
3. MemberRepository
```java
package jpabook.jpashop.repository;

import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jpabook.jpashop.domain.Member;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
@RequiredArgsConstructor
public class MemberRepository {

    private final EntityManager em;

    public void save(Member member) {
        em.persist(member);
    }

    public Member findOne(Long id) {
        return em.find(Member.class, id);
    }

    public List<Member> findAll() {
        return em.createQuery("SELECT m FROM Member m", Member.class) // Entity ê°ì²´ ëŒ€ìƒìœ¼ë¡œ ì¡°íšŒ
                .getResultList();
    }

    public List<Member> findByName(String name) {
        return em.createQuery("SELECT m FROM Member m WHERE m.name = :name", Member.class)
                .setParameter("name", name)
                .getResultList();
    }
}
```

4. ìŠ¤í”„ë§ ë°ì´í„° JPA ì ìš©
```java
package jpabook.jpashop.repository;

import jpabook.jpashop.domain.Member;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.List;

public interface MemberRepository extends JpaRepository<Member, Long> {
    // SELECT m FROM Member m WHERE m.name = :name
    List<Member> findByName(String name);
}
```
    
5. MemberService
```java
package jpabook.jpashop.service;

import jpabook.jpashop.domain.Member;
import jpabook.jpashop.repository.MemberRepository;
import jpabook.jpashop.repository.MemberRepositoryOld;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@Transactional(readOnly = true)
@RequiredArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    /**
     * íšŒì› ê°€ì…
     */
    @Transactional // ë³€ê²½ ë©”ì„œë“œì´ë¯€ë¡œ, ê¸°ë³¸ì ìœ¼ë¡œ readOnly = true, ê°€ì…ë§Œ ì œì™¸
    public Long join(Member member) {
        validateDuplicateMember(member); // ì¤‘ë³µ íšŒì› ê²€ì¦
        memberRepository.save(member); // Spring Data JPA

        return member.getId();
    }

    private void validateDuplicateMember(Member member) {
        // ì¤‘ë³µ íšŒì›ì´ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ë°œìƒ
        List<Member> findMembers = memberRepository.findByName(member.getName()); // Spring Data JPA ì¶”ê°€

        if(!findMembers.isEmpty()) {
            throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        }
    }

    // íšŒì› ì „ì²´ ì¡°íšŒ
    public List<Member> findMembers() {
        return memberRepository.findAll(); // Spring Data JPA
    }

    // íšŒì› í•œ ëª… ì¡°íšŒ
    public Member findOne(Long id) {
        return memberRepository.findById(id).get(); // Spring Data JPA
    }

    // íšŒì› ì •ë³´ ìˆ˜ì •
    @Transactional
    public void update(Long id, String name) {
        Member member = memberRepository.findById(id).get(); // Spring Data JPA
        member.setName(name);
        // Dirty-Checking (ë³€ê²½ ê°ì§€)
    }
}
```

6. ì •ë¦¬
   - findOne() â†’ findById()ë¡œ ë³€ê²½
   - ğŸ’¡ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” JpaRepositoryë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ
     + ì—¬ê¸°ì— ê¸°ë³¸ì ì¸ CRUD ê¸°ëŠ¥ì´ ëª¨ë‘ ì œê³µ (ì¼ë°˜ì ìœ¼ë¡œ ìƒìƒí•  ìˆ˜ ìˆëŠ” ëª¨ë“  ê¸°ëŠ¥ ì œê³µ)
   - findByName ì²˜ëŸ¼ ì¼ë°˜í™”í•˜ê¸° ì–´ë ¤ìš´ ê¸°ëŠ¥ë„ ë©”ì„œë“œ ì´ë¦„ìœ¼ë¡œ ì •í™•í•œ JPQL ì¿¼ë¦¬ ì‹¤í–‰
     + SELECT m FROM Member m WHERE m.name = :name
   - ê°œë°œìëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œ ë§Œë“¤ë©´ ë¨. êµ¬í˜„ì²´ëŠ” ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ì£¼ì…

7. ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ìŠ¤í”„ë§ê³¼ JPAë¥¼ í™œìš©í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ë•Œ, ì •ë§ í¸ë¦¬í•œ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µ
8. ë‹¨ìˆœíˆ í¸ë¦¬í•¨ì„ ë„˜ì–´ì„œ ë†€ë¼ìš´ ê°œë°œ ìƒì‚°ì„± ì œê³µ
9. í•˜ì§€ë§Œ, ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” JPAë¥¼ ì˜ ì‚¬ìš©í•´ì„œ ì´ëŸ° ê¸°ëŠ¥ì„ ì œê³µ, ì¦‰ JPA ìì²´ë¥¼ ì˜ ì´í•´í•´ì•¼ í•¨
