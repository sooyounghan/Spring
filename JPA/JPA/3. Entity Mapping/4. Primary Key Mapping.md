-----
### ê¸°ë³¸ í‚¤ ë§¤í•‘ ì• ë„ˆí…Œì´ì…˜
-----
1. @Id
2. @GeneratedValue
```java
@Id @GeneratedValue(strategy = GenerationType.AUTO)
private Long id;
```

-----
### ê¸°ë³¸ í‚¤ ë§¤í•‘ ë°©ë²•
-----
1. ì§ì ‘ í• ë‹¹ : @Idë§Œ ì‚¬ìš©
2. ìë™ ìƒì„± (@GeneratedValue)
   - IDENTITY : ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„ (MySQL)
   - SEQUENCE : ë°ì´ë²„í…Œì´ìŠ¤ ì‹œí€€ìŠ¤ ì˜¤ë¸Œì íŠ¸ ì‚¬ìš© (Oracle)
     + @SequenceGenerator í•„ìš”
   - TABLE : í‚¤ ìƒì„±ìš© í…Œì´ë¸” ì‚¬ìš© (ëª¨ë“  DBì—ì„œ ì‚¬ìš©)
     + @TableGenerator í•„ìš”
   - AUTO : ë°©ì–¸ì— ë”°ë¼ ìë™ ì§€ì • (ê¸°ë³¸ê°’)

-----
### IDENTITY ì „ëµ 
-----
1. íŠ¹ì§• (ğŸ’¡ ìˆ«ìí˜•ì´ì–´ì•¼ í•¨)
  - ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„
  - ì£¼ë¡œ, MySQL, PostgreSQL, SQL Server, DB2ì—ì„œ ì‚¬ìš© (ì˜ˆ) MySQLì˜ AUTO_INCREMENT)
  - ğŸ’¡ JPAëŠ” ë³´í†µ íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì ì— INSERT SQL ì‹¤í–‰
  - ğŸ’¡ AUTO_INCREMENTëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— INSERT SQLì„ ì‹¤í–‰í•œ í›„ ID ê°’ì„ ì•Œ ìˆ˜ ìˆìŒ
  - ğŸ’¡ğŸ’¡ğŸ’¡ IDENTITY ì „ëµì€ em.persist() ì‹œì ì— ì¦‰ì‹œ INSERT SQL ì‹¤í–‰í•˜ê³ , DBì—ì„œ ì‹ë³„ì ì¡°íšŒ
```java
EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
EntityManager em = emf.createEntityManager();

EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜
tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘


// íšŒì› ë“±ë¡
try {
    Member member = new Member();
    member.setName("HelloJPA");
    System.out.println("=============");
    em.persist(member); // ë°ì´í„° ì €ì¥ë˜ë©°, IDENTITY ì „ëµ ì¼ ë•Œ, ì´ ì‹œì ì— INSERT SQL ì‹¤í–‰
    System.out.println("member.id = " + member.getId());
    System.out.println("=============");
    
    tx.commit(); // íŠ¸ëœì­ì…˜ ì»¤ë°‹
} catch (Exception e) {
    tx.rollback();
} finally {
    em.close();
}
```
```
=============
Hibernate: 
    /* insert for
        hellojpa.Member */insert 
    into
        Member (name, id) 
    values
        (?, default)
member.id = 1
=============
```

2. ë§¤í•‘
```java
@Entity
public class Member {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    ...
}
```
  - H2 Database
```
Hibernate: 
    create table Member (
        id bigint generated by default as identity,
        name varchar(255),
        primary key (id)
    )
```

  - MySQL
```
Hibernate: 
    create table Member (
        id bigint not null auto_increment,
        name varchar(255),
        primary key (id)
    ) engine=InnoDB
```
```
Hibernate: 
    /* insert for
        hellojpa.Member */
    insert into
        Member (name, id) 
    values
        (?, default)
```

-----
### SEQUENCE ì „ëµ
-----
1. íŠ¹ì§•
  - ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ëŠ” ìœ ì¼í•œ ê°’ì„ ìˆœì„œëŒ€ë¡œ ìƒì„±í•˜ëŠ” íŠ¹ë³„í•œ ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¸Œì íŠ¸ (ì˜ˆ) Oracle SEQUENCE)
  - Oracle, PostgreSQL, DB2, H2 ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©
  - ì˜ˆì‹œ
```java
@Entity
public class Member {

    @Id @GeneratedValue(strategy = GenerationType.SEQUENCE)
    private Long id;

    ...
}
```
```
Hibernate: 
    drop table if exists Member cascade 
Hibernate: 
    drop sequence if exists Member_SEQ
Hibernate: 
    create sequence Member_SEQ start with 1 increment by 50
```
```
Hibernate: 
    select
        next value for Member_SEQ
Hibernate: 
    /* insert for
        hellojpa.Member */insert 
    into
        Member (name, id) 
    values
        (?, ?)
```

2. ë§¤í•‘
```java
@Entity
@SequenceGenerator(
        name = "MEMBER_SEQ_GENERATOR",
        sequenceName = "MEMBER_SEQ", // ë§¤í•‘í•  ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ì´ë¦„
        initialValue = 1, allocationSize = 1
)
public class Member {

    @Id @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "MEMBER_SEQ_GENERATOR")
    private Long id;

    ...
}
```
```java
// íšŒì› ë“±ë¡
try {
    Member member = new Member();
    member.setName("HelloJPA");
    System.out.println("=============");
    em.persist(member); // ë°ì´í„° ì €ì¥ë˜ë©°, MEMBER_SEQì—ì„œ ì‹œí€€ìŠ¤ ê°’ì„ ë¶ˆëŸ¬ì™€ PK ê°’ ì €ì¥
    System.out.println("member.id = " + member.getId());
    System.out.println("=============");

    tx.commit(); // íŠ¸ëœì­ì…˜ ì»¤ë°‹í•˜ë©´ì„œ, INSERT SQL ì‹¤í–‰
} catch (Exception e) {
    tx.rollback();
} finally {
    em.close();
}
```

```
Hibernate: 
    create sequence MEMBER_SEQ start with 1 increment by 1
Hibernate: 
    create table Member (
        id bigint not null,
        name varchar(255),
        primary key (id)
    )

...

============= // em.persist(member) ì‹œì  (PK ê°’ ë°›ìŒ)
Hibernate: 
    select
        next value for MEMBER_SEQ
member.id = 1
============= // ì´í›„ COMMIT ì‹œì ì— INSERT SQL ì‹¤í–‰
Hibernate: 
    /* insert for
        hellojpa.Member */insert 
    into
        Member (name, id) 
    values
        (?, ?)
```
3. @SequenceGenerator
   - name : ì‹ë³„ì ìƒì„±ê¸° ì´ë¦„ (ê¸°ë³¸ê°’ : í•„ìˆ˜)
   - sequenceName : ë°ì´í„°ë² ì´ìŠ¤ì— ë“±ë¡ë˜ì–´ ìˆëŠ” ì‹œí€€ìŠ¤ ì´ë¦„ (ê¸°ë³¸ê°’ : hibernate_sequence)
   - initialValue : DDL ìƒì„± ì‹œì—ë§Œ ì‚¬ìš©ë˜ë©°, ì‹œí€€ìŠ¤ DDLì„ ìƒì„±í•  ë•Œ ì²˜ìŒ ì‹œì‘í•˜ëŠ” ìˆ˜ ì§€ì • (ê¸°ë³¸ê°’ : 1)
   - allocationSize : ì‹œí€€ìŠ¤ í•œ ë²ˆ í˜¸ì¶œì— ì¦ê°€í•˜ëŠ” ìˆ˜ (ì„±ëŠ¥ ìµœì í™”ì— ì‚¬ìš©ë¨)
     + ğŸ’¡ ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ê°’ì´ í•˜ë‚˜ì”© ì¦ê°€í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´, ì´ ê°’ì„ ë°˜ë“œì‹œ 1ë¡œ ì„¤ì •í•´ì•¼ í•¨
     + ğŸ’¡ ê¸°ë³¸ê°’ : 50 (50 ì„¤ì • ì´ìœ  : ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ë¯¸ë¦¬ 50ê°œë¥¼ ì„¤ì •í•´ ì„±ëŠ¥ì ì¸ ë©´ì—ì„œ ìµœì í™” ì‹¤í–‰)
     + ğŸ’¡ ì˜ˆì‹œ
```
                           allocationSzie          NEXT_VAL
(SEQ NEXT CALL 1) DB SEQ =       1          |        1
(SEQ NEXT CALL 2) DB SEQ =       51         |        2
(NO SEQ CALL)     DB SEQ =       51         |        3
[51ì´ ë˜ê¸° ì „ê¹Œì§€ ì‹œí€€ìŠ¤ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ, 51ì´ ë˜ëŠ” ìˆœê°„ ì‹œí€€ìŠ¤ í˜¸ì¶œí•´ NEXT CALL ë°œìƒ]
...
```   
   - catalog, schema : ë°ì´í„°ë² ì´ìŠ¤ catalog, schema ì´ë¦„

-----
### TABLE ì „ëµ
-----
1. í‚¤ ìƒì„± ì „ìš© í…Œì´ë¸”ì„ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ, ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ë¥¼ í‰ë‚´ë‚´ëŠ” ì „ëµ
2. ì¥ì  : ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì ìš© ê°€ëŠ¥
3. ë‹¨ì  : ì„±ëŠ¥
4. ë§¤í•‘
   - MY_SEQUENCES TABLE
```sql
CREATE TABLE MY_SEQUENCES (
    sequence_name VARCHAR(255) NOT NULL,
    next_val BIGINT,
    PRIMARY KEY (sequence_name)
)
```
```java
@Entity
@TableGenerator (
    name = "MEMBER_SEQ_GENERATOR"
    table = "MY_SEQUENCES"
    pkColumnValue = "MEMBER_SEQ", allocationSize = 1)
public class Member {
    @ID
    @GeneratedValue(strategy = GenerationType.TABLE,
                    generator = "MEMBER_SEQ_GENERATOR")
    private Long id;

    ...
}
```
```
Hibernate: 
    create table Member (
        id bigint not null,
        name varchar(255),
        primary key (id)
    )

Hibernate: 
    create table MY_SEQUENCES (
        next_val bigint,
        sequence_name varchar(255) not null,
        primary key (sequence_name)
    )
...

Hibernate: 
    insert into MY_SEQUENCES(sequence_name, next_val) values ('MEMBER_SEQ',0)

Hibernate: 
    select
        tbl.next_val 
    from
        MY_SEQUENCES tbl 
    where
        tbl.sequence_name=? for update

Hibernate: 
    update
        MY_SEQUENCES 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?

Hibernate: 
    /* insert for
        hellojpa.Member */insert 
    into
        Member (name, id) 
    values
        (?, ?)
```

```sql
SELECT *
FROM MY_SEQUENCE;
```
<div align="center">
<img src="https://github.com/user-attachments/assets/20bc877a-3174-4a04-91cd-ac98193ca916">
</div>

4. ì†ì„±
   - name : ì‹ë³„ì ìƒì„±ê¸° ì´ë¦„ (ê¸°ë³¸ê°’ : í•„ìˆ˜)
   - table : í‚¤ ìƒì„± í…Œì´ë¸” ëª… (ê¸°ë³¸ê°’ : hibername_sequences)
   - ğŸ’¡ pkColumnValue : ì‹œí€€ìŠ¤ ì»¬ëŸ¼ëª… (ê¸°ë³¸ê°’ : sequence_name)
   - ğŸ’¡ valueColumnNa : ì‹œí€€ìŠ¤ ê°’ ì»¬ëŸ¼ëª… (ê¸°ë³¸ê°’ : next_val)
   - ğŸ’¡ initialValue : ì´ˆê¸° ê°’, ğŸ’¡ ë§ˆì§€ë§‰ìœ¼ë¡œ ìƒì„±ëœ ê°’ì´ ê¸°ì¤€ (ê¸°ë³¸ê°’ : 0)
   - ğŸ’¡ allocationSize : ì‹œí€€ìŠ¤ í•œ ë²ˆ í˜¸ì¶œì— ì¦ê°€í•˜ëŠ” ìˆ˜ (ì„±ëŠ¥ ìµœì í™”ì— ì‚¬ìš©) (ğŸ’¡ ê¸°ë³¸ê°’ : 50 [ì‹œí€€ìŠ¤ ì „ëµê³¼ ë™ì¼í•œ ì›ë¦¬])
   - catalog, schema : ë°ì´í„°ë² ì´ìŠ¤ catalog, schema ì´ë¦„
   - uniqueConstraints (DDL) : ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ ì§€ì •

-----
### ê¶Œì¥í•˜ëŠ” ì‹ë³„ì ì „ëµ
-----
1. ğŸ’¡ ê¸°ë³¸í‚¤ ì œì•½ ì¡°ê±´ : NULLì´ ì•„ë‹ˆë©°, ìœ ì¼í•´ì•¼ í•˜ê³ , ë³€í•˜ë©´ ì•ˆ ë¨
2. ğŸ’¡ ë¯¸ë˜ê¹Œì§€ ì´ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ìì—°í‚¤ë¥¼ ì°¾ê¸°ëŠ” ì–´ë ¤ìš°ë¯€ë¡œ, ëŒ€ì²´í‚¤ (ëŒ€ë¦¬í‚¤)ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
   - ì˜ˆë¥¼ ë“¤ì–´, ì£¼ë¯¼ ë“±ë¡ ë²ˆí˜¸ë„ ê¸°ë³¸ í‚¤ë¡œ ì ì ˆí•˜ì§€ ì•ŠìŒ
3. ğŸ’¡ ê¶Œì¥ : 1. Longí˜• + 2. ëŒ€ì²´í‚¤ + 3. í‚¤ ìƒì„± ì „ëµ ì„¸ ê°€ì§€ ì‚¬ìš©

