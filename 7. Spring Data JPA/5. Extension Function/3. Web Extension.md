-----
### Web í™•ì¥ - ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°
-----
1. HTTP íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì—”í‹°í‹°ì˜ ì•„ì´ë””ë¡œ ì—”í‹°í‹° ê°ì²´ë¥¼ ì°¾ì•„ì„œ ë°”ì¸ë”©
2. ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„° ì‚¬ìš© ì „
```java
package study.data_jpa.controller;

import jakarta.annotation.PostConstruct;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import study.data_jpa.entity.Member;
import study.data_jpa.repository.MemberRepository;

@RestController
@RequiredArgsConstructor
public class MemberController {
    private final MemberRepository memberRepository;

    @GetMapping("/members/{id}")
    public String findMember(@PathVariable("id") Long id) {
        Member member = memberRepository.findById(id).get();

        return member.getUsername();
    }

    @PostConstruct
    public void init() {
        memberRepository.save(new Member("userA"));
    }
}
```

3. ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„° ì‚¬ìš© í›„
```java
package study.data_jpa.controller;

import jakarta.annotation.PostConstruct;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import study.data_jpa.entity.Member;
import study.data_jpa.repository.MemberRepository;

@RestController
@RequiredArgsConstructor
public class MemberController {
    private final MemberRepository memberRepository;

    ...

    @GetMapping("/members2/{id}")
    public String findMember2(@PathVariable("id") Member member) { // ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°
        return member.getUsername();
    }

    @PostConstruct
    public void init() {
        memberRepository.save(new Member("userA"));
    }
}
```
  - ğŸ’¡ HTTP ìš”ì²­ì€ íšŒì› idë„ ë°›ì§€ë§Œ, ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°ê°€ ì¤‘ê°„ì— ë™ì‘í•´ì„œ íšŒì› ì—”í‹°í‹° ê°ì²´ ë°˜í™˜
  - ğŸ’¡ ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°ë„ ë ˆíŒŒì§€í† ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹°ë¥¼ ì°¾ìŒ
  - ğŸ’¡ ì£¼ì˜ : ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°ë¡œ ì—”í‹°í‹°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ìœ¼ë©´, ì´ ì—”í‹°í‹°ëŠ” ë‹¨ìˆœ ì¡°íšŒìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•´ì•¼ í•¨
    + ğŸ’¡ íŠ¸ëœì­ì…˜ì´ ì—†ëŠ” ë²”ìœ„ì—ì„œ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí–ˆìœ¼ë¯€ë¡œ, ì—”í‹°í‹°ë¥¼ ë³€ê²½í•´ë„ DBì— ë¯¸ë°˜ì˜

-----
### Web í™•ì¥ - í˜ì´ì§•ê³¼ ì •ë ¬
-----
1. ìŠ¤í”„ë§ ë°ì´í„°ê°€ ì œê³µí•˜ëŠ” í˜ì´ì§•ê³¼ ì •ë ¬ ê¸°ëŠ¥ì„ ìŠ¤í”„ë§ MVCì—ì„œ í¸ë¦¬í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
2. í˜ì´ì§•ê³¼ ì •ë ¬ ì˜ˆì œ
```java
package study.data_jpa.controller;

import jakarta.annotation.PostConstruct;
import lombok.RequiredArgsConstructor;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import study.data_jpa.entity.Member;
import study.data_jpa.repository.MemberRepository;

@RestController
@RequiredArgsConstructor
public class MemberController {
    private final MemberRepository memberRepository;

    ...

    @GetMapping("/members")
    public Page<Member> list(Pageable pageable) {
        Page<Member> page = memberRepository.findAll(pageable);
        return page;
    }
    
    @PostConstruct
    public void init() {
        for(int i = 0; i < 100; i++) {
            memberRepository.save(new Member("user" + i, i));
        }
    }
}

```
  - íŒŒë¼ë¯¸í„°ë¡œ Pageableì„ ë°›ì„ ìˆ˜ ìˆìŒ
  - Pageableì€ ì¸í„°í˜ì´ìŠ¤, ì‹¤ì œëŠ” org.springframework.data.domain.PageRequest ê°ì²´ ìƒì„±

3. ìš”ì²­ íŒŒë¼ë¯¸í„°
   - ì˜ˆ) http://localhost:9090/members?page=0&size=3&sort=id,desc&sort=username,desc
   - page : í˜„ì¬ í˜ì´ì§€ (ğŸ’¡ 0ë¶€í„° ì‹œì‘)
   - size : í•œ í˜ì´ì§€ì— ë…¸ì¶œí•  ë°ì´í„° ê±´ìˆ˜
   - sort : ì •ë ¬ ì¡°ê±´ì„ ì •ì˜
     + ì˜ˆ) ì •ë ¬ ì†ì„± (ASC | DESC), ì •ë ¬ ë°©í–¥ì„ ë³€ê²½í•˜ê³  ì‹¶ìœ¼ë©´ sort íŒŒë¼ë¯¸í„° ì¶”ê°€ (ASC ìƒëµ ê°€ëŠ¥)

4. ê¸°ë³¸ê°’
   - ê¸€ë¡œë²Œ ì„¤ì • (ìŠ¤í”„ë§ ë¶€íŠ¸)
```properties
# ê¸°ë³¸ í˜ì´ì§€ ì‚¬ì´ì¦ˆ
spring.data.web.pageable.default-page-size=20
# ìµœëŒ€ í˜ì´ì§€ ì‚¬ì´ì¦ˆ
spring.data.web.pageable.max-page-size=2000
```

   - ê°œë³„ ì„¤ì •
```properties
@GetMapping("/members_page")
public String list(@PageableDefault(size = 12, sort = "username",
                   direction = Sort.Direction.DESC) Pageable pageable) {
    ...
}
```

5. ì ‘ë‘ì‚¬
   - í˜ì´ì§• ì •ë³´ê°€ ë‘˜ ì´ìƒì´ë©´ ì ‘ë‘ì‚¬ë¡œ êµ¬ë¶„
   - @Qualifierì— ì ‘ë‘ì‚¬ëª… ì¶”ê°€ : "{ì ‘ë‘ì‚¬ëª…}_xxx"
   - ì˜ˆì œ : /members?member_page=0&order_page=1
```java
public String list(
    @Qualifier("member") Pageable memberPageable,
    @Qualifier("order") Pageable orderPageable, ...
```

-----
### Page ë‚´ìš©ì„ DTOë¡œ ë³€í™˜
-----
1. ì—”í‹°í‹°ë¥¼ APIë¡œ ë…¸ì¶œí•˜ë©´ ë‹¤ì–‘í•œ ë¬¸ì œê°€ ë°œìƒí•˜ë¯€ë¡œ, ê¼­ ì—”í‹°í‹°ë¥¼ DTOë¡œ ë³€í™˜í•´ì„œ ë°˜í™˜í•´ì•¼ í•¨
2. PageëŠ” map()ì„ ì§€ì›í•´ì„œ ë‚´ë¶€ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥
3. MemberDto
```java
package study.data_jpa.dto;

import lombok.Data;
import study.data_jpa.entity.Member;

@Data
public class MemberDto {
    private Long id;
    private String username;
    private String teamName;

    ...
    
    public MemberDto(Member m) {
        this.id = m.getId();
        this.username = m.getUsername();
    }
}

```

4. Page.map() ì‚¬ìš©
```java
@GetMapping("/members")
public Page<MemberDto> list(Pageable pageable) {
    Page<Member> page = memberRepository.findAll(pageable);
    page.map(member -> new MemberDto(member.getId(), member.getUsername(), null));
    return page;
}
```

5. Page.map() ì½”ë“œ ìµœì í™”
```java
@GetMapping("/members")
public Page<MemberDto> list(Pageable pageable) {
    return memberRepository.findAll(pageable).map(MemberDto::new);
}
```

-----
### Pageë¥¼ 1ë¶€í„° ì‹œì‘í•˜ê¸°
-----
1. ğŸ’¡ ìŠ¤í”„ë§ ë°ì´í„°ëŠ” PageëŠ” 0ë¶€í„° ì‹œì‘
2. ë§Œì•½ 1ë¶€í„° ì‹œì‘í•œë‹¤ë©´?
   - ğŸ’¡ Pageable, Pageë¥¼ íŒŒë¼ë¯¸í„°ì™€ ì‘ë‹µ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ì§ì ‘ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬
     + ê·¸ë¦¬ê³  ì§ì ‘ PageRequest(Pageable êµ¬í˜„ì²´)ë¥¼ ìƒì„±í•´ì„œ ë ˆí¬ì§€í† ë¦¬ì— ë„˜ê¹€
     + ë¬¼ë¡ , ì‘ë‹µê°’ë„ Page ëŒ€ì‹  ì§ì ‘ ë§Œë“¤ì–´ì„œ ì œê³µ
   - ğŸ’¡ spring.data.web.pageable.one-indexed-paramtersë¥¼ trueë¡œ ì„¤ì •
     + ì´ ë°©ë²•ì€ webì—ì„œ page íŒŒë¼ë¯¸í„°ë¥¼ -1ë¡œ ì²˜ë¦¬í•  ë¿ì„
     + ğŸ’¡ ë”°ë¼ì„œ, ì‘ë‹µê°’ì¸ Pageì— ëª¨ë‘ 0 í˜ì´ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” í•œê³„ ì¡´ì¬

   - one-indexed-parameters Page 1 ìš”ì²­ (http://localhost:8080/members?page=1)
```json
{
    "content": [
        ...
        ],
        "pageable": {
              "offset": 0,
              "pageSize": 10,
              "pageNumber": 0 // 0 ì¸ë±ìŠ¤
        },
        "number": 0, // 0 ì¸ë±ìŠ¤
        "empty": false
}
```
