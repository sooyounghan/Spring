-----
### í…œí”Œë¦¿ ë©”ì„œë“œ
-----
1. ë¡œê·¸ ì¶”ì ê¸° ë„ì… ì „ - V0 ì½”ë“œ
  - OrderControllerV0
```java
@GetMapping("/v0/request")
public String request(String itemId) {
    orderService.orderItem(itemId);
    return "OK";
}
```

  - OrderServiceV0
```java
public void orderItem(String itemId) {
    orderRepository.save(itemId);
}
```

2. ë¡œê·¸ ì¶”ì ê¸° ë„ì… í›„ - V3 ì½”ë“œ
  - OrderControllerV3
```java
@GetMapping("/v3/request")
public String request(String itemId) {

    TraceStatus status = null;
    try {
        status = trace.begin("OrderController.request()");
        orderService.orderItem(itemId); // í•µì‹¬ ê¸°ëŠ¥
        trace.end(status);
        return "OK";
    } catch (Exception e) {
        trace.exception(status, e);
        throw e;
    }
}
```

  - OrderServiceV3
```java
public void orderItem(String itemId) {
    TraceStatus status = null;

    try {
        status = trace.begin("OrderService.orderItem()");
        orderRepository.save(itemId); // í•µì‹¬ ê¸°ëŠ¥
        trace.end(status);
    } catch (Exception e) {
        trace.exception(status, e);
        throw e;
    }
}
```

3. ë¹„êµ
  - V0ëŠ” í•´ë‹¹ ë©”ì„œë“œê°€ ì‹¤ì œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” í•µì‹¬ ê¸°ëŠ¥ë§Œ ê¹”ë”í•˜ê²Œ ì¡´ì¬
  - ë°˜ë©´ì—, V3ëŠ” í•µì‹¬ ê¸°ëŠ¥ë³´ë‹¤ ë¡œê·¸ë¥¼ ì¶œë ¥í•´ì•¼ í•˜ëŠ” ë¶€ê°€ ê¸°ëŠ¥ ì½”ë“œê°€ í›¨ì”¬ ë” ë§ê³  ë³µì¡

4. ğŸ’¡ í•µì‹¬ ê¸°ëŠ¥ê³¼ ë¶€ê°€ ê¸°ëŠ¥
   - í•µì‹¬ ê¸°ëŠ¥ : í•´ë‹¹ ê°ì²´ê°€ ì œê³µí•˜ëŠ” ê³ ìœ ì˜ ê¸°ëŠ¥
     + ì˜ˆë¥¼ ë“¤ì–´, OrderServiceì˜ í•µì‹¬ ê¸°ëŠ¥ì€ ì£¼ë¬¸ ë¡œì§
     + ë©”ì„œë“œ ë‹¨ìœ„ë¡œ ë³´ë©´, orderService.orderItem()ì˜ í•µì‹¬ ê¸°ëŠ¥ì€ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë ˆí¬ì§€í† ë¦¬ë¥¼ í˜¸ì¶œí•˜ëŠ” orderRepository.save(itemId) ì½”ë“œê°€ í•µì‹¬ ê¸°ëŠ¥

   - ë¶€ê°€ ê¸°ëŠ¥ : í•µì‹¬ ê¸°ëŠ¥ì„ ë³´ì¡°í•˜ê¸° ìœ„í•´ ì œê³µë˜ëŠ” ê¸°ëŠ¥
     + ì˜ˆë¥¼ ë“¤ì–´, ë¡œê·¸ ì¶”ì  ë¡œì§, íŠ¸ëœì­ì…˜ ê¸°ëŠ¥
     + ì´ëŸ¬í•œ ë¶€ê°€ ê¸°ëŠ¥ì€ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©ë˜ì§€ ì•Šê³ , í•µì‹¬ ê¸°ëŠ¥ê³¼ í•¨ê»˜ ì‚¬ìš©
     + ì˜ˆë¥¼ ë“¤ì–´, ë¡œê·¸ ì¶”ì  ê¸°ëŠ¥ì€ ì–´ë–¤ í•µì‹¬ ê¸°ëŠ¥ì´ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ ë¡œê·¸ë¥¼ ë‚¨ê¸°ê¸° ìœ„í•´ ì‚¬ìš©
     + ì¦‰, í•µì‹¬ ê¸°ëŠ¥ì„ ë³´ì¡°í•˜ê¸° ìœ„í•´ ì¡´ì¬

5. V0ì€ í•µì‹¬ ê¸°ëŠ¥ë§Œ ìˆì§€ë§Œ, ë¡œê·¸ ì¶”ì ê¸°ë¥¼ ì¶”ê°€í•œ V3 ì½”ë“œëŠ” í•µì‹¬ ê¸°ëŠ¥ê³¼ ë¶€ê°€ ê¸°ëŠ¥ì´ í•¨ê»˜ ì¡´ì¬
6. V3ë¥¼ ë³´ë©´, ë‹¤ìŒê³¼ ê°™ì´ ë™ì¼ íŒ¨í„´ ì¡´ì¬
```java
TraceStatus status = null;

try {
    status = trace.begin("message"); 

    // í•µì‹¬ ê¸°ëŠ¥ í˜¸ì¶œ

    trace.end(status);
} catch (Exception e) {
    trace.exception(status, e); 
    throw e;
}
```
  - Controller, Service, Repositoryì˜ ì½”ë“œë¥¼ ë¶„ì„í•˜ë©´, ë¡œê·¸ ì¶”ì ê¸°ë¥¼ ì‚¬ìš©í•˜ëŠ” êµ¬ì¡°ëŠ” ëª¨ë‘ ë™ì¼
  - ì¤‘ê°„ì— í•µì‹¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë§Œ ë‹¤ë¥¼ ë¿ì„
  - ë¶€ê°€ ê¸°ëŠ¥ê³¼ ê´€ë ¨ëœ ì½”ë“œê°€ ì¤‘ë³µì´ë‹ˆ ì¤‘ë³µì„ ë³„ë„ì˜ ë©”ì„œë“œë¡œ ë½‘ì•„ë‚´ë©´ ë  ê²ƒê°™ì§€ë§Œ, try-catchëŠ” ë¬¼ë¡ , í•µì‹¬ ê¸°ëŠ¥ ë¶€ë¶„ì´ ì¤‘ê°„ì— ìˆì–´ì„œ ë‹¨ìˆœí•˜ê²Œ ë©”ì„œë“œë¡œ ì¶”ì¶œí•˜ëŠ” ê²ƒì€ ì–´ë ¤ì›€

-----
### ğŸ’¡ ë³€í•˜ëŠ” ê²ƒê³¼ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ë¶„ë¦¬
-----
1. ì¢‹ì€ ì„¤ê³„ë€ ë³€í•˜ëŠ” ê²ƒê³¼ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒ
2. í•µì‹¬ ê¸°ëŠ¥ì€ ë³€í•˜ê³ , ë¡œê·¸ ì¶”ì ê¸°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ì€ ë³€í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„
3. ì´ ë‘˜ì„ ë¶„ë¦¬í•´ì„œ ëª¨ë“ˆí™” í•´ì•¼í•¨
4. í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ (Template Method Pattern)ì€ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë””ìì¸ íŒ¨í„´

-----
### ì˜ˆì œ
-----
1. TemplateMethodTest
```java
package hello.advanced.trace.template;

import lombok.extern.slf4j.Slf4j;
import org.junit.jupiter.api.Test;

@Slf4j
public class TemplateMethodTest {

    @Test
    void templateMethodV0() {
        logic1();
        logic2();
    }

    private void logic1() {
        long startTime = System.currentTimeMillis();

        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
        log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰");
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¢…ë£Œ

        long endTime = System.currentTimeMillis();
        long resultTime = endTime - startTime;

        log.info("resultTime = {}", resultTime);
    }

    private void logic2() {
        long startTime = System.currentTimeMillis();

        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
        log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§2 ì‹¤í–‰");
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¢…ë£Œ

        long endTime = System.currentTimeMillis();
        long resultTime = endTime - startTime;

        log.info("resultTime = {}", resultTime);
    }
}
```
  - logic1(), logic2()ë¥¼ í˜¸ì¶œí•˜ëŠ” ë‹¨ìˆœí•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ
  - logic1(), logic2()ëŠ” ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¶€ë¶„ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ë¶€ë¶„ì´ í•¨ê»˜ ì¡´ì¬
    + ë³€í•˜ëŠ” ë¶€ë¶„ : ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    + ë³€í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ : ì‹œê°„ ì¸¡ì •
  - ì‹¤í–‰ ê²°ê³¼
```
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰
resultTime = 14

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§2 ì‹¤í–‰
resultTime = 4
```

2. í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ êµ¬ì¡° ê·¸ë¦¼
<div align="center">
<img src="https://github.com/user-attachments/assets/a21f821a-c9a6-43d5-8ccb-bacdffac1591">
</div>

3. AbstractTemplate (í…ŒìŠ¤íŠ¸ ì½”ë“œ(src/test)ì— ìœ„ì¹˜)
```java
package hello.advanced.trace.template;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public abstract class AbstractTemplate {
    public void execute() {
        long startTime = System.currentTimeMillis();

        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
        call(); // ìƒì†
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¢…ë£Œ

        long endTime = System.currentTimeMillis();
        long resultTime = endTime - startTime;

        log.info("resultTime = {}", resultTime);
    }
    
    protected abstract void call();
}
```
  - í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ì€ ì´ë¦„ ê·¸ëŒ€ë¡œ í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
  - ğŸ’¡ í…œí”Œë¦¿ì€ ê¸°ì¤€ì´ ë˜ëŠ” ê±°ëŒ€í•œ í‹€ì´ë©°, í…œí”Œë¦¿ì´ë¼ëŠ” í‹€ì— ë³€í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ì„ ëª°ì•„ ë‘ë©°, ì¼ë¶€ ë³€í•˜ëŠ” ë¶€ë¶„ì„ ë³„ë„ë¡œ í˜¸ì¶œí•´ í•´ê²°
  - AbstractTemplateì˜ ê²½ìš°, ë³€í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ì¸ ì‹œê°„ ì¸¡ì • ë¡œì§ì„ ëª°ì•„ë‘” ê²ƒ í™•ì¸ ê°€ëŠ¥í•˜ë©°, ì´ê²ƒì´ í•˜ë‚˜ì˜ í…œí”Œë¦¿ì´ ë¨
  - ê·¸ë¦¬ê³  í…œí”Œë¦¿ ì•ˆì—ì„œ ë³€í•˜ëŠ” ë¶€ë¶„ì€ call() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì„œ ì²˜ë¦¬
  - ğŸ’¡ í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ì€ ë¶€ëª¨ í´ë˜ìŠ¤ì— ë³€í•˜ì§€ ì•ŠëŠ” í…œí”Œë¦¿ ì½”ë“œë¥¼ ë‘ë©°, ë³€í•˜ëŠ” ë¶€ë¶„ì€ ìì‹ í´ë˜ìŠ¤ì— ë‘ê³  ìƒì†ê³¼ ì˜¤ë²„ë¼ì´ë”©ì„ ì‚¬ìš©í•´ ì²˜ë¦¬

4. SubClassLogic1 (í…ŒìŠ¤íŠ¸ ì½”ë“œ(src/test)ì— ìœ„ì¹˜)
```java
package hello.advanced.trace.template;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class SubClassLogic1 extends AbstractTemplate {
    @Override
    protected void call() {
       log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰");
    }
}
```
  - ë³€í•˜ëŠ” ë¶€ë¶„ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1ì„ ì²˜ë¦¬í•˜ëŠ” ìì‹ í´ë˜ìŠ¤
  - í…œí”Œë¦¿ì´ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì¸ call() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©

5. SubClassLogic2 (í…ŒìŠ¤íŠ¸ ì½”ë“œ(src/test)ì— ìœ„ì¹˜)
```java
package hello.advanced.trace.template;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class SubClassLogic2 extends AbstractTemplate {
    @Override
    protected void call() {
       log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§2 ì‹¤í–‰");
    }
}
```
  - ë³€í•˜ëŠ” ë¶€ë¶„ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§2ë¥¼ ì²˜ë¦¬í•˜ëŠ” ìì‹ í´ë˜ìŠ¤
  - í…œí”Œë¦¿ì´ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì¸ call() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©

6. TemplateMethodTest - templateMethodV1() ì¶”ê°€
```java
/**
 * í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ ì ìš©
 */
@Test
void templateMethodV1() {
    AbstractTemplate template1 = new SubClassLogic1();
    template1.execute();
    AbstractTemplate template2 = new SubClassLogic2();
    template2.execute();
}
```
  - ì‹¤í–‰ ê²°ê³¼
```
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰
resultTime = 11

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§2 ì‹¤í–‰
resultTime = 3
```

  - í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ ì¸ìŠ¤í„´ìŠ¤ í˜¸ì¶œ ê·¸ë¦¼
<div align="center">
<img src="https://github.com/user-attachments/assets/40770677-3b8f-4f6d-9054-b3b52edceafb">
</div>

  - template1.execute()ë¥¼ í˜¸ì¶œí•˜ë©´, í…œí”Œë¦¿ ë¡œì§ì¸ AbstractTemplate.execute()ë¥¼ ì‹¤í–‰
  - ì—¬ê¸°ì„œ, ì¤‘ê°„ì— call() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ”ë°, ì´ ë¶€ë¶„ì´ ì˜¤ë²„ë¼ì´ë”© ë˜ì–´ìˆìœ¼ë¯€ë¡œ, í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì¸ SubClassLogic1 ì¸ìŠ¤í„´ìŠ¤ì˜ SubClassLogic1.call() ë©”ì„œë“œ í˜¸ì¶œ

7. ğŸ’¡ í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ì€ ë‹¤í˜•ì„±ì„ ì‚¬ìš©í•´ ë³€í•˜ëŠ” ë¶€ë¶„ê³¼ ë³€í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ì„ ë¶„ë¦¬í•˜ëŠ” ë°©ë²•

8. ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ ì‚¬ìš©
   - í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ì€ SubClassLogic1, SubClassLogic2ì²˜ëŸ¼ í´ë˜ìŠ¤ë¥¼ ê³„ì† ë§Œë“¤ì–´ì•¼ í•˜ëŠ” ë‹¨ì  ì¡´ì¬
   - ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¨ì  ë³´ì™„ ê°€ëŠ¥
   - ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ì„œ ë™ì‹œì— ìƒì„±í•  í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ ìì‹ í´ë˜ìŠ¤ë¡œ ì •ì˜í•  ìˆ˜ ìˆìŒ
   - ì´ í´ë˜ìŠ¤ëŠ” SubClassLogic1ì²˜ëŸ¼ ì§ì ‘ ì§€ì •í•˜ëŠ” ì´ë¦„ì´ ì—†ê³ , í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ì„ ì–¸ë˜ëŠ” í´ë˜ìŠ¤ì—¬ì„œ ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ì„

```java
/**
 * í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´, ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ ì‚¬ìš©
 */
@Test
void templateMethodV2() {
    AbstractTemplate template1 = new AbstractTemplate() {
        @Override
        protected void call() {
            log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰");
        }
    };
    log.info("í´ë˜ìŠ¤ ì´ë¦„ = {}", template1.getClass());
    template1.execute();

    AbstractTemplate template2 = new AbstractTemplate() {
        @Override
        protected void call() {
            log.info("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰");
        }
    };
    log.info("í´ë˜ìŠ¤ ì´ë¦„ = {}", template2.getClass());
    template2.execute();
}
```

  - ì‹¤í–‰ ê²°ê³¼
```
í´ë˜ìŠ¤ ì´ë¦„ = class hello.advanced.trace.template.TemplateMethodTest$1
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰
resultTime = 8

í´ë˜ìŠ¤ ì´ë¦„ = class hello.advanced.trace.template.TemplateMethodTest$2
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§1 ì‹¤í–‰
resultTime = 3
```

  - ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³´ë©´ ìë°”ê°€ ì„ì˜ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ ì´ë¦„ì€ TemplateMethodTest$1, TemplateMethodTest$2 í™•ì¸ ê°€ëŠ¥
<div align="center">
<img src="https://github.com/user-attachments/assets/c803c4a1-8e26-4307-8a5b-7a6b52b81477">
</div>
