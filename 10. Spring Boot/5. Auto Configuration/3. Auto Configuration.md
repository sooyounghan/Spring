-----
### ìë™ êµ¬ì„± í™•ì¸
-----
1. JdbcTemplate, DataSource, TransactionManagerê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì˜ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. DbConfigTest
```java
package hello.config;

import lombok.extern.slf4j.Slf4j;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.transaction.TransactionManager;

import javax.sql.DataSource;

@Slf4j
@SpringBootTest
public class DbConfigTest {
    @Autowired DataSource dataSource;
    @Autowired TransactionManager transactionManager;
    @Autowired JdbcTemplate jdbcTemplate;

    @Test
    void checkBean() {
        log.info("dataSource = {} ", dataSource);
        log.info("transactionManager = {}", transactionManager);
        log.info("jdbcTemplate = {}", jdbcTemplate);

        Assertions.assertThat(dataSource).isNotNull();
        Assertions.assertThat(transactionManager).isNotNull();
        Assertions.assertThat(jdbcTemplate).isNotNull();
    }
}
```
  - í•´ë‹¹ ë¹ˆë“¤ì„ DbConfig ì„¤ì •ì„ í†µí•´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡í–ˆìœ¼ë¯€ë¡œ nullì´ë©´ ì•ˆ ë¨
    + ì‚¬ì‹¤ @AutowiredëŠ” ì˜ì¡´ê´€ê³„ ì£¼ì…ì— ì‹¤íŒ¨í•˜ë©´, ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë„ë¡ ê¸°ë³¸ ì„¤ì •
  - í…ŒìŠ¤íŠ¸ëŠ” ì •ìƒì´ê³  ëª¨ë‘ ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ì •ìƒ ì²˜ë¦¬ëœ ê²ƒ í™•ì¸ ê°€ëŠ¥
  - ì¶œë ¥ ê²°ê³¼ë¥¼ ë³´ë©´ ë¹ˆì´ ì •ìƒ ë“±ë¡ëœ ê²ƒ í™•ì¸ ê°€ëŠ¥

3. ì¶œë ¥ ê²°ê³¼
```
[    Test worker] hello.config.DbConfig                    : dataSource ë¹ˆ ë“±ë¡
[    Test worker] hello.config.DbConfig                    : jdbcTemplate ë¹ˆ ë“±ë¡
[    Test worker] hello.config.DbConfig                    : transactionManager ë¹ˆ ë“±ë¡

...

[    Test worker] hello.config.DbConfigTest                : dataSource = HikariDataSource (null) 
[    Test worker] hello.config.DbConfigTest                : transactionManager = org.springframework.jdbc.support.JdbcTransactionManager@56c0a61e
[    Test worker] hello.config.DbConfigTest                : jdbcTemplate = org.springframework.jdbc.core.JdbcTemplate@421ead7e
```

4. ë¹ˆ ë“±ë¡ ì œê±°
   - JdbcTemplate, DataSource, TransactionManager ë¹ˆì€ ëª¨ë‘ DbConfigë¥¼ í†µí•´ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ ë“±ë¡
   - ì´ë²ˆì—ëŠ” DbConfigì—ì„œ í•´ë‹¹ ë¹ˆë“¤ì„ ë“±ë¡í•˜ì§€ ì•Šê³  ì œê±°
   - ì œê±°í•˜ëŠ” ë°©ë²•
     + @Configurationì„ ì£¼ì„ ì²˜ë¦¬ : ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ì„¤ì • íŒŒì¼ ìì²´ë¥¼ ìŠ¤í”„ë§ì´ ì½ì–´ë“¤ì´ì§€ ì•ŠìŒ(= ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì˜ ëŒ€ìƒì´ ì•„ë‹˜)
     + @Bean ì£¼ì„ ì²˜ë¦¬ : @Beanì´ ì—†ìœ¼ë©´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•ŠìŒ
   - ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ @Configuration ì£¼ì„ì²˜ë¦¬
```java
package hello.config;

import com.zaxxer.hikari.HikariDataSource;
import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.support.JdbcTransactionManager;
import org.springframework.transaction.TransactionManager;

import javax.sql.DataSource;

@Slf4j
// @Configuration
public class DbConfig {
    @Bean
    public DataSource dataSource() {
        log.info("dataSource ë¹ˆ ë“±ë¡");

        HikariDataSource dataSource = new HikariDataSource();
        dataSource.setDriverClassName("org.h2.Driver");
        dataSource.setJdbcUrl("jdbc:h2:mem:test");
        dataSource.setUsername("sa");
        dataSource.setPassword("");

        return dataSource;
    }

    @Bean
    public TransactionManager transactionManager() {
        log.info("transactionManager ë¹ˆ ë“±ë¡");

        return new JdbcTransactionManager(dataSource());
    }

    @Bean
    public JdbcTemplate jdbcTemplate() {
        log.info("jdbcTemplate ë¹ˆ ë“±ë¡");

        return new JdbcTemplate(dataSource());
    }
}
```
  - ì¶œë ¥ ê²°ê³¼ (DbConfigTest.checkBean() í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
```
[    Test worker] hello.config.DbConfigTest                : dataSource = HikariDataSource (null) 
[    Test worker] hello.config.DbConfigTest                : transactionManager = org.springframework.jdbc.support.JdbcTransactionManager@56c0a61e
[    Test worker] hello.config.DbConfigTest                : jdbcTemplate = org.springframework.jdbc.core.JdbcTemplate@421ead7e
```
  - ì‹¤í–‰í•œ ê²°ê³¼ë¥¼ ë³´ë©´ ê¸°ì¡´ì— ë¹ˆ ë“±ë¡ ë¡œê·¸ê°€ ì—†ìŒ
```
[    Test worker] hello.config.DbConfig                    : dataSource ë¹ˆ ë“±ë¡
[    Test worker] hello.config.DbConfig                    : jdbcTemplate ë¹ˆ ë“±ë¡
[    Test worker] hello.config.DbConfig                    : transactionManager ë¹ˆ ë“±ë¡
```
  - ë“±ë¡í•œ JdbcTemplate, DataSource, TransactionManagerê°€ ë¶„ëª…íˆ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì§€ ì•ŠìŒ
  - ê·¸ëŸ°ë°, í…ŒìŠ¤íŠ¸ëŠ” ì •ìƒ í†µê³¼í•˜ì˜€ê³ , ì‹¬ì§€ì–´ ì¶œë ¥ ê²°ê³¼ì— JdbcTemplate, DataSource, TransactionManager ë¹ˆë“¤ì´ ì¡´ì¬í•¨
  - ì´ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ëª¨ë‘ ìë™ìœ¼ë¡œ ë“±ë¡í•´ì¤€ ê²ƒ

-----
### ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ìë™ êµ¬ì„±
-----
1. ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ìë™ êµ¬ì„±(Auto Configuration)ì´ë¼ëŠ” ê¸°ëŠ¥ ì œê³µ
2. ì¼ë°˜ì ìœ¼ë¡œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ìˆ˜ ë§ì€ ë¹ˆë“¤ì„ ìë™ ë“±ë¡í•´ì£¼ëŠ” ê¸°ëŠ¥
   - ì¦‰, ìœ„ ì˜ˆì œì—ì„œëŠ” JdbcTemplate, DataSource, TransactionManager ëª¨ë‘ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ êµ¬ì„±ì„ í•´ì„œ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡
3. ì´ëŸ¬í•œ ìë™ êµ¬ì„± ë•ë¶„ì— ë°˜ë³µì ì´ê³  ë³µì¡í•œ ë¹ˆ ë“±ë¡ê³¼ ì„¤ì •ì„ ìµœì†Œí™”í•˜ê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹ ë¥´ê²Œ ì‹œì‘ ê°€ëŠ¥
4. ìë™ êµ¬ì„± ì˜ˆì œ
   - springb-boot-autoconfigureë¼ëŠ” í”„ë¡œì íŠ¸ ì•ˆì— ìˆ˜ë§ì€ ìë™ êµ¬ì„± ì œê³µ
   - JdbcTemplateì„ ì„¤ì •í•˜ê³  ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì£¼ëŠ” ìë™ êµ¬ì„± í™•ì¸
   - JdbcTemplateAutoConfiguration
```java
package org.springframework.boot.autoconfigure.jdbc;

import javax.sql.DataSource;
import org.springframework.boot.autoconfigure.AutoConfiguration;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnSingleCandidate;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.boot.sql.init.dependency.DatabaseInitializationDependencyConfigurer;
import org.springframework.context.annotation.Import;
import org.springframework.jdbc.core.JdbcTemplate;

@AutoConfiguration(
    after = {DataSourceAutoConfiguration.class}
)
@ConditionalOnClass({DataSource.class, JdbcTemplate.class})
@ConditionalOnSingleCandidate(DataSource.class)
@EnableConfigurationProperties({JdbcProperties.class})
@Import({DatabaseInitializationDependencyConfigurer.class, JdbcTemplateConfiguration.class, NamedParameterJdbcTemplateConfiguration.class})
public class JdbcTemplateAutoConfiguration {
    public JdbcTemplateAutoConfiguration() {
    }
}
```
  - @AutoConfiguration : ìë™ êµ¬ì„± ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” ì´ ì• ë„ˆí…Œì´ì…˜ì„ ë“±ë¡
    + ìë™ êµ¬ì„±ë„ ë‚´ë¶€ì— @Configurationì´ ìˆì–´ì„œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ìë°” ì„¤ì • íŒŒì¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
    + after = DataSoruceAutoConfiguration.class
      * ìë™ êµ¬ì„±ì´ ì‹¤í–‰ë˜ëŠ” ìˆœì„œ ì§€ì • ê°€ëŠ¥
      * JdbcTemplateì€ DataSourceê°€ í•„ìš”í•˜ë¯€ë¡œ DataSourceë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•´ì£¼ëŠ” DataSourceAutoConfiguration ë‹¤ìŒì— ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •

  - @ConditionalOnClass({ DataSource.class, JdbcTemplate.class })
    + IFë¬¸ê³¼ ìœ ì‚¬í•œ ê¸°ëŠ¥ ì œê³µ
    + ì´ëŸ° í´ë˜ìŠ¤ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ì„¤ì •ì´ ë™ì‘
    + ë§Œì•½, ì—†ìœ¼ë©´ ì—¬ê¸° ìˆëŠ” ì„¤ì •ì€ ë¬´íš¨í™”ë˜ê³ , ë¹ˆë„ ë“±ë¡ë˜ì§€ ì•ŠìŒ
    + @ConditionalXxx ì‹œë¦¬ì¦ˆ : ìë™ êµ¬ì„±ì˜ í•µì‹¬
    + JdbcTemplateAutoConfigurationì€ DataSoruce, JdbcTemplate ë¼ëŠ” í´ë˜ìŠ¤ê°€ ìˆì–´ì•¼ ë™ì‘ ê°€ëŠ¥

  - @Import : ìŠ¤í”„ë§ì—ì„œ ìë°” ì„¤ì •ì„ ì¶”ê°€í•  ë•Œ ì‚¬ìš©

5. @Import ëŒ€ìƒì´ ë˜ëŠ” JdbcTemplateConfiguration ì¶”ê°€ í™•ì¸
```java
package org.springframework.boot.autoconfigure.jdbc;

import javax.sql.DataSource;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.jdbc.core.JdbcOperations;
import org.springframework.jdbc.core.JdbcTemplate;

@Configuration(
    proxyBeanMethods = false
)
@ConditionalOnMissingBean({JdbcOperations.class})
class JdbcTemplateConfiguration {
    JdbcTemplateConfiguration() {
    }

    @Bean
    @Primary
    JdbcTemplate jdbcTemplate(DataSource dataSource, JdbcProperties properties) {
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        JdbcProperties.Template template = properties.getTemplate();
        jdbcTemplate.setFetchSize(template.getFetchSize());
        jdbcTemplate.setMaxRows(template.getMaxRows());
        if (template.getQueryTimeout() != null) {
            jdbcTemplate.setQueryTimeout((int)template.getQueryTimeout().getSeconds());
        }

        return jdbcTemplate;
    }
}
```
  - @Configuration : ìë°” ì„¤ì • íŒŒì¼ë¡œ ì‚¬ìš©
  - ğŸ’¡ @ConditionalOnMissingBean({JdbcOperations.class})
    + JdbcOperations ë¹ˆì´ ì—†ì„ ë•Œ ë™ì‘
    + JdbcTemplateì˜ ë¶€ëª¨ ì¸í„°í˜ì´ìŠ¤ : JdbcOperations
    + ğŸ’¡ ì¦‰, ì‰½ê²Œ ì´ì•¼ê¸°í•´ì„œ JdbcTemplateì´ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°ë§Œ ë™ì‘ (ì¦‰, JdbcTemplateì´ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´ ë¯¸ë™ì‘)
    + ë§Œì•½, ì´ëŸ° ê¸°ëŠ¥ì´ ì—†ìœ¼ë©´ ë‚´ê°€ ë“±ë¡í•œ JdbcTemplateê³¼ ìë™ êµ¬ì„±ì´ ë“±ë¡í•˜ëŠ” JdbcTemplateì´ ì¤‘ë³µ ë“±ë¡ë˜ëŠ” ë¬¸ì œ ë°œìƒ
    + ë³´í†µ, ì§ì ‘ ë¹ˆì„ ë“±ë¡í•˜ë©´ ë“±ë¡í•œ ë¹ˆì„ ì‚¬ìš©í•˜ê³ , ìë™ êµ¬ì„±ì€ ë™ì‘í•˜ì§€ ì•ŠìŒ
  - JdbcTemplateì´ ëª‡ ê°€ì§€ ì„¤ì •ì„ ê±°ì³ì„œ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥

6. ìë™ ë“±ë¡ ì„¤ì •
   - ë‹¤ìŒê³¼ ê°™ì€ ìë™ êµ¬ì„± ê¸°ëŠ¥ë“¤ì´ ë‹¤ìŒ ë¹ˆë“¤ì„ ë“±ë¡í•´ì¤Œ
     + JdbcTemplateAutoConfiguration : JdbcTemplate
     + DataSourceAutoConfiguration : DataSource
     + DataSourceTransactionManagerAutoConfiguration : TransactionManager

   - ë”°ë¼ì„œ, ì§ì ‘ ë¹ˆì„ ë“±ë¡í•˜ì§€ ì•Šì•„ë„ JdbcTemplate, DataSoruce, TransactionManagerê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ëœ ê²ƒ
   - ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì œê³µí•˜ëŠ” ìë™ êµ¬ì„± (Auto-Configuration) : https://docs.spring.io/spring-boot/docs/current/reference/html/auto-configuration-classes.html
   - ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ìˆ˜ ë§ì€ ìë™ êµ¬ì„±ì„ ì œê³µí•˜ê³  spring-boot-autoconfigureì— ìë™ êµ¬ì„±ì„ ëª¨ì•„ë‘ 
   - ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ spring-boot-autoconfig ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©

-----
### Auto Configuration - ìë™ ì„¤ì • ? ìë™ êµ¬ì„± ?
-----
1. Auto Configurationì˜ ë²ˆì—­
   - ìë™ ì„¤ì •
   - ìë™ êµ¬ì„±
  
2. ìë™ ì„¤ì •
   - Configuration : ì»´í“¨í„° ìš©ì–´ë¡œì„œ 'í™˜ê²½ì„¤ì •, ì„¤ì •'ì´ë¼ëŠ” ëœ»ìœ¼ë¡œ ìì£¼ ì‚¬ìš©
   - ì¦‰, í¬ê²Œ ë³´ë©´ ë¹ˆë“¤ì„ ìë™ ë“±ë¡í•´ì„œ ìŠ¤í”„ë§ì´ ë™ì‘í•˜ëŠ” í™˜ê²½ì„ ìë™ìœ¼ë¡œ ì„¤ì •í•´ì£¼ëŠ” ìš©ì–´ë„ ë§ìŒ

3. ìë™ êµ¬ì„±
   - Configuration : êµ¬ì„±, ë°°ì¹˜ë¼ëŠ” ëœ»
   - ì˜ˆ) ì»´í“¨í„°ë¼ê³  í•˜ë©´, CPU / ë©”ëª¨ë¦¬ ë“±ì„ ë°°ì¹˜í•´ì•¼ ì»´í“¨í„°ê°€ ë™ì‘
     + ì´ë ‡ê²Œ ë°°ì¹˜í•˜ëŠ” ê²ƒì„ êµ¬ì„±
   - ìŠ¤í”„ë§ë„ ìŠ¤í”„ë§ ì‹¤í–‰ì— í•„ìš”í•œ ë¹ˆë“¤ì„ ì ì ˆí•˜ê²Œ ë°°ì¹˜í•´ì•¼ í•¨
   - ìë™ êµ¬ì„±ì€ í•„ìš”í•œ ë¹ˆë“¤ì„ ìë™ìœ¼ë¡œ ë°°ì¹˜í•´ì£¼ëŠ” ê²ƒ

4. ì´ì²˜ëŸ¼ ìë™ ì„¤ì •, ìë™ êµ¬ì„± ëª¨ë‘ ë§ëŠ” ìš©ì–´
   - ìë™ ì„¤ì •ì€ ì¢€ ë” ë„“ê²Œ ì‚¬ìš©ë˜ëŠ” ì˜ë¯¸
   - ìë™ êµ¬ì„±ì€ ì‹¤í–‰ì— í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ ì¡°ê°ì„ ìë™ìœ¼ë¡œ ë°°ì¹˜í•œë‹¤ëŠ” ì˜ë¯¸ë¡œ ë” ì¢ì€ ì˜ë¯¸ì— ê°€ê¹Œì›€
   - Auto Configuration : ìë™ êµ¬ì„±ì´ë¼ëŠ” ë‹¨ì–´ë¡œ ì£¼ë¡œ ì‚¬ìš© (ë¬¸ë§¥ì— ë”°ë¼ ìë™ ì„¤ì •ì´ë¼ëŠ” ë‹¨ì–´ë¡œ ì‚¬ìš©)
   - Configuration : ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©ë˜ë©´ ì„¤ì •ì´ë¼ëŠ” ë‹¨ì–´ë¡œ ì‚¬ìš©

-----
### ì •ë¦¬
-----
1. ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ìë™ êµ¬ì„± ê¸°ëŠ¥ì„ ì´í•´í•˜ë ¤ë©´ ë‹¤ìŒ ë‘ ê°€ì§€ ê°œë… ì´í•´
2. @Conditional : íŠ¹ì • ì¡°ê±´ì´ ë§ì„ ë•Œ ì„¤ì • ë™ì‘
3. @AutoConfiguration : ìë™ êµ¬ì„±ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ” ë‚´ë¶€ ì›ë¦¬ ì´í•´
