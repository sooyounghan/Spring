-----
### @Conditional
-----
1. ì•ì„œ ë§Œë“  ë©”ëª¨ë¦¬ ì¡°íšŒ ê¸°ëŠ¥ì„ í•­ìƒ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ íŠ¹ì • ì¡°ê±´ì¼ë•Œë§Œ í•´ë‹¹ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ë„ë¡ ì„¤ì •
   - ì˜ˆë¥¼ ë“¤ì–´ì„œ, ê°œë°œ ì„œë²„ì—ì„œ í™•ì¸ ìš©ë„ë¡œ í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê³ , ìš´ì˜ ì„œë²„ì—ì„œëŠ” í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒ
   - ğŸ’¡ ì—¬ê¸°ì„œ í•µì‹¬ì€ ì†ŒìŠ¤ ì½”ë“œë¥¼ ê³ ì¹˜ì§€ ì•Šê³  ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒ
     + í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•´ì„œ ë‚˜ì˜¨ ë¹Œë“œ íŒŒì¼ì„ ê°œë°œ ì„œë²„ì—ë„ ë°°í¬í•˜ê³ , ê°™ì€ íŒŒì¼ì„ ìš´ì˜ ì„œë²„ì—ë„ ë°°í¬í•´ì•¼ í•¨
   - ğŸ’¡ ê°™ì€ ì†ŒìŠ¤ ì½”ë“œì¸ë° íŠ¹ì • ìƒí™©ì¼ ë•Œë§Œ, íŠ¹ì • ë¹ˆë“¤ì„ ë“±ë¡í•´ì„œ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ê¸°ëŠ¥ : @Conditional
   - ğŸ’¡ ì°¸ê³ ë¡œ ì´ ê¸°ëŠ¥ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ ìë™ êµ¬ì„±ì—ì„œ ìì£¼ ì‚¬ìš©

2. ğŸ’¡ ì¦‰, ì´ë¦„ ê·¸ëŒ€ë¡œ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ê°€, ë§Œì¡±í•˜ì§€ ì•ŠëŠ”ê°€ë¥¼ êµ¬ë³„í•˜ëŠ” ê¸°ëŠ¥
3. ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¨¼ì € Condition ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•¨
4. Condition ì¸í„°í˜ì´ìŠ¤
```java
package org.springframework.context.annotation;

public interface Condition {
    boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);
}
```

  - matches() ë©”ì„œë“œ
    + trueë¥¼ ë°˜í™˜í•˜ë©´ ì¡°ê±´ì— ë§Œì¡±í•´ì„œ ë™ì‘
    + falseë¥¼ ë°˜í™˜í•˜ë©´ ë™ì‘í•˜ì§€ ì•ŠìŒ

  - ConditionContext : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ, í™˜ê²½ ì •ë³´ ë“± ë‹´ê³  ìˆìŒ
  - AnnotatedTypeMetadata : ì• ë„ˆí…Œì´ì…˜ ë©”íƒ€ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ

5. Condition ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ìë°” ì‹œìŠ¤í…œ ì†ì„±ì´ memory=on ì´ë¼ê³  ë˜ì–´ìˆì„ ë•Œë§Œ, ë©”ëª¨ë¦¬ ê¸°ëŠ¥ì´ ë™ì‘
```
##VM Options
#java -Dmemory=on -jar proejct.jar
```

6. MemoryCondition
```java
package memory;

import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Condition;
import org.springframework.context.annotation.ConditionContext;
import org.springframework.core.type.AnnotatedTypeMetadata;

@Slf4j
public class MemoryCondition implements Condition {
    @Override
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {

        // -DMmoery=on
        String memory = context.getEnvironment().getProperty("memory");

        log.info("memory = {}", memory);
        return "on".equals(memory);
    }
}
```
  - í™˜ê²½ ì •ë³´ì— memory=onì´ë¼ê³  ë˜ì–´ ìˆëŠ” ê²½ìš°ì—ë§Œ true ë°˜í™˜

7. MemoryConfig ìˆ˜ì •
```java
package hello.config;

import memory.MemoryCondition;
import memory.MemoryController;
import memory.MemoryFinder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Conditional;
import org.springframework.context.annotation.Configuration;

@Configuration
@Conditional(MemoryCondition.class) // ì¶”ê°€
public class MemoryConfig {

    @Bean
    public MemoryController memoryController() {
        return new MemoryController(memoryFinder());
    }

    @Bean
    public MemoryFinder memoryFinder() {
        return new MemoryFinder();
    }
}
```
  - @Conditional(MemoryCondition.class)
    + ğŸ’¡ MemoryConfigì˜ ì ìš© ì—¬ë¶€ëŠ” @Conditionalì— ì§€ì •í•œ MemoryConditionì˜ ì¡°ê±´ì— ë”°ë¼ ë‹¬ë¼ì§
    + MemoryConditionì˜ matches()ë¥¼ ì‹¤í–‰í•´ë³´ê³ , ê·¸ ê²°ê³¼ê°€ trueì´ë©´ MemoryConfigëŠ” ì •ìƒ ë™ì‘
    + ë”°ë¼ì„œ, memoryController, memoryFinderê°€ ë¹ˆìœ¼ë¡œ ë“±ë¡
    + ë§Œì•½, MemoryConditionì˜ ì‹¤í–‰ ê²°ê³¼ê°€ falseì´ë©´, MemoryConfigëŠ” ë¬´íš¨í™”ë˜ë©°, memoryControllerì™€ memoryFinder ë¹ˆì€ ë“±ë¡ë˜ì§€ ì•ŠìŒ

  - ì•„ë¬´ ì¡°ê±´ì„ ì£¼ì§€ ì•Šê³  ì‹¤í–‰
```
Whitelabel Error Page
```
  - memory=onì„ ì„¤ì •í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ ë™ì‘í•˜ì§€ ì•ŠìŒ
  - ë¡œê·¸ë¥¼ í†µí•´ì„œ MemoryCondition ì¡°ê±´ì´ ì‹¤í–‰ëœ ë¶€ë¶„ í™•ì¸ ê°€ëŠ¥ (ê²°ê³¼ëŠ” false)
```
[           main] memory.MemoryCondition                   : memory = null
```

  - memory=onìœ¼ë¡œ ì¡°ê±´ì„ ì£¼ê³  ì‹¤í–‰
<div align="center">
<img src="https://github.com/user-attachments/assets/120b215e-ebcd-42cc-829b-cd600e68e7bb">
</div>

  - ğŸ’¡ VM ì˜µì…˜ì„ ì¶”ê°€í•˜ëŠ” ê²½ìš°, -Dmemory=onë¥¼ ì‚¬ìš©
  - ì‹¤í–‰
```
{
    "used": 27061952,
    "max": 2111832064
}
```
  - ë¡œê·¸ ê²°ê³¼
```
[           main] memory.MemoryCondition                   : memory = on
[           main] memory.MemoryFinder                      : init memoryFinder
[nio-9090-exec-1] memory.MemoryController                  : memory = Memory{used=27061952, max=2111832064}
```
  - ìŠ¤í”„ë§ì´ ë¡œë”©ë˜ëŠ” ê³¼ì •ì€ ë³µì¡í•´ì„œ MemoryConditionì´ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë  ìˆ˜ ìˆìŒ
  - ğŸ’¡ ì°¸ê³  : ìŠ¤í”„ë§ì€ ì™¸ë¶€ ì„¤ì •ì„ ì¶”ìƒí™”í•´ì„œ Enviornmentë¡œ í†µí•©
    + ë”°ë¼ì„œ, ë‹¤ì–‘í•œ ì™¸ë¶€ í™˜ê²½ ì„¤ì •ì„ Enviornment í•˜ë‚˜ë¡œ ì½ì–´ë“¤ì¼ ìˆ˜ ìˆìŒ
```
# VM Options
# java -Dmemory=on -jar project.jar -Dmemory=on

# Program arguments
# -- ê°€ ìˆìœ¼ë©´ ìŠ¤í”„ë§ì´ í™˜ê²½ ì •ë³´ë¡œ ì‚¬ìš©
# java -jar project.jar --memory=on --memory=on

# application.properties
# application.propertiesì— ìˆìœ¼ë©´ í™˜ê²½ ì •ë³´ë¡œ ì‚¬ìš© memory=on
```

-----
### @Conditional - ë‹¤ì–‘í•œ ê¸°ëŠ¥
-----
1. ìŠ¤í”„ë§ì€ ì´ë¯¸ í•„ìš”í•œ Condition ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ì–´ë‘ 
2. MemoryConfig - ìˆ˜ì •
```java
package hello.config;

import memory.MemoryCondition;
import memory.MemoryController;
import memory.MemoryFinder;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Conditional;
import org.springframework.context.annotation.Configuration;

@Configuration
// @Conditional(MemoryCondition.class)
@ConditionalOnProperty(name = "memory", havingValue = "on")
public class MemoryConfig {

    @Bean
    public MemoryController memoryController() {
        return new MemoryController(memoryFinder());
    }

    @Bean
    public MemoryFinder memoryFinder() {
        return new MemoryFinder();
    }
}
```

  - @Conditional(MemoryCondition.class) ì£¼ì„ ì²˜ë¦¬
  - @ConditionalOnProperty(name = "memory", havingValue = "on")
    + í™˜ê²½ ì •ë³´ê°€ memory=onì´ë¼ëŠ” ì¡°ê±´ì— ë§ìœ¼ë©´ ë™ì‘, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë™ì‘í•˜ì§€ ì•ŠìŒ
  - ì‹¤í–‰í•˜ë©´ ì•ì„œ ë§Œë“  ê²ƒê³¼ ë™ì¼í•˜ê²Œ ì‘ë™

3. @ConditionalOnPropery
```java
package org.springframework.boot.autoconfigure.condition;

@Conditional(OnPropertyCondition.class)
public @interface ConditionalOnProperty {...}
```
  - @ConditionalOnProeprtyë„ ë™ì¼í•˜ê²Œ ë‚´ë¶€ì— @Conditional ì‚¬ìš©
  - ê·¸ë¦¬ê³  ê·¸ ì•ˆì—ëŠ” Condition ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ OnPropertyConditionë¥¼ ê°€ì§€ê³  ìˆìŒ

4. ğŸ’¡ @ConditionalOnXxx
   - ìŠ¤í”„ë§ì€ @Conditionalê³¼ ê´€ë ¨í•´ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ ë§ì€ @ConditionalOnXxx ì œê³µ
   - ğŸ’¡ @ConditionalOnClass, @ConditionalOnMissingClass : í´ë˜ìŠ¤ê°€ ìˆëŠ” ê²½ìš° ë™ì‘, ë‚˜ë¨¸ì§€ëŠ” ê·¸ ë°˜ëŒ€
   - ğŸ’¡ @ConditionalOnBean, @ConditionalOnMissingBean : ë¹ˆì´ ë“±ë¡ë˜ì–´ ìˆëŠ” ê²½ìš°, ë‚˜ë¨¸ì§€ëŠ” ê·¸ ë°˜ëŒ€
   - ğŸ’¡ @ConditionalOnProperty : í™˜ê²½ ì •ë³´ê°€ ìˆëŠ” ê²½ìš° ë™ì‘
   - ğŸ’¡ @ConditionalOnResource : ë¦¬ì†ŒìŠ¤ê°€ ìˆëŠ” ê²½ìš° ë™ì‘
   - ğŸ’¡ @ConditionalOnWebApplication, @ConditionalOnNotWebApplication : ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì¸ ê²½ìš° ë™ì‘, ë‚˜ë¨¸ì§€ëŠ” ê·¸ ë°˜ëŒ€
   - ğŸ’¡ @ConditionalOnExpression : SpEL í‘œí˜„ì‹ì— ë§Œì¡±í•˜ëŠ” ê²½ìš° ë™ì‘
   - ê³µì‹ ë©”ë‰´ì–¼ : https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.developing-auto-configuration.condition-annotations
   - ğŸ’¡ @ConditionalOnXxxëŠ” ì£¼ë¡œ ìŠ¤í”„ë§ ë¶€íŠ¸ ìë™ êµ¬ì„±ì— ì‚¬ìš©
     + ìë™ êµ¬ì„± í´ë˜ìŠ¤ë“¤ì„ ì—´ì–´ì„œ ì†ŒìŠ¤ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ @ConditionalOnXxxê°€ ì•„ì£¼ ë§ì´ ì‚¬ìš©ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥
     + JdbcTemplateAutoConfiguration, DataSourceTransactionManagerAutoConfiguration, DataSourceAutoConfiguration

5. ğŸ’¡ ì°¸ê³  : @Condtional ìì²´ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì•„ë‹ˆë¼ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ëŠ¥ (ë³¸ë˜ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ëŠ¥ì´ì—ˆìŒ)
   - ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì´ ê¸°ëŠ¥ì„ í™•ì¥í•´ì„œ @ConditionalXxxë¥¼ ì œê³µ
