-----
### @Profile
-----
1. í”„ë¡œí•„ê³¼ ì™¸ë¶€ ì„¤ì •ì„ ì‚¬ìš©í•´ ê° í™˜ê²½ë§ˆë‹¤ ì„¤ì •ê°’ì„ ë‹¤ë¥´ê²Œ ì ìš© ê°€ëŠ¥
2. ê·¸ëŸ°ë° ì„¤ì •ê°’ì´ ë‹¤ë¥¸ ì •ë„ê°€ ì•„ë‹ˆë¼ ê° í™˜ê²½ë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥¸ ë¹ˆì„ ë“±ë¡í•´ì•¼ í•œë‹¤ë©´?
   - ì˜ˆë¥¼ ë“¤ì–´ì„œ, ê²°ê²Œ ê¸°ëŠ¥ì„ ë¶™ì—¬ì•¼ í•˜ëŠ”ë°, ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ ê²°ì œê°€ ë°œìƒí•˜ë©´ ë¬¸ì œê°€ ë˜ë‹ˆ ê°€ì§œ ê²°ì œ ê¸°ëŠ¥ì´ ìˆëŠ” ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
   - ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ ê²°ì œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ìŠ¤í”„ë§ì„ ë“±ë¡í•œë‹¤ê³  ê°€ì •

3. PayClient
```java
package hello.pay;

public interface PayClient {
    void pay(int money);
}
```
  - DIë¥¼ ì ê·¹ í™œìš©í•˜ê¸° ìœ„í•´ ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©

4. LocalPayClient
```java
package hello.pay;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class LocalPayClient implements PayClient {
    @Override
    public void pay(int money) {
        log.info("ë¡œì»¬ ê²°ì œ money = {}", money);
    }
}
```
  - ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ ê²°ì œë¥¼ í•˜ì§€ ì•ŠìŒ

5. ProdPayClient
```java
package hello.pay;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class ProdPayClient implements PayClient {
    @Override
    public void pay(int money) {
        log.info("ìš´ì˜ ê²°ì œ money = {}", money);
    }
}
```
  - ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ ê²°ì œë¥¼ ì‹œë„

6. OrderService
```java
package hello.pay;

import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class OrderService {
    private final PayClient payClient;

    public void order(int money) {
        // ì£¼ë¬¸ ë¡œì§ í›„, ê²°ì œ
        payClient.pay(money);
    }
}
```
  - PayClient ì‚¬ìš© ë¶€ë¶„
  - ìƒí™©ì— ë”°ë¼ LocalPayClientë‚˜ ProdPayClientë¥¼ ì£¼ì… ë°›ìŒ

7. PayConfig
```java
package hello.pay;

import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;

@Slf4j
@Configuration
public class PayConfig {

    @Bean
    @Profile("default")
    public LocalPayClient localPayClient() {
        log.info("LocalPayClient ë¹ˆ ë“±ë¡");
        return new LocalPayClient();
    }

    @Bean
    @Profile("prod")
    public ProdPayClient prodPayClient() {
        log.info("ProdPayClient ë¹ˆ ë“±ë¡");
        return new ProdPayClient();
    }
}
```
  - ğŸ’¡ @Profile ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ í”„ë¡œí•„ì´ í™œì„±í™” ëœ ê²½ìš°ì—ë§Œ ë¹ˆ ë“±ë¡
    + defualt í”„ë¡œí•„ (ê¸°ë³¸ê°’) í™œì„±í™” : LocalPayClientë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡
    + prod í”„ë¡œí•„ í™œì„±í™” : ProdPayClientë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡

8. RunOrder
```java
package hello.pay;

import lombok.RequiredArgsConstructor;
import org.springframework.boot.ApplicationArguments;
import org.springframework.boot.ApplicationRunner;
import org.springframework.stereotype.Component;

@Component
@RequiredArgsConstructor
public class OrderRunner implements ApplicationRunner {

    private final OrderService orderService;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        orderService.order(1000);
    }
}
```
  - ğŸ’¡ ApplicationRunner ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤í”„ë§ ë¹ˆ ì´ˆê¸°í™”ê°€ ëª¨ë‘ ëë‚˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”©ì´ ì™„ë£Œë˜ëŠ” ì‹œì ì— run(args) ë©”ì„œë“œ í˜¸ì¶œ
    
9. ExternalReadApplication ë³€ê²½
```java
package hello;

import hello.config.*;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Import;

// @Import(MyDataSourceEnvConfig.class)
// @Import(MyDataSourceValueConfig.class)
// @Import(MyDataSourceConfigV1.class)
// @Import(MyDataSourceConfigV2.class)
@Import(MyDataSourceConfigV3.class)
@SpringBootApplication(scanBasePackages = {"hello.datasource", "hello.pay"})
public class ExternalReadApplication {

    public static void main(String[] args) {
        SpringApplication.run(ExternalReadApplication.class, args);
    }

}
```
  - ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë¶€ë¶„ì— hello.pay íŒ¨í‚¤ì§€ ì¶”ê°€

10. í”„ë¡œí•„ ì—†ì´ ì‹¤í–‰
```
2024-09-16T19:17:03.113+09:00  INFO 10248 --- [           main] hello.ExternalReadApplication            : No active profile set, falling back to 1 default profile: "default"
2024-09-16T19:17:04.200+09:00  INFO 10248 --- [           main] hello.pay.PayConfig                      : LocalPayClient ë¹ˆ ë“±ë¡
...
2024-09-16T19:17:04.561+09:00  INFO 10248 --- [           main] hello.pay.LocalPayClient                 : ë¡œì»¬ ê²°ì œ money = 1000
```
  - í”„ë¡œí•„ ì—†ì´ ì‹¤í–‰í•˜ë©´ default í”„ë¡œí•„ ì‚¬ìš©
  - default í”„ë¡œí•„ì´ ì‚¬ìš©ë˜ë©´ LocalPayClientê°€ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥

11. prod í”„ë¡œí•„ ì‹¤í–‰
  - --spring.profiles.active=prod í”„ë¡œí•„ í™œì„±í™” ì ìš©
```
2024-09-16T19:18:22.489+09:00  INFO 16588 --- [           main] hello.ExternalReadApplication            : The following 1 profile is active: "prod"
2024-09-16T19:18:23.565+09:00  INFO 16588 --- [           main] hello.pay.PayConfig                      : ProdPayClient ë¹ˆ ë“±ë¡
...
2024-09-16T19:18:24.276+09:00  INFO 16588 --- [           main] hello.pay.ProdPayClient                  : ìš´ì˜ ê²°ì œ money = 1000
```
  - prod í”„ë¡œí•„ ì ìš©
  - prod í”„ë¡œí•„ì´ ì‹œì‘ë˜ë©´ ProdPayClientê°€ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥

12. @Profile ì •ì²´
```java
package org.springframework.context.annotation;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

...
@Conditional({ProfileCondition.class})
public @interface Profile {
    String[] value();
}
```
  - ğŸ’¡ @Profileì€ íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ í•´ë‹¹ ë¹ˆì„ ë“±ë¡í• ì§€ ë§ì§€ ê²°ì •
  - ì¦‰, @Conditional(ProfileCondition.class)ë¥¼ í†µí•´ ì´ë¥¼ ê²°ì •í•˜ê³ , í•´ë‹¹ ì½”ë“œì— ì¡´ì¬
  - ğŸ’¡ ì¦‰, ìŠ¤í”„ë§ì€ @Conditional ê¸°ëŠ¥ì„ í™œìš©í•´ ê°œë°œìê°€ ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” @Profile ê¸°ëŠ¥ ì œê³µ

13. ì •ë¦¬
    - @Profileì„ ì‚¬ìš©í•˜ë©´ ê° í™˜ê²½ ë³„ë¡œ ì™¸ë¶€ ì„¤ì • ê°’ì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒì„ ë„˜ì–´, ë“±ë¡ë˜ëŠ” ìŠ¤í”„ë§ ë¹ˆë„ ë¶„ë¦¬ ê°€ëŠ¥
    
