-----
### ë©”íŠ¸ë¦­ í™•ì¸
-----
1. CPU, JVM, ì»¤ë„¥ì…˜ ì‚¬ìš© ë“± ìˆ˜ë§ì€ ì§€í‘œë“¤ì˜ ìˆ˜ì§‘ ë°©ë²•?
   - ê° ì§€í‘œë¥¼ ì§ì ‘ ìˆ˜ì§‘í•´ì„œ ê·¸ê²ƒì„ ë§ˆì´í¬ë¡œë¯¸í„°ë¼ëŠ” í‘œì¤€ ë°©ë²•ì— ë“±ë¡í•´ë„ ë¨
   - ë‹¤í–‰íˆë„ ë§ˆì´í¬ë¡œë¯¸í„°ëŠ” ë‹¤ì–‘í•œ ì§€í‘œ ìˆ˜ì§‘ ê¸°ëŠ¥ì„ ì´ë¯¸ ë§Œë“¤ì–´ì„œ ì œê³µ
   - ğŸ’¡ ê·¸ë¦¬ê³  ìŠ¤í”„ë§ ë¶€íŠ¸ ì•¡ì¸„ì—ì´í„°ëŠ” ë§ˆì´í¬ë¡œë¯¸í„°ê°€ ì œê³µí•˜ëŠ” ì§€í‘œ ìˆ˜ì§‘ì„ @AutoConfigurationì„ í†µí•´ ìë™ìœ¼ë¡œ ë“±ë¡

2. ì‰½ê²Œ ì´ì•¼ê¸°í•´ì„œ ìŠ¤í”„ë§ ë¶€íŠ¸ ì•¡ì¸„ì—ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ìˆ˜ ë§ì€ ë©”íŠ¸ë¦­(ì§€í‘œ)ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
3. ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë©”íŠ¸ë¦­ í™•ì¸
  - metrics ì—”ë“œí¬ì¸íŠ¸ : ê¸°ë³¸ìœ¼ë¡œ ì œê³µë˜ëŠ” ë©”íŠ¸ë¦­ í™•ì¸ ê°€ëŠ¥ (http://localhost:9090/actuator/metrics)
```json
{
    "names": [
        "application.ready.time",
        "application.started.time",
        "disk.free",
        "disk.total",
        "executor.active",
        "executor.completed",
        "executor.pool.core",
        "executor.pool.max",
        "executor.pool.size",
        "executor.queue.remaining",
        "executor.queued",
        "hikaricp.connections",
        "hikaricp.connections.acquire",
        "hikaricp.connections.active",
        "hikaricp.connections.creation",
        "hikaricp.connections.idle",
        "hikaricp.connections.max",
        "hikaricp.connections.min",
        "hikaricp.connections.pending",
        "hikaricp.connections.timeout",
        "hikaricp.connections.usage",
        "http.server.requests.active",
        "jdbc.connections.active",
        "jdbc.connections.idle",
        "jdbc.connections.max",
        "jdbc.connections.min",
        "jvm.buffer.count",
        "jvm.buffer.memory.used",
        "jvm.buffer.total.capacity",
        "jvm.classes.loaded",
        "jvm.classes.unloaded",
        "jvm.compilation.time",
        "jvm.gc.live.data.size",
        "jvm.gc.max.data.size",
        "jvm.gc.memory.allocated",
        "jvm.gc.memory.promoted",
        "jvm.gc.overhead",
        "jvm.gc.pause",
        "jvm.info",
        "jvm.memory.committed",
        "jvm.memory.max",
        "jvm.memory.usage.after.gc",
        "jvm.memory.used",
        "jvm.threads.daemon",
        "jvm.threads.live",
        "jvm.threads.peak",
        "jvm.threads.states",
        "logback.events",
        "process.cpu.usage",
        "process.start.time",
        "process.uptime",
        "system.cpu.count",
        "system.cpu.usage",
        "tomcat.sessions.active.current",
        "tomcat.sessions.active.max",
        "tomcat.sessions.alive.max",
        "tomcat.sessions.created",
        "tomcat.sessions.expired",
        "tomcat.sessions.rejected"
    ]
}
```
  - ì•¡ì¸„ì—ì´í„°ê°€ ë§ˆì´í¬ë¡œë¯¸í„°ë¥¼ í†µí•´ ë“±ë¡í•œ ê¸°ë³¸ ë©”íŠ¸ë¦­ í™•ì¸ ê°€ëŠ¥

4. ìì„¸íˆ í™•ì¸í•˜ê¸°
   - metrics ì—”ë“œí¬ì¸íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŒ¨í„´ì„ ì‚¬ìš©í•´ ë” ìì„¸íˆ í™•ì¸ ê°€ëŠ¥
   - http://localhost:9090/actuator/metrics/{name}
   - ì˜ˆ) JVM ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
     + http://localhost:9090/actuator/metrics/jvm.memory.used
```json
{
    "name": "jvm.memory.used",
    "description": "The amount of used memory",
    "baseUnit": "bytes",
    "measurements": [
        {
            "statistic": "VALUE",
            "value": 1.11674472E8
        }
    ],
    "availableTags": [
        {
            "tag": "area",
            "values": [
                "heap",
                "nonheap"
            ]
        },
        {
            "tag": "id",
            "values": [
                "G1 Survivor Space",
                "Compressed Class Space",
                "Metaspace",
                "CodeCache",
                "G1 Old Gen",
                "G1 Eden Space"
            ]
        }
    ]
}
```
  - í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸

5. ğŸ’¡ Tag í•„í„°
   - availableTagsë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ í•­ëª© í™•ì¸ ê°€ëŠ¥
     + tag:area, values[heap, nonheap]
     + tag:id, values[G1 Survivor Space, ...]
   - í•´ë‹¹ Tagë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì •ë³´ë¥¼ í•„í„°ë§ í•´ì„œ í™•ì¸ ê°€ëŠ¥
     + ğŸ’¡ tag=Key:VALUEì™€ ê°™ì€ í˜•ì‹ì„ ì‚¬ìš©í•´ì•¼ í•¨
     + http://localhost:9090/actuator/metrics/jvm.memory.used?tag=area:heap
     + http://localhost:9090/actuator/metrics/jvm.memory.used?tag=area:nonheap
   - tagë¥¼ ì‚¬ìš©í•´ì„œ í™ ë©”ëª¨ë¦¬, í™ì´ ì•„ë‹Œ ë©”ëª¨ë¦¬ë¡œ ë¶„ë¥˜í•´ì„œ ë°ì´í„° í™•ì¸ ê°€ëŠ¥
   - tag í•„í„°ë§ ê²°ê³¼
```json
{
    "name": "jvm.memory.used",
    "description": "The amount of used memory",
    "baseUnit": "bytes",
    "measurements": [
        {
            "statistic": "VALUE",
            "value": 3.356408E7
        }
    ],
    "availableTags": [
        {
            "tag": "id",
            "values": [
                "G1 Survivor Space",
                "G1 Old Gen",
                "G1 Eden Space"
            ]
        }
    ]
}
```
```json
{
    "name": "jvm.memory.used",
    "description": "The amount of used memory",
    "baseUnit": "bytes",
    "measurements": [
        {
            "statistic": "VALUE",
            "value": 7.0548768E7
        }
    ],
    "availableTags": [
        {
            "tag": "id",
            "values": [
                "Metaspace",
                "CodeCache",
                "Compressed Class Space"
            ]
        }
    ]
}
```

6. HTTP ìš”ì²­ ìˆ˜ í™•ì¸
   - http://localhost:9090/actuator/metrics/http.server.requests
```json
{
    "name": "http.server.requests",
    "baseUnit": "seconds",
    "measurements": [
        {
            "statistic": "COUNT",
            "value": 7.0
        },
        {
            "statistic": "TOTAL_TIME",
            "value": 0.3544173
        },
        {
            "statistic": "MAX",
            "value": 0.1176088
        }
    ],
    "availableTags": [
        {
            "tag": "exception",
            "values": [
                "none"
            ]
        },
        {
            "tag": "method",
            "values": [
                "GET"
            ]
        },
        {
            "tag": "error",
            "values": [
                "none"
            ]
        },
        {
            "tag": "uri",
            "values": [
                "/actuator/metrics/{requiredMetricName}",
                "/actuator/metrics",
                "/log"
            ]
        },
        {
            "tag": "outcome",
            "values": [
                "SUCCESS"
            ]
        },
        {
            "tag": "status",
            "values": [
                "200"
            ]
        }
    ]
}
```

   - HTTP ìš”ì²­ìˆ˜ì—ì„œ ì¼ë¶€ ë‚´ìš© í•„í„°ë§í•´ì„œ í™•ì¸
     + /log ìš”ì²­ë§Œ í•„í„°(ì‚¬ì „ì— /log ìš”ì²­ì„ í•´ì•¼ í™•ì¸ ê°€ëŠ¥)
     + http://localhost:9090/actuator/metrics/http.server.requests?tag=uri:/log
```json
{
    "name": "http.server.requests",
    "baseUnit": "seconds",
    "measurements": [
        {
            "statistic": "COUNT",
            "value": 4.0
        },
        {
            "statistic": "TOTAL_TIME",
            "value": 0.1274028
        },
        {
            "statistic": "MAX",
            "value": 0.1176088
        }
    ],
    "availableTags": [
        {
            "tag": "exception",
            "values": [
                "none"
            ]
        },
        {
            "tag": "method",
            "values": [
                "GET"
            ]
        },
        {
            "tag": "error",
            "values": [
                "none"
            ]
        },
        {
            "tag": "outcome",
            "values": [
                "SUCCESS"
            ]
        },
        {
            "tag": "status",
            "values": [
                "200"
            ]
        }
    ]
}
```

   + /log ìš”ì²­ & HTTP Status = 200
   + http://localhost:9090/actuator/metrics/http.server.requests?tag=uri:/log&status:200
```json
{
    "name": "http.server.requests",
    "baseUnit": "seconds",
    "measurements": [
        {
            "statistic": "COUNT",
            "value": 4.0
        },
        {
            "statistic": "TOTAL_TIME",
            "value": 0.1274028
        },
        {
            "statistic": "MAX",
            "value": 0.1176088
        }
    ],
    "availableTags": [
        {
            "tag": "exception",
            "values": [
                "none"
            ]
        },
        {
            "tag": "method",
            "values": [
                "GET"
            ]
        },
        {
            "tag": "error",
            "values": [
                "none"
            ]
        },
        {
            "tag": "outcome",
            "values": [
                "SUCCESS"
            ]
        }
    ]
}
```

-----
### ë‹¤ì–‘í•œ ë©”íŠ¸ë¦­
-----
1. ğŸ’¡ ë§ˆì´í¬ë¡œë¯¸í„°ì™€ ì•¡ì¸„ì—ì´í„°ê°€ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ ë©”íŠ¸ë¦­
   - JVM ë©”íŠ¸ë¦­
   - ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
   - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ë©”íŠ¸ë¦­
   - ìŠ¤í”„ë§ MVC ë©”íŠ¸ë¦­
   - í†°ìº£ ë©”íŠ¸ë¦­
   - ë°ì´í„° ì†ŒìŠ¤ ë©”íŠ¸ë¦­
   - ë¡œê·¸ ë©”íŠ¸ë¦­
   - ê¸°íƒ€ ìˆ˜ ë§ì€ ë©”íŠ¸ë¦­
   - ì‚¬ìš©ìê°€ ë©”íŠ¸ë¦­ ì§ì ‘ ì •ì˜ ê°€ëŠ¥

2. JVM ë©”íŠ¸ë¦­
   - JVM ê´€ë ¨ ë©”íŠ¸ë¦­ ì œê³µ
   - ğŸ’¡ jvm.ìœ¼ë¡œ ì‹œì‘
     + ë©”ëª¨ë¦¬ ë° ë²„í¼ í’€ ì„¸ë¶€ ì •ë³´
     + ê°€ë¹„ì§€ ìˆ˜ì§‘ ê´€ë ¨ í†µê³„
     + ìŠ¤ë ˆë“œ í™œë™
     + ë¡œë“œ ë° ì–¸ë¡œë“œëœ í´ë˜ìŠ¤ ìˆ˜
     + JVM ë²„ì „ ì •ë³´
     + JIT ì»´íŒŒì¼ ì‹œê°„

3. ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
   - ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ ì œê³µ
   - ğŸ’¡ system. / process. / disk. ë¡œ ì‹œì‘
     + CPU ì§€í‘œ
     + íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ë©”íŠ¸ë¦­
     + ê°€ë™ ì‹œê°„ ë©”íŠ¸ë¦­
     + ì‚¬ìš© ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ê³µê°„

4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ë©”íŠ¸ë¦­
   - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ë©”íŠ¸ë¦­ ì œê³µ
   - ğŸ’¡ application.started.time : ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ (ApplicationStartedEventë¡œ ì¸¡ì •)
   - ğŸ’¡ application.ready.time : ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìš”ì²­ì„ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ (ApplicationReadyEventë¡œ ì¸¡ì •)
   - ğŸ’¡ ìŠ¤í”„ë§ ë‚´ë¶€ ì—¬ëŸ¬ ì´ˆê¸°í™” ë‹¨ê³„ê°€ ìˆìœ¼ë©° ê° ë‹¨ê³„ë³„ë¡œ ë‚´ë¶€ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë²¤íŠ¸ ë°œìƒ
     + ğŸ’¡ ApplicationStartedEvent : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì™„ì „íˆ ì‹¤í–‰ëœ ìƒíƒœë¡œ, ì´í›„ ì»¤ë§¨ë“œ ë¼ì¸ ëŸ¬ë„ˆê°€ í˜¸ì¶œ
     + ğŸ’¡ ApplicationReadyEvent : ì»¤ë§¨ë“œ ë¼ì¸ ëŸ¬ë„ˆê°€ ì‹¤í–‰ëœ ì´í›„ í˜¸ì¶œ

5. ğŸ’¡ğŸ’¡ğŸ’¡ ìŠ¤í”„ë§ MVC ë©”íŠ¸ë¦­
   - ìŠ¤í”„ë§ MVC ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì²˜ë¦¬í•˜ëŠ” ëª¨ë“  ìš”ì²­ì„ ë‹¤ë£¸
   - ğŸ’¡ ë©”íŠ¸ë¦­ ì´ë¦„ : http.server.requests
   - ğŸ’¡ TAGë¥¼ ì‚¬ìš©í•´ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ ë¶„ë¥˜í•´ì„œ ë³¼ ìˆ˜ ìˆìŒ
     + ğŸ’¡ uri : ìš”ì²­ URI (ğŸ’¡ í˜„ì¬ê¹Œì§€ ìš”ì²­ëœ URI)
     + ğŸ’¡ method : GET, POSTì™€ ê°™ì€ HTTP ë©”ì„œë“œ (ğŸ’¡ í˜„ì¬ê¹Œì§€ ìš”ì²­ëœ HTTP ë©”ì„œë“œ)
     + ğŸ’¡ status : 200, 400, 500 ê°™ì€ HTTP Status ì½”ë“œ (ğŸ’¡ í˜„ì¬ê¹Œì§€ ìš”ì²­ëœ HTTP Status ì½”ë“œ)
     + exception : ì˜ˆì™¸ (ğŸ’¡ í˜„ì¬ê¹Œì§€ ìš”ì²­ëœ ì˜ˆì™¸)
     + outcome : ìƒíƒœì½”ë“œë¥¼ ê·¸ë£¹ìœ¼ë¡œ ëª¨ì•„ì„œ í™•ì¸ (1xx : INFORMATIONAL, 2xx : SUCCESS, 3xx : REDIRECTION, 4xx : CLIENT_ERROR, 5xx : SERVER_ERROR)  (ğŸ’¡ í˜„ì¬ê¹Œì§€ ìš”ì²­ëœ ìƒíƒœì½”ë“œ ê·¸ë£¹ìœ¼ë¡œ í‘œì‹œ)
    
6. ğŸ’¡ ë°ì´í„° ì†ŒìŠ¤ ë©”íŠ¸ë¦­
   - DataSource, ì»¤ë„¥ì…˜ í’€ì— ê´€í•œ ë©”íŠ¸ë¦­ í™•ì¸
   - ğŸ’¡ jdbc.connections. ë¡œ ì‹œì‘
   - ğŸ’¡ ìµœëŒ€ ì»¤ë„¥ì…˜, ìµœì†Œ ì»¤ë„¥ì…˜, í™œì„± ì»¤ë„¥ì…˜, ëŒ€ê¸° ì»¤ë„¥ì…˜ ìˆ˜ ë“± í™•ì¸ ê°€ëŠ¥
   - ğŸ’¡ íˆì¹´ë¦¬ ì»¤ë„¥ì…˜ í’€ì„ ì‚¬ìš©í•˜ë©´ hikaricp.ë¥¼ í†µí•´ íˆì¹´ë¦¬ ì»¤ë„¥ì…˜ í’€ì˜ ìì„¸í•œ ë©”íŠ¸ë¦­ í™•ì¸ ê°€ëŠ¥

7. ğŸ’¡ ë¡œê·¸ ë©”íŠ¸ë¦­
   - ğŸ’¡ logback.events : logback ë¡œê·¸ì— ëŒ€í•œ ë©”íŠ¸ë¦­ í™•ì¸ ê°€ëŠ¥
   - ğŸ’¡ trace, debug, info, warn, error ê° ë¡œê·¸ ë ˆë²¨ì— ë”°ë¥¸ ë¡œê·¸ ìˆ˜ í™•ì¸ ê°€ëŠ¥
     + ì˜ˆ) error ë¡œê·¸ ìˆ˜ê°€ ê¸‰ê²©íˆ ë†’ì•„ì§„ë‹¤ë©´ ìœ„í—˜í•œ ì‹ í˜¸ë¡œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆìŒ (tag filter)
     + http://localhost:9090/actuator/metrics/logback.events?tag=level:error

8. ğŸ’¡ğŸ’¡ğŸ’¡ í†°ìº£ ë©”íŠ¸ë¦­
   - ğŸ’¡ tomcat. ìœ¼ë¡œ ì‹œì‘
   - ğŸ’¡ í†°ìº£ ë©”íŠ¸ë¦­ì„ ëª¨ë‘ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì˜µì…˜ì„ ì¼œì•¼í•¨
   - ğŸ’¡ ì˜µì…˜(server.tomcat.mbeanregistry.enabled=true)ì„ í‚¤ì§€ ì•Šìœ¼ë©´ tomcat.session. ê´€ë ¨ ì •ë³´ë§Œ ë…¸ì¶œ
   - application.yml
```yml
server:
    tomcat:
        mbeanregistry:
            enabled: true
```
   - application.properties
```properties
server.tomcat.mbeanregistry.enabled=true
```
  - tomcat.threads.busy : í†°ìº£ì˜ í˜„ì¬ ì‚¬ìš©ë˜ëŠ” ì“°ë ˆë“œ
  - tomcat.threads.config.max : í†°ìº£ì˜ ìµœëŒ€ ì“°ë ˆë“œ
  - í†°ìº£ì˜ ìµœëŒ€ ì“°ë ˆë“œ, ì‚¬ìš© ì“°ë ˆë“œ ìˆ˜ë¥¼ í¬í•¨í•œ ë‹¤ì–‘í•œ ë©”íŠ¸ë¦­ í™•ì¸ ê°€ëŠ¥

9. ê¸°íƒ€
    - HTTP í´ë¼ì´ì–¸íŠ¸ ë©”íŠ¸ë¦­ (RestTemplate, WebClient)
    - ìºì‹œ ë©”íŠ¸ë¦­
    - ì‘ì—… ì‹¤í–‰ê³¼ ìŠ¤ì¼€ì¤„ ë©”íŠ¸ë¦­
    - ìŠ¤í”„ë§ ë°ì´í„° ë ˆí¬ì§€í† ë¦¬ ë©”íŠ¸ë¦­
    - Mongo DB ë©”íŠ¸ë¦­
    - Reddis ë©”íŠ¸ë¦­

10. ì‚¬ìš©ì ì •ì˜ ë©”íŠ¸ë¦­
    - ì§ì ‘ ë©”íŠ¸ë¦­ì„ ì‚¬ìš©ìê°€ ì •ì˜ ê°€ëŠ¥
      + ì˜ˆ) ì£¼ë¬¸ ìˆ˜, ì£¼ë¬¸ ì·¨ì†Œ ìˆ˜ ë“± ë©”íŠ¸ë¦­ìœ¼ë¡œ ë§Œë“¤ê¸° ê°€ëŠ¥
    - ì‚¬ìš©ì ì •ì˜ ë©”íŠ¸ë¦­ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ë§ˆì´í¬ë¡œë¯¸í„° ì‚¬ìš©ë²•ì„ ì•Œì•„ì•¼í•¨

11. ì •ë¦¬
    - ì•¡ì¸„ì—ì´í„°ë¥¼ í†µí•´ ìˆ˜ ë§ì€ ë©”íŠ¸ë¦­ì´ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥
    - ì´ëŸ¬í•œ ë©”íŠ¸ë¦­ì„ ì–´ë”˜ê°€ì— ì§€ì†í•´ì„œ ë³´ê´€í•´ì•¼ ê³¼ê±° ë°ì´í„°ë“¤ë„ í™•ì¸ ê°€ëŠ¥
    - ë”°ë¼ì„œ, ë©”íŠ¸ë¦­ì„ ì§€ì†ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ë³´ê´€í•  ë°ì´í„°ë² ì´ìŠ¤ í•„ìš”
    - ë˜í•œ, ì´ëŸ¬í•œ ë©”íŠ¸ë¦­ì„ ê·¸ë˜í”„ë¥¼ í†µí•´ì„œ í•œ ëˆˆì— ì‰½ê²Œ í™•ì¸ ê°€ëŠ¥í•œ ëŒ€ì‹œë³´ë“œë„ í•„ìš”

12. ì°¸ê³  : ì§€ì›í•˜ëŠ” ë‹¤ì–‘í•œ ë©”íŠ¸ë¦­ (ê³µì‹ ë©”ë‰´ì–¼) - https://docs.spring.io/spring-boot/redirect.html?page=actuator#actuator.metrics.supported
