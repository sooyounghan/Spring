-----
### ì™¸ë¶€ ì„¤ì • ì‚¬ìš© - @ConfigurationProperties ì‹œì‘
-----
1. ğŸ’¡ Type-Safe Configuration Properties
   - ìŠ¤í”„ë§ì€ ì™¸ë¶€ ì„¤ì •ì˜ ë¬¶ìŒ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥ ì œê³µ
   - ì´ë¥¼ íƒ€ì… ì•ˆì „í•œ ì„¤ì • ì†ì„±
   - ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ íƒ€ì… ì‚¬ìš© ê°€ëŠ¥
   - ë”°ë¼ì„œ, ì‹¤ìˆ˜ë¡œ ì˜ëª»ëœ íƒ€ì…ì´ ë“¤ì–´ì˜¤ëŠ” ë¬¸ì œë„ ë°©ì§€ ê°€ëŠ¥, ê°ì²´ë¥¼ í†µí•´ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤ì´ ë§ì•„ì§
   - ì¦‰, ì‰½ê²Œ ì´ì•¼ê¸°í•´ì„œ ì™¸ë¶€ ì„¤ì •ì„ ìë°” ì½”ë“œë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ
   - ê·¸ë¦¬ê³  ì„¤ì • ì •ë³´ ê·¸ ìì²´ë„ íƒ€ì…ì„ ê°€ì§€ê²Œ ë¨

2. MyDataSourcePropertiesV1
```java
package hello.datasource;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;

import java.time.Duration;
import java.util.ArrayList;
import java.util.List;

@Data
@ConfigurationProperties("my.datasource")
public class MyDataSourcePropertiesV1 {
    private String url;
    private String username;
    private String password;
    private Etc etc;
    
    @Data
    public static class Etc {
        private int maxConnection;
        private Duration timeout;
        private List<String> options = new ArrayList<>();
    }
}
```
  - ì™¸ë¶€ ì„¤ì •ì„ ì£¼ì… ë°›ì„ ê°ì²´ë¥¼ ìƒì„±
  - ê·¸ë¦¬ê³  ê° í•„ë“œë¥¼ ì™¸ë¶€ ì„¤ì •ì˜ í‚¤ ê°’ì— ë§ì¶”ì–´ ì¤€ë¹„
  - ğŸ’¡ @ConfigurationPropertiesì´ ìˆìœ¼ë©´, ì™¸ë¶€ ì„¤ì •ì„ ì£¼ì… ë°›ëŠ” ê°ì²´ë¼ëŠ” ëœ»
    + ì—¬ê¸°ì— ì™¸ë¶€ ì„¤ì • Keyì˜ ë¬¶ìŒ ì‹œì‘ì ì¸ my.datasourceë¥¼ ì ì–´ì¤Œ
  - ê¸°ë³¸ ì£¼ì… ë°©ì‹ì€ ìë°”ë¹ˆ í”„ë¡œí¼í‹° ë°©ì‹(Getter, Setter í•„ìš”) : Lombokì˜ @Dataì— ì˜í•´ ìë™ìƒì„±

3. MyDataSourceConfigV1
```java
package hello.config;

import hello.datasource.MyDataSource;
import hello.datasource.MyDataSourcePropertiesV1;
import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;

@Slf4j
@EnableConfigurationProperties(MyDataSourcePropertiesV1.class)
public class MyDataSourceConfigV1 {

    private final MyDataSourcePropertiesV1 properties;

    public MyDataSourceConfigV1(MyDataSourcePropertiesV1 properties) {
        this.properties = properties;
    }

    @Bean
    public MyDataSource myDataSource() {
        return new MyDataSource(
                properties.getUrl(),
                properties.getUsername(),
                properties.getPassword(),
                properties.getEtc().getMaxConnection(),
                properties.getEtc().getTimeout(),
                properties.getEtc().getOptions()
        );
    }
}
```
  - @EnableConfigurationProperties(MyDataSourcePropertiesV1.class)
    + ìŠ¤í”„ë§ì—ê²Œ ì‚¬ìš©í•  @ConfigurationPropertiesë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•¨
    + ì´ë ‡ê²Œ í•˜ë©´, í•´ë‹¹ í´ë˜ìŠ¤ëŠ” ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ê³ , í•„ìš”í•œ ê³³ì—ì„œ ì£¼ì… ë°›ì•„ ì‚¬ìš© ê°€ëŠ¥
  - private final MyDataSourcePropertiesV1 properties : ì„¤ì • ì†ì„±ì„ ìƒì„±ìë¥¼ í†µí•´ ì£¼ì… ë°›ì•„ ì‚¬ìš©

4. ExternalReadApplication - ìˆ˜ì •
```java
package hello;

import hello.config.MyDataSourceConfigV1;
import hello.config.MyDataSourceEnvConfig;
import hello.config.MyDataSourceValueConfig;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Import;

// @Import(MyDataSourceEnvConfig.class)
// @Import(MyDataSourceValueConfig.class)
@Import(MyDataSourceConfigV1.class)
@SpringBootApplication(scanBasePackages = "hello.datasource")
public class ExternalReadApplication {

    public static void main(String[] args) {
        SpringApplication.run(ExternalReadApplication.class, args);
    }

}
```
  - @Import(MyDataSourceValueConfig.class) ì£¼ì„ ì²˜ë¦¬
  - @Import(MyDataSourceConfigV1.class) ì¶”ê°€
  - ì‹¤í–‰ ê²°ê³¼
```
2024-09-16T00:18:11.619+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : url = local.db.com
2024-09-16T00:18:11.622+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : username = username
2024-09-16T00:18:11.622+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : password = password
2024-09-16T00:18:11.623+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : maxConnection = 1
2024-09-16T00:18:11.623+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : timeout = PT3.5S
2024-09-16T00:18:11.623+09:00  INFO 17416 --- [           main] hello.datasource.MyDataSource            : options = [CACHE, ADMIN]
```

5. íƒ€ì… ì•ˆì „
   - ConfigurationPropertiesë¥¼ ì‚¬ìš©í•˜ë©´ íƒ€ì… ì•ˆì „í•œ ì„¤ì • ì†ì„± ì‚¬ìš© ê°€ëŠ¥
   - maxConnection=abcë¡œ ì…ë ¥í•˜ê³  ì‹¤í–‰
```
Failed to bind properties under 'my.datasource.etc.max-connection' to int:

    Property: my.datasource.etc.max-connection
    Value: "abc"
    Origin: class path resource [application.properties] - 5:34
    Reason: failed to convert java.lang.String to int (caused by java.lang.NumberFormatException: For input string: "abc")
```
  - ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³´ë©´ ìˆ«ìê°€ ë“¤ì–´ì™€ì•¼ í•˜ëŠ”ë°, ë¬¸ìê°€ ë“¤ì–´ì™€ì„œ ì˜¤ë¥˜ ë°œìƒ
  - íƒ€ì…ì´ ë‹¤ë¥´ë©´ ì˜¤ë¥˜ê°€ ë°œìƒ
  - ì¦‰, ì‹¤ìˆ˜ë¡œ ìˆ«ìë¥¼ ì…ë ¥í•˜ëŠ” ê³³ì— ë¬¸ìë¥¼ ì…ë ¥í•˜ëŠ” ë¬¸ì œ ë°©ì§€
  - ê·¸ë˜ì„œ íƒ€ì… ì•ˆì „í•œ ì„¤ì • ì†ì„±
  - ConfigurationPropertiesë¡œ ë§Œë“  ì™¸ë¶€ ë°ì´í„°ëŠ” íƒ€ì…ì— ëŒ€í•´ ë¯¿ê³  ì‚¬ìš© ê°€ëŠ¥

6. ì •ë¦¬
   - application.propertiesì— í•„ìš” ì™¸ë¶€ ì„¤ì •ì„ ì¶”ê°€
   - @ConfigurationPropertiesë¥¼ í†µí•´ MyDataSourcePropertiesV1ì— ì™¸ë¶€ ì„¤ì •ì˜ ê°’ë“¤ì„ ì„¤ì •
   - ê·¸ë¦¬ê³  í•´ë‹¹ ê°’ë“¤ì„ ì½ì–´ì„œ MyDataSourceë¥¼ ë§Œë“¬

7. í‘œê¸°ë²• ë³€í™˜
   - maxConnectionì€ í‘œê¸°ë²•ì´ ì„œë¡œ ë‹¤ë¦„
   - ìŠ¤í”„ë§ì€ ìºë°¥ í‘œê¸°ë²•ì„ ë‚™íƒ€ í‘œê¸°ë²•ìœ¼ë¡œ ì¤‘ê°„ì— ìë™ìœ¼ë¡œ ë³€í™˜
     + application.properties : max-connection
     + ìë°” ì½”ë“œ : maxConnection

8. ğŸ’¡ @ConfigurationPropertiesScan
   - @ConfigurationPropertiesë¥¼ í•˜ë‚˜ í•˜ë‚˜ ì§ì ‘ ë“±ë¡í•  ë•Œ : @ConfigurationProperties
     + ì˜ˆ) @EnableConfigurationProperties(MyDataSourcePropertiesV1.class)
   - @ConfigurationPropertiesë¥¼ íŠ¹ì • ë²”ìœ„ë¡œ ìë™ ë“±ë¡í•  ë•Œ : @ConfiugrationPropertiesScan
     + ë²”ìœ„ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´, ì• ë„ˆí…Œì´ì…˜ì„ ì§€ì •í•œ í´ë˜ìŠ¤ì˜ íŒ¨í‚¤ì§€ë¶€í„° í•˜ìœ„ íŒ¨í‚¤ì§€ê¹Œì§€ ì ìš©
     + ì˜ˆì‹œ
```java
@SpringBootApplication
@ConfigurationPropertiesScan({ "com.example.app", "com.example.another" })
public class MyApplication {}
```
  - ë¹ˆì„ ì§ì ‘ ë“±ë¡í•˜ëŠ” ê²ƒê³¼ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì‚¬ìš©í•˜ëŠ” ì°¨ì´ì™€ ë¹„ìŠ·

9. ë¬¸ì œ
    - MyDataSourcePropertiesV1ì€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡
    - ê·¸ëŸ°ë° Setterë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ, ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ê°’ì„ ë³€ê²½í•˜ëŠ” ë¬¸ì œ ë°œìƒ ê°€ëŠ¥
    - ì—¬ê¸°ì— ìˆëŠ” ê°’ë“¤ì€ ì™¸ë¶€ ì„¤ì • ê°’ì„ ì‚¬ìš©í•´ì„œ ì´ˆê¸°ì—ë§Œ ì‚¬ìš©ë˜ê³ , ì´í›„ì— ë³€ê²½ë˜ë©´ ì•ˆ ë¨
    - ì´ëŸ´ ë–„, Setterë¥¼ ì œê±°í•˜ê³ , ëŒ€ì‹  ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ë©´ ì¤‘ê°„ì— ë°ì´í„°ë¥¼ ë³€ê²½í•˜ëŠ” ì‹¤ìˆ˜ë¥¼ ê·¼ë³¸ì  ë°©ì§€ ê°€ëŠ¥
    - ì´ëŸ° ë¬¸ì œëŠ” í•œ ë²ˆ ë°œìƒí•˜ë©´ ì¡ê¸° ì–´ë ¤ìš´ ë²„ê·¸ë¡œ ë§Œë“¤ì–´ì§
    - ëŒ€ë¶€ë¶„ì€ MyDataSourcePropertiesV1ì˜ ê°’ì€ ë³€ê²½ë˜ë©´ ì•ˆ ëœë‹¤ê³  ì¸ì§€í•˜ì§€ë§Œ, ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ setterë¥¼ í†µí•´ ê°’ì„ ë³€ê²½í•˜ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ ì‹¬ê°í•œ ë²„ê·¸ ìœ ë°œì´ ê°€ëŠ¥í•¨

-----
### ì™¸ë¶€ ì„¤ì • ì‚¬ìš© - @ConfigurationProperties ìƒì„±ì
-----
1. ğŸ’¡ @ConfigurationPropertiesëŠ” Getter, Setterë¥¼ ì‚¬ìš©í•˜ëŠ” ìë°”ë¹ˆ í”„ë¡œí¼í‹° ë°©ì‹ì´ ì•„ë‹Œ ìƒì„±ìë¥¼ í†µí•´ ê°ì²´ë¥¼ ë§Œë“œëŠ” ê¸°ëŠ¥ ì§€ì›
2. MyDataSourcePropertiesV2
```java
package hello.datasource;

import lombok.Getter;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.bind.DefaultValue;

import java.time.Duration;
import java.util.ArrayList;
import java.util.List;

@Getter
@ConfigurationProperties("my.datasource")
public class MyDataSourcePropertiesV2 {
    private String url;
    private String username;
    private String password;
    private Etc etc;

    public MyDataSourcePropertiesV2(String url, String username, String password, @DefaultValue Etc etc) {
        this.url = url;
        this.username = username;
        this.password = password;
        this.etc = etc;
    }

    @Getter
    public static class Etc {
        private int maxConnection;
        private Duration timeout;
        private List<String> options = new ArrayList<>();

        public Etc(int maxConnection, Duration timeout, @DefaultValue("DEFAULT") List<String> options) {
            this.maxConnection = maxConnection;
            this.timeout = timeout;
            this.options = options;
        }
    }
}
```
  - ìƒì„±ìë¥¼ ë§Œë“¤ì–´ë‘ë©´ ìƒì„±ìë¥¼ í†µí•´ ì„¤ì • ì •ë³´ë¥¼ ì£¼ì…
  - @Getter : Lombokì´ ìë™ìœ¼ë¡œ Getter ìƒì„±
  - @DefaultValue : í•´ë‹¹ ê°’ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©
    + @DefaultValue Etc etc : etcë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš° Etc ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë‚´ë¶€ì— ë“¤ì–´ê°€ëŠ” ê°’ì€ ë¹„ì›Œë‘ (null, 0)
    + @DefaultValue("DEFAULT") List<String> options : optionsì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš° DEFAULTë¼ëŠ” ì´ë¦„ì˜ ê°’ ì‚¬ìš©

3. ì°¸ê³  : @ConstructorBinding
  - ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ì´ì „ì—ëŠ” ìƒì„±ì ë°”ì¸ë”© ì‹œì— @ConstructorBinding ì• ë„ˆí…Œì´ì…˜ì´ í•„ìˆ˜ë¡œ ì‚¬ìš©
  - ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ë¶€í„°ëŠ” ìƒì„±ìê°€ í•˜ë‚˜ì¼ ë•Œ, ìƒëµ ê°€ëŠ¥
    + ğŸ’¡ ìƒì„±ìê°€ ë‘˜ ì´ìƒì¸ ê²½ìš°ì—ëŠ” ì‚¬ìš©í•  ìƒì„±ìì— @ConstructorBinding ì• ë„ˆí…Œì´ì…˜ ì ìš©

4. MyDataSourceConfigV2
```java
package hello.config;

import hello.datasource.MyDataSource;
import hello.datasource.MyDataSourcePropertiesV2;
import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;

@Slf4j
@EnableConfigurationProperties(MyDataSourcePropertiesV2.class)
public class MyDataSourceConfigV2 {

    private final MyDataSourcePropertiesV2 properties;

    public MyDataSourceConfigV2(MyDataSourcePropertiesV2 properties) {
        this.properties = properties;
    }

    @Bean
    public MyDataSource myDataSource() {
        return new MyDataSource(
                properties.getUrl(),
                properties.getUsername(),
                properties.getPassword(),
                properties.getEtc().getMaxConnection(),
                properties.getEtc().getTimeout(),
                properties.getEtc().getOptions()
        );
    }
}
```
  - MyDataSourcePropertiesV2ë¥¼ ì ìš©í•˜ê³  ë¹ˆìœ¼ë¡œ ë“±ë¡

5. ExternalReadApplication - ìˆ˜ì •
```java
package hello;

import hello.config.MyDataSourceConfigV1;
import hello.config.MyDataSourceConfigV2;
import hello.config.MyDataSourceEnvConfig;
import hello.config.MyDataSourceValueConfig;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Import;

// @Import(MyDataSourceEnvConfig.class)
// @Import(MyDataSourceValueConfig.class)
// @Import(MyDataSourceConfigV1.class)
@Import(MyDataSourceConfigV2.class)
@SpringBootApplication(scanBasePackages = "hello.datasource")
public class ExternalReadApplication {

    public static void main(String[] args) {
        SpringApplication.run(ExternalReadApplication.class, args);
    }

}
```
  - @Import(MyDataSourceConfigV2.class) ì¶”ê°€

6. ì‹¤í–‰ ê²°ê³¼
```
2024-09-16T00:52:14.104+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : url = local.db.com
2024-09-16T00:52:14.106+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : username = username
2024-09-16T00:52:14.106+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : password = password
2024-09-16T00:52:14.106+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : maxConnection = 1
2024-09-16T00:52:14.106+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : timeout = PT3.5S
2024-09-16T00:52:14.106+09:00  INFO 9576 --- [           main] hello.datasource.MyDataSource            : options = [CACHE, ADMIN]
```

7. ì •ë¦¬
   - application.propertiesì— í•„ìš”í•œ ì™¸ë¶€ ì„¤ì •ì„ ì¶”ê°€í•˜ê³ , @ConfigurationPropertiesì˜ ìƒì„±ì ì£¼ì…ì„ í†µí•´ ê°’ì„ ì½ì–´ë“¤ì„
   - Setterê°€ ì—†ìœ¼ë¯€ë¡œ ì¤‘ê°„ì— ì‹¤ìˆ˜ë¡œ ê°’ì„ ë³€ê²½í•˜ëŠ” ë¬¸ì œë„ ë°œìƒí•˜ì§€ ì•ŠìŒ

8. ë¬¸ì œ
   - íƒ€ì…ê³¼ ê°ì²´ë¥¼ í†µí•´ ìˆ«ìê°€ ë“¤ì–´ì˜¤ëŠ” ê²ƒ ê°™ì€ ê¸°ë³¸ì  íƒ€ì… ë¬¸ì œë“¤ì€ í•´ê²°
   - ê·¸ëŸ°ë° íƒ€ì…ì€ ë§ëŠ”ë°, ìˆ«ìì˜ ë²”ìœ„ê°€ ê¸°ëŒ€í•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥´ë‹¤ë©´?
     + ì˜ˆ) max-connectionì˜ ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì»¤ë„¥ì…˜ì´ í•˜ë‚˜ë„ ë§Œë“¤ì–´ì§€ì§€ ì•ŠëŠ” ì‹¬ê°í•œ ë¬¸ì œ ë°œìƒ
     + ìµœì†Œ 1ì´ìƒ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”© ì‹œì ì— ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼œì„œ ë¹ ë¥´ê²Œ ë¬¸ì œë¥¼ ì¸ì§€í•˜ë„ë¡ í•´ì•¼í•¨
