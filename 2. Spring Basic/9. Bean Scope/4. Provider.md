-----
### í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ Providerë¡œ ë¬¸ì œ í•´ê²°
-----
1. ì‹±ê¸€í†¤ ë¹ˆê³¼ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ, ì‚¬ìš©í•  ë•Œë§ˆë‹¤ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±ë°›ëŠ” ë°©ë²•?
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­
   - ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ì‹±ê¸€í†¤ ë¹ˆì´ í”„ë¡œí† íƒ€ì…ì„ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìƒˆë¡œ ìš”ì²­í•˜ëŠ” ê²ƒ
```java
package hello.core.scope;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import static org.assertj.core.api.Assertions.*;

public class SingletonWithPrototypeTest1 {
    @Test
    void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addCount();
        assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addCount();
        assertThat(prototypeBean2.getCount()).isEqualTo(1);
    }

    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);
        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        int count1 = clientBean1.logic();
        assertThat(count1).isEqualTo(1);

        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(1);
    }


    @Scope("singleton")
    static class ClientBean {
        @Autowired
        private ApplicationContext ac;

        public int logic() {
            PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }

    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addCount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init : " + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }
}
```
3. í•µì‹¬ ì½”ë“œ
```java
...

@Scope("singleton")
static class ClientBean {
	@Autowired
	private ApplicationContext ac;

	public int logic() {
	    PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
	    prototypeBean.addCount();
	    int count = prototypeBean.getCount();
	    return count;
	}
}

...
```

  - ì‹¤í–‰í•´ë³´ë©´, ac.getBean()ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥
  - ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…(DI)ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì´ë ‡ê²Œ ì§ì ‘ í•„ìš”í•œ ì˜ì¡´ ê´€ê³„ë¥¼ ì°¾ëŠ” ê²ƒì„ 'Dependency Lookup(DL, ì˜ì¡´ê´€ê³„ ì¡°íšŒ(íƒìƒ‰))'ì´ë¼ í•¨
  - í•˜ì§€ë§Œ, ì´ë ‡ê²Œ ìŠ¤í”„ë§ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì „ì²´ë¥¼ ì£¼ì…ë°›ê²Œ ë˜ë©´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì¢…ì†ì  ì½”ë“œê°€ ë˜ë©°, ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ì›Œì§

-----
### ObjectFactory, ObjectProvider
-----
1. ObjectProvider : ì§€ì •í•  ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” DL ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•´ì£¼ëŠ” ê²ƒ
2. ê³¼ê±°ì—ëŠ” ObjectFactoryê°€ ìˆì—ˆëŠ”ë°, ì—¬ê¸°ì— í¸ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì„œ ë§Œë“¤ì–´ì§„ ê²ƒ
```java
...

@Scope("singleton")
static class ClientBean {
        @Autowired
        private ObjectProvider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
}

...
```
  - ì‹¤í–‰í•´ë³´ë©´, prototypeBeanProvider.getObject()ë¥¼ í†µí•´ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥
  - ğŸ’¡ ObjectProviderì˜ getObject()ë¥¼ í˜¸ì¶œí•˜ë©´, ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜ (DL)
  - ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§
  - ObjectProviderëŠ” DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µ

3. íŠ¹ì§•
   - ObjectFactory : ê¸°ëŠ¥ì´ ë‹¨ìˆœ, ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš” ì—†ìŒ. ìŠ¤í”„ë§ì— ì˜ì¡´
   - ObjectProvider : ObjectFactory ìƒì†, ì˜µì…˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ë“± í¸ì˜ ê¸°ëŠ¥ì´ ë§ê³ , ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš” ì—†ìŒ. ìŠ¤í”„ë§ì— ì˜ì¡´

-----
### JSR-330 Provider
-----
1. javax.inject.Provider ë¼ëŠ” JSR-330 ìë°” í‘œì¤€ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
   - ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0ì€ jakarta.inject.Providerë¥¼ ì‚¬ìš©
2. ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€í•´ì•¼í•¨
   - ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ë¯¸ë§Œ : javax.inject:javax.inject:1 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€
   - ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ì´ìƒ : jakarta.inject:jakarta.inject-api:2.0.1 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€
```java
plugins {
	id 'java'
	id 'org.springframework.boot' version '3.2.5'
	id 'io.spring.dependency-management' version '1.1.4'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'

java {
	sourceCompatibility = '17'
}

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter'
	implementation 'jakarta.inject:jakarta.inject-api:2.0.1'

	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
	useJUnitPlatform()
}
```

3. javax.inject.Provider ì°¸ê³ ìš© ì½”ë“œ - ìŠ¤í”„ë§ë¶€íŠ¸ 3.0 ë¯¸ë§Œ
```java
package javax.inject;

public interface Provider<T> {
    T get();
}
```

4. ìŠ¤í”„ë§ë¶€íŠ¸ 3.0ì€ jakarta.inject.Provider ì‚¬ìš©
```java
...

@Scope("singleton")
static class ClientBean {
        @Autowired
        private Provider<PrototypeBean> provider;

        public int logic() {
            PrototypeBean prototypeBean = provider.get();
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
}

...
```
  - ì‹¤í–‰í•´ë³´ë©´ provider.get()ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥
  - providerì˜ get()ì„ í˜¸ì¶œí•˜ë©´, ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ ë°˜í™˜ (DL)
  - ìë°” í‘œì¤€ì´ê³ , ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§
  - ProviderëŠ” í•„ìš”í•œ DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µ

5. íŠ¹ì§•
  - get() ë©”ì„œë“œ í•˜ë‚˜ë¡œ ê¸°ëŠ¥ì´ ë§¤ìš° ë‹¨ìˆœ
  - ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”
  - ìë°” í‘œì¤€ì´ë¯€ë¡œ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥

-----
### ì •ë¦¬
-----
1. í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ì‚¬ìš© ì‹œê¸°
   - ë§¤ë²ˆ ì‚¬ìš©í•  ë–„ë§ˆë‹¤ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì´ ì™„ë£Œëœ ìƒˆë¡œìš´ ê°ì²´ê°€ í•„ìš”í•˜ë©´ ì‚¬ìš©
   - ì‹¤ë¬´ì—ì„œëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•´ë³´ë©´, ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ ëŒ€ë¶€ë¶„ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì¼ì„ ë“œë­„

2. ObjectProvider, JSR-330 Provider ë“±ì€ í”„ë¡œí† íƒ€ì… ë¿ ì•„ë‹ˆë¼ DLì´ í•„ìš”í•œ ê²½ìš° ì–¸ì œë“ ì§€ ì‚¬ìš© ê°€ëŠ¥
3. ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ë©”ì„œë“œì— @Lookup ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ì¡´ì¬
4. ObjectProviderëŠ” DLì„ ìœ„í•œ í¸ì˜ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µí•´ì£¼ê³ , ìŠ¤í”„ë§ ì™¸ì— ë³„ë„ì˜ ì˜ì¡´ê´€ê³„ ì¶”ê°€ê°€ í•„ìš” ì—†ìœ¼ë¯€ë¡œ í¸ë¦¬
5. í•˜ì§€ë§Œ, ì½”ë“œë¥¼ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, JSR-330 Providerë¥¼ ì‚¬ìš©
